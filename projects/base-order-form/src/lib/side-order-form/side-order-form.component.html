<cdk-virtual-scroll-viewport itemSize="">
  <form [formGroup]="form" class="form-layout">
    <ng-content select="[headerContent]"></ng-content>

    <button
      [class.cursor-not-allowed]="!canClickPosButton"
      (click)="setPositionQuantity()" title="Positions" class="top-position-btn"
            [class.pos-negative]="isPositionsNegative"
    >{{positionsSum}}</button>
    <quantity-input #quantity formControlName="quantity" [amountButtons]="amountButtons"></quantity-input>
    <nz-select [nzOptionHeightPx]="23" formControlName="type" class="type-select">
      <nz-option *ngFor="let item of typeSelectOptions"
                 [nzLabel]="item.label" [nzValue]="item.value"
      ></nz-option>
    </nz-select>
    <div class="slim-amount d-none"
         [class.d-flex]="isFormOnTop && !isExtended">
      <span class="{{isTypeStopLimit? 'd-flex': 'd-none'}}">
        <span class="amount-text">Amount</span>
        <span class="amount-input">
      <nz-input-number
        nzMin="1"
        formControlName="amount"
        class="amount-number"
      >
      </nz-input-number>
        </span>
      </span>
      <span class="{{isIceEnabled? 'd-flex': 'd-none'}} ice-button">
        <button (click)="toggleIce()" nz-button class="ice-btn" [class.is-ice-active]="isIce">ICE</button>
      </span>
      <span [class.d-none]="!isIceAmountVisible" class="ice-amount">
      <nz-input-number
        formControlName="iceQuantity"
        nzMin="1"
      >
      </nz-input-number>
    </span>
    </div>
    <type-buttons [class.is-oco-selected]="isOcoSelected" class="type-buttons" formControlName="type"
                  [typeButtons]="typeButtons">
          <span [class.d-none]="!isIceAmountVisible" class="ice-amount" iceAmount>

      <nz-input-number
        formControlName="iceQuantity"
        nzMin="1"
      >
      </nz-input-number>
    </span>
      <div [class.d-none]="!isTypeStopLimit" marketAmount class="amount">
        <span class="amount-text">Amount</span>
        <span class="amount-input">

      <nz-input-number
        (keyup.enter)="$event.preventDefault();editAmount = false"
        formControlName="amount"
        nzMin="1"
        class="amount-number"
        (focusout)="$event.stopPropagation();editAmount = false"
      >
      </nz-input-number>
        </span>
      </div>
      <span ice class="{{isIceEnabled? 'd-inline-block': 'd-none'}} ice-button">
        <button [class.is-ice-active]="isIce" class="ice-btn" nz-button (click)="toggleIce()">ICE</button>
      </span>
    </type-buttons>


    <nz-select [nzOptionHeightPx]="23" formControlName="duration" class="type-select tif-select">
      <nz-option *ngFor="let item of tifButtons"
                 [nzLabel]="item.label" [nzValue]="item.value"
      ></nz-option>
    </nz-select>
    <type-buttons formControlName="duration" class="tif-buttons" [typeButtons]="tifButtons"></type-buttons>
    <div [class.d-none]="!showUnits" class="ticks">
      <sl-units formControlName="stopLoss"></sl-units>
      <tp-units formControlName="takeProfit"></tp-units>
    </div>
    <div class="market-buttons">
      <button class="buy-market" (click)="createBuyMarket()">BUY MKT</button>
      <button class="sell-market"  (click)="createSellMarket()">SELL MKT</button>
    </div>
    <div class="cxl">
      <button
        [style.color]="setting.sellButtonsFontColor"
        [style.background]="setting.sellButtonsBackgroundColor"
        (click)="emit(FormActions.CloseSellOrders)" class="cxl-btn cxl-sell" nz-button>CXL SELL <span class="cxl-quantity">{{sellQuantity}}</span></button>
      <button
        [style.color]="setting.cancelButtonFontColor"
        [style.background]="setting.cancelButtonBackgroundColor"
        (click)="emit(FormActions.CloseOrders)" class="cxl-btn cxl-all" nz-button>CXL ALL <span class="cxl-quantity">{{totalQuantity}}</span></button>
      <button [style.color]="setting.buyButtonsFontColor"
              [style.background]="setting.buyButtonsBackgroundColor" (click)="emit(FormActions.CloseBuyOrders)" class="cxl-btn cxl-buy" nz-button>CXL BUY <span class="cxl-quantity">{{buyQuantity}}</span></button>
    </div>
    <div class="bottom-btns">
      <button (click)="emit(FormActions.ClosePositions)" [class.d-none]="!setting.formSettings.closePositionButton" nz-button>CLOSE
        POSITION
      </button>
      <button
        [style.color]="setting.flatButtonFontColor"
        [style.background]="setting.flatButtonsBackgroundColor"
        (click)="emit(FormActions.Flatten)" [class.d-none]="!setting.formSettings.showFlattenButton" class="flatten" nz-button>
        FLATTEN
      </button>
    </div>
  </form>
</cdk-virtual-scroll-viewport>

