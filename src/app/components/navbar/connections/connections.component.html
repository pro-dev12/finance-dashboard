<div
  class="connections-container  d-flex justify-content-end"
  *ngIf="favourites.length < 3"
>
  <div
    class="d-flex align-items-center   connection-item"
    (contextmenu)="connectionContextMenu($event, connectionContextMenuDropdown, connection)"
    (click)="openAccounts(connection)"
    *ngFor="let connection of items"
  >
    <div class="indicator mr-2" [ngClass]="{
      'success': connection.connected,
      'error': connection.error,
      'connecting': isLoading[connection.id]
    }"></div>
    <div
      [title]="connection.name"
      class="text-bold text-ellipsis connection-name"
    >{{ connection.name }}</div>
  </div>
</div>
<div
  nz-dropdown
  nzTrigger="click"
  [nzDropdownMenu]="connectionsDropdown"
  class="d-flex align-items-center justify-content-center navigation-button"
  *ngIf="favourites.length > 2"
>
  <i class="icon-arrow-down text-small mr-1"></i>
  <i [ngClass]="{
    'text-active': activeConnection
  }" class="icon-signal"></i>
</div>
<div
  class="d-flex align-items-center justify-content-center navigation-button"
  (click)="openAccounts()"
  *ngIf="!favourites.length"
>
  <i
    title="Connections"
    class="icon-signal" [ngClass]="{
    'text-active': activeConnection
  }"></i>
</div>
<nz-dropdown-menu #connectionsDropdown="nzDropdownMenu">
  <div class="dropdown">
    <cdk-virtual-scroll-viewport [itemSize]>
      <ul nz-menu>
        <li
          nz-menu-item
          class="d-flex align-items-center"
          *ngFor="let connection of items"
          (click)="openAccounts(connection)"
          (contextmenu)="connectionContextMenu($event, connectionContextMenuDropdown, connection)"
        >
          <div
            [class.dropdown-connected]="connection.connected"
            class="pl-2 text-ellipsis dropdown-connection-item d-flex position-relative">
            <!--  <div class="indicator menu-indicator prefix mr-2" [ngClass]="{
                'text-success': connection.connected,
                'text-danger': connection.error
              }"></div>-->
            <div [class.success]="connection.connected"
                 [class.error]="connection.error"
                 [class.connecting]="isLoading[connection.id]"
                 class="indicator menu-indicator"></div>
            <div>
              <span [title]="connection.name" class="dropdown-connection-name text-ellipsis">{{ connection.name }}</span>
              <div class="dropdown-connection-username">{{ connection.username }}</div>
            </div>
          </div>
        </li>
      </ul>
    </cdk-virtual-scroll-viewport>
  </div>
</nz-dropdown-menu>
<nz-dropdown-menu #connectionContextMenuDropdown="nzDropdownMenu">
  <ul nz-menu>
    <li nz-menu-item (click)="connect()" *ngIf="!contextMenuConnection?.connected">Connect</li>
    <li nz-menu-item (click)="disconnect()" *ngIf="contextMenuConnection?.connected">Disconnect</li>
    <li nz-menu-item (click)="removeFromFavourites()">Remove from top menu</li>
  </ul>
</nz-dropdown-menu>
