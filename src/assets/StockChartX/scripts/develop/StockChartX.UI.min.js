/**
 * StockChartX Web & Mobile
 * @version v2.22.2
 * @link http://www.modulusfe.com/products/web-mobile-stock-chart-library/stockchartx-html5-web-mobile/
 * @license Copyright 2012 to 2017 by Modulus Financial Engineering, Inc., Scottsdale, AZ USA
 * http://www.modulusfe.com
 * 
 * Your license agreement requires the use of the Modulus LicensePing.com licensing mechanism.
 * The mechanism monitors the usage and distribution patterns of our intellectual property.
 * If the usage or distribution patterns indicate that our licensing mechanism has either
 * been removed, altered, tampered with or that our intellectual property may be misused in
 * any form, our legal team may initiate contact with you to investigate the matter further.
 * 
 * Removal or modification of this license mechanism by any means whatsoever (editing the code,
 * removing the LicensePing.com URL reference, etc.) constitutes willful and criminal copyright
 * infringement in addition to giving rise to claims by Modulus Financial Engineering, Inc.
 * against you, as the developer, and your company as a whole for, among others:
 * 
 * (1) Copyright Infringement;
 * (2) False Designation of Origin;
 * (3) Breach of Contract;
 * (4) Misappropriation of Trade Secrets;
 * (5) Interference with Contract; and
 * (6) Interference with Prospective Business Relations.
 * 
 * 17 USC � 506 - Criminal offenses
 * (a) Criminal Infringement.
 * Any person who willfully infringes a copyright shall be punished as provided under section
 * 2319 of title 18, if the infringement was committed for purposes of commercial advantage
 * or private financial gain.
 * 
 * 18 USC � 2319 - Criminal infringement of a copyright
 * (a) Any person who commits an offense under section 506 (a)(1)(A) of title 17 shall be imprisoned
 * not more than 5 years, or fined in the amount set forth in this title (up to $150,000), or both,
 * if the offense consists of the reproduction or distribution, including by electronic means, during
 * any 180-day period, of at least 10 copies, of 1 or more copyrighted works, which have a total retail
 * value of more than $2,500.
 * 
 * For more information, review the license agreement associated with this software and source
 * code at http://www.modulusfe.com/tos or contact us at legal@modulusfe.com.
 */
!function(e){!function(i){"use strict";jQuery.fn.scx=function(){var t=this;return{chartContextMenu:function(e){return new i.ChartContextMenu(t,e)},chartNavigation:function(e){return new i.ChartNavigation({target:t,chart:e})},colorPicker:function(e){return new i.ColorPicker(t,e)},indicatorContextMenu:function(e){return new i.IndicatorContextMenu(t,e)},instrumentSearch:function(e){return new i.InstrumentSearch(t,e)},comparingContextMenu:function(e){return new i.CompareContextMenu(t,e)},numericField:function(e){return t.scxNumericField(e)},timeFramePicker:function(e){return new i.TimeFramePicker(t,e)},toolbar:function(e){return new i.Toolbar({parent:t,chart:e})},scrollbar:function(e){return new i.Scrollbar({parent:t,chart:e})},toolbarDropDownButton:function(e){return new i.ToolbarDropDownButton(t,e)},waitingBar:function(){return new i.WaitingBar(t)},tradingContextMenu:function(e){return new i.TradingContextMenu(t,e)}}}}(e.UI||(e.UI={}))}(StockChartX=StockChartX||{}),function(e){!function(){"use strict";var x=jQuery,v="scxNumericField",C="scxNumericField",S="scxNumericField-wrapper",e="scxNumericField-invalidValue",k="scxNumericField-arrowWrapper",P="scxNumericField-arrowUp",L="scxNumericField-arrowDown",T="scxNumericFieldArrow",t={init:function(w){return this.each(function(){var e,t,i,n,o,r,a,s,l,c,h,d,_,u,p,f,m,g=x(this),b="";function y(){s.is("[disabled]")||(F(s,B(s)+d,!0),h=setTimeout(y,200))}g.attr("type","text").addClass(C),g.data(v,{target:g,settings:x.extend(!0,{canBeNegative:!1,priceDecimals:0,showArrows:!1,maxValue:null,minValue:null,value:0,onChange:null},w)}),w.showArrows&&(e=g.parent(),t=g.index(),_=g,u=x('<div class="'+S+'">'),p=x('<div class="'+k+" "+P+'"><span class="'+T+'"></span></div>'),f=x('<div class="'+k+" "+L+'"><span class="'+T+'"></span></div>'),m=_.outerHeight(!0),u.height(m),p.height(m-2),f.height(m-2),_.css("padding-right",40),u.append(_).append(p).append(f),p.css("padding-top",Math.floor(m/2-11)),f.css("padding-top",Math.floor(m/2-11)),I(p),I(f),o=(i={wrapper:u,field:_,arrowUp:p,arrowDown:f}).wrapper,r=t,a=(n=e).children().length-1,0<=r&&r<=a?n.children().eq(r).before(o):n.append(o),s=g=i.field,l=i.arrowUp,c=i.arrowDown,x(window).on("mouseup",function(){clearTimeout(h),d=0}),l.on("mousedown",function(){d=1,y()}),c.on("mousedown",function(){d=-1,y()})),g.on("input",function(){var e=x(this),t=B(e,b);b=0!==w.priceDecimals||""!==e.val()?(w.maxValue&&w.minValue&&(e.val()>w.maxValue||e.val()<w.minValue)&&(b=w.maxValue),isNaN(t)&&(t=null),F(e,null===t?"-":t)):null!=w.minValue&&0<w.minValue?w.minValue:0}),g.on("blur",function(){var e,t=x(this),i=t.val(),n=D(t);(!w.priceDecimals||0<=w.priceDecimals)&&""===i||"-"===i?((b>n.maxValue||b<n.minValue)&&(b=n.maxValue),""!==b&&!isNaN(b)||(b=n.value),F(t,b)):(null!=(e=B(t))&&!isNaN(e)||(e=n.minValue),F(t,e,!0))}),b=F(g,w.value)})},show:function(){return this.each(function(){D(this).showArrows?x(this).parent().show():x(this).show()})},hide:function(){return this.each(function(){D(this).showArrows?x(this).parent().hide():x(this).hide()})},disable:function(){return this.each(function(){x(this).attr("disabled","disabled")})},enable:function(){return this.each(function(){x(this).removeAttr("disabled")})},isDisabled:function(){var e=x(this).attr("disabled");return void 0!==e&&!1!==e},isEnabled:function(){var e=x(this).attr("disabled");return!(void 0!==e&&!1!==e)},highlightInvalid:function(){return this.each(function(){x(this).addClass(e)})},unhighlightInvalid:function(){return this.each(function(){x(this).removeClass(e)})},setValue:function(e){return this.each(function(){F(x(this),e)})},getValue:function(){return B(x(this))},setBounds:function(t,i){return this.each(function(){var e;null==t&&null==i||(e=D(this),null!=t&&(e.minValue=t),null!=i&&(e.maxValue=i),x(this).trigger("input"),F(x(this),B(x(this)),!0))})},onChange:function(e){return this.each(function(){D(this).onChange=e})}};function o(e){return x(e).data(v)}function D(e){return o(e).settings}function F(e,t,i){return void 0===i&&(i=!1),e.val(t),t.toString()}function B(e,t){var i=o(e).settings,n=function(e,t,i){for(var n=e.length-1;0<=n;n--)!function(e,t,i){void 0===t&&(t=!1);void 0===i&&(i=!1);switch(e){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case",":return!0;case".":return i;case"-":return t;default:return!1}}(e[n],t,i)&&(e=a(e,n));return e}(e.val(),i.canBeNegative,0<i.priceDecimals);return"-"===n||0===n.replace(/-/gi,"").length?null:(""!==n&&"."!==n||(n="0"),n=0<i.priceDecimals?r(n,t):r(n),parseFloat(n))}function r(e,t){var i,n,o;return void 0===t&&(t=""),-1<e.indexOf("-")&&(e="-"+e.replace(/-/g,"")),t.length&&1<function(e,t){var i=[],n=-1;for(;-1!==(n=e.indexOf(t,n+1));)i.push(n);return i}(e,".").length&&(i=t.indexOf("."),n=t.length-i,o=void 0,o=e.substr(0,i)===t.substr(0,i)?i:e.length-n,e=a(e,o)),e.replace(/,/g,"")}function a(e,t,i){void 0===i&&(i="");var n=0===i.length?t+1:t+i.length;return e.substr(0,t)+i+e.substr(n)}function I(e){return e.attr("unselectable","on").css("user-select","none").on("selectstart",function(){return!1})}x.fn.scxNumericField=function(e){return t[e]?t[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void x.error("Method "+e+" doesn't exist for jQuery.numericField"):t.init.apply(this,arguments)}}(e.UI||(e.UI={}))}(StockChartX=StockChartX||{}),function(o){!function(e){"use strict";var n=jQuery,t=(i.prototype.getColor=function(){return this._picker.spectrum("get").toRgbString()},i.prototype.setColor=function(e){this._picker.spectrum("set",e)},i.prototype.spectrum=function(e,t){this._picker.spectrum(e,t)},i.prototype._getInitParams=function(){return o.Environment.isPhone?{color:"#000",showInput:!1,showInitial:!0,allowEmpty:!1,showAlpha:!1,disabled:!1,maxSelectionSize:1,showPalette:!0,showSelectionPalette:!1,showPaletteOnly:!0,palette:this._getPalette()}:{color:"#000",showInput:!1,showInitial:!0,allowEmpty:!1,showAlpha:!1,disabled:!1,maxSelectionSize:1,showPalette:!0,showSelectionPalette:!0,showPaletteOnly:!0,togglePaletteOnly:!0,palette:this._getPalette(),cancelText:"Cancel",chooseText:"Choose",togglePaletteMoreText:"More",togglePaletteLessText:"Less"}},i.prototype._getPalette=function(){return o.Environment.isPhone?[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#80c00000","#80b45f06","#80bf9000","#8038761d","#80134f5c","#800b5394","#80351c75","#80741b47"]]:[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]]},i);function i(e,t){var i=this._getInitParams();this._picker=e.spectrum(n.extend(i,t))}e.ColorPicker=t}(o.UI||(o.UI={}))}(StockChartX=StockChartX||{}),function(e){!function(e){"use strict";var s=jQuery,o="scxMenuItemCheckable",r="scxMenuItemChecked",a="disabled",n="scxSubMenu",t="scxMenuItemWithSubMenu",l="scxContextMenuOpen",i=(Object.defineProperty(c.prototype,"container",{get:function(){return this._config.menuContainer},enumerable:!0,configurable:!0}),c.prototype._subscribeEvents=function(){var t=this;s(document).on(["click","touchstart",""].join(this._eventSuffix+" "),function(e){return 2===e.button?null:void(t._isShown&&t.hide())});s(window).on(["scroll","resize",""].join(this._eventSuffix+" "),function(){t._isShown&&t.hide()}),s("body").on(l+this._eventSuffix,function(){t._isShown&&t.hide()})},c.prototype._unsubscribeEvents=function(){s(document).off(this._eventSuffix),s(window).off(this._eventSuffix),s("body").off(this._eventSuffix)},c.prototype.hide=function(){this._isShown=!1,this._config.menuContainer.hide()},c.prototype.show=function(e){var n=this;this._config.onShow&&(s("body").trigger("click").trigger("localize",[this.container]),this._config.onShow()),this._config.menuContainer&&(this._config.menuContainer.data("target",s(e.target)).show().css(this._calculateMenuPosition(this._getLeftLocation(e),this._getTopLocation(e))).off("click").on("click",function(e){if(e.preventDefault(),!s(e.target).parent().attr("data-id"))return!1;if(n.hide(),!n._config.onItemSelected)return!1;var t,i=s(e.target).blur().parent();return i.hasClass(a)||(i.hasClass(o)?((t=i.hasClass(r))?i.removeClass(r):i.addClass(r),n._config.onItemSelected(i,!t)):n._config.onItemSelected(i)),!1}).find("."+t).each(function(){c._getSubMenuTopLocation(s(this))}),this._isShown=!0)},c.prototype._getLeftLocation=function(e){var t=e.pageX||e.originalEvent&&e.originalEvent.pageX,i=s(window).width(),n=this._config.menuContainer.width();return i<t+n&&n<t?t-n:t},c.prototype._getTopLocation=function(e){var t=e.pageY||e.originalEvent&&e.originalEvent.pageY,i=s(window).height(),n=this._config.menuContainer.height();return i<t-s(window).scrollTop()+n&&n<t?t-n:t},c.prototype._calculateMenuPosition=function(e,t){var i=this._config.menuContainer;i.css({width:"auto",height:"auto"});var n=s(window).height(),o=i.outerHeight(!0),r=t,a=s(window).scrollTop();return n<o&&(i.height(n-20),o=n),n/o<2&&(r=a+n/2-o/2),{position:"absolute",top:r,left:e-s(window).scrollLeft()}},c._getSubMenuTopLocation=function(e){var t=e.parent().offset().top,i=e.offset().top;e.find("."+n).css({top:i-t-5+"px"})},c.prototype.destroy=function(){this._isShown&&this.hide(),this._unsubscribeEvents()},c.Id=0,c);function c(e,t){var i=this;this._eventSuffix=".scxContentMenu_"+ ++c.Id,this._isShown=!1,this._config=e,t&&(t.on("contextmenu",function(e){return s("body").trigger(l),i.show(e),!1}),e.showOnClick&&t.on("click",function(e){return s("body").trigger(l),i.show(e),!1})),this._subscribeEvents()}e.ContextMenu=i}(e.UI||(e.UI={}))}(StockChartX=StockChartX||{});var __extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}();!function(a){!function(n){"use strict";var i="disabled",e={FORMAT:"format"};Object.freeze(e);var o,t=(o=n.ContextMenu,__extends(r,o),r.prototype._initMenu=function(e){var t=this;e.onShow=function(){t._onShow()}},r.prototype._onShow=function(){var e=this._config,t=(e.menuContainer=r._container).find("[data-id=format]");switch(e.chart.priceStyleKind){case a.BarPriceStyle.className:case a.HLBarPriceStyle.className:case a.HLCBarPriceStyle.className:case a.ColoredHLBarPriceStyle.className:case a.ColoredHLCBarPriceStyle.className:case a.ColoredBarPriceStyle.className:case a.KagiPriceStyle.className:case a.LineBreakPriceStyle.className:case a.PointAndFigurePriceStyle.className:case a.RenkoPriceStyle.className:t.removeClass(i);break;default:t.addClass(i)}},r.prototype.destroy=function(){this._chartContextMenuConfig.chart=null,o.prototype.destroy.call(this)},r.MenuItem=e,r);function r(e,t){var i=o.call(this,t,e)||this;return i._chartContextMenuConfig=t,n.HtmlLoader.loadHtml("ChartContextMenu.html",function(e){r._container||(r._container=n.HtmlContainer.instance.register("ChartContextMenu",e)),i._initMenu(i._chartContextMenuConfig)}),i}n.ChartContextMenu=t}(a.UI||(a.UI={}))}(StockChartX=StockChartX||{}),function(r){!function(e){"use strict";var t=jQuery,i="active",n=(o.prototype.activate=function(e,t){e!==this._activeIndex&&(this._tabs.eq(this._activeIndex).removeClass(i),this._panels.eq(this._activeIndex).removeClass(i),this._tabs.eq(e).addClass(i),this._panels.eq(e).addClass(i),this._activeIndex=e),t&&r.JsUtil.isFunction(this._config.onChange)&&this._config.onChange(e)},o.prototype.activeIndex=function(){return this._activeIndex},o.prototype.destroy=function(){this._tabs.off("click",this._onItemClicked)},o.prototype._onItemClicked=function(e){e.data.activate(t(e.target).index(),!0)},o);function o(e){this._config=e,this._activeIndex=0,this._tabs=e.tabsContainer.children().removeClass(i),this._panels=e.panelsContainer.children().removeClass(i),this._config.activeIndex&&r.JsUtil.isNumber(this._config.activeIndex)&&(this._activeIndex=this._config.activeIndex),this._tabs.eq(this._activeIndex).addClass(i),this._panels.eq(this._activeIndex).addClass(i),this._tabs.css("width",100/this._tabs.length+"%"),this._tabs.on("click",this,this._onItemClicked)}e.Tabs=n}(r.UI||(r.UI={}))}(StockChartX=StockChartX||{}),function(e){!function(t){"use strict";var r=jQuery,e=(i.prototype.show=function(e){e.chart.localize(this._dialog),this._isShown=!0,this._dialog.attr("style",""),this._dialog.modal("show"),this.resize(),this._centralize()},i.prototype.hide=function(){this._isShown&&(this._isShown=!1,this._dialog.modal("hide"),r(document.activeElement).blur(),this._config.chart.keyboardEventsEnabled=this._keyboardEnabledState,this._config=null)},i.prototype.resetToDefault=function(){},i.prototype.resize=function(){this._adjustHeight()},i.prototype.destroy=function(){r(window).off("resize",this._onWindowResize)},i.prototype.initDialog=function(e){return!(!e||!e.chart||this._config||this._isShown)&&(this._config=e,this._keyboardEnabledState=e.chart.keyboardEventsEnabled,e.chart.keyboardEventsEnabled=!1,t.HtmlContainer.instance.resetSelf(e.chart),!0)},i.prototype._initDialogContentObj=function(){var e=this._dialog.find("> .modal-dialog"),t=e.find("> .modal-content");this._dialogContent={dialog:e,root:t,header:t.find("> .modal-header"),body:t.find("> .modal-body"),footer:t.find("> .modal-footer")}},i.prototype._onWindowResize=function(e){var t=e.data;t._isShown&&t.resize()},i.prototype._adjustHeight=function(){this._dialogContent.body.css("height","auto"),this._dialogContent.dialog.css("height","auto");var e,t,i,n=.9*window.innerHeight,o=this._dialogContent.dialog.outerHeight(!0);n<o&&(e=o-this._dialogContent.dialog.height(),t=this._dialogContent.body.outerHeight(!0)-this._dialogContent.body.height(),i=n-this._dialogContent.header.outerHeight(!0)-(this._dialogContent.footer.outerHeight(!0)||0)-t-e,r(this._dialogContent.body).height(i))},i.prototype._centralize=function(){var e=(window.innerWidth-this._dialogContent.dialog.width())/2;this._dialogContent.dialog.css("margin","0"),this._dialogContent.dialog.css("left",e),this._dialogContent.dialog.css("top",20)},i);function i(e){var t=this;this._isShown=!1,this._dialog=e,this._dialog.attr("tabindex",-1),this._dialog.modal({backdrop:!0,keyboard:!0,show:!1}),this._dialog.on("hidden.bs.modal",function(){t._isShown&&t.hide()}),this._initDialogContentObj(),this._dialogContent.dialog.draggable({handle:".modal-header",containment:"window"}),r(window).on("resize",this,this._onWindowResize),this._dialog.on("hide.bs.modal",function(){t._dialogContent.body.trigger("click")}),this._dialogContent.header.on("mousedown",function(){t._dialogContent.body.trigger("click")})}t.Dialog=e}(e.UI||(e.UI={}))}(StockChartX=StockChartX||{});__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}();!function(e){!function(n){"use strict";var e={CLONE:"clone",DELETE:"delete",SETTINGS:"settings"};Object.freeze(e);var o,t=(o=n.ContextMenu,__extends(r,o),r.MenuItem=e,r);function r(t,e){var i=o.call(this,t,e)||this;return n.HtmlLoader.loadHtml("DrawingContextMenu.html",function(e){r._container||(r._container=n.HtmlContainer.instance.register("DrawingContextMenu",e)),t.menuContainer=r._container}),i}n.DrawingContextMenu=t}(e.UI||(e.UI={}))}(StockChartX=StockChartX||{});var __awaiter=this&&this.__awaiter||function(r,a,s,l){return new(s=s||Promise)(function(e,t){function i(e){try{o(l.next(e))}catch(e){t(e)}}function n(e){try{o(l.throw(e))}catch(e){t(e)}}function o(t){t.done?e(t.value):new s(function(e){e(t.value)}).then(i,n)}o((l=l.apply(r,a||[])).next())})},__generator=this&&this.__generator||function(i,n){var o,r,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,r&&(a=r[2&t[0]?"return":t[0]?"throw":"next"])&&!(a=a.call(r,t[1])).done)return a;switch(r=0,a&&(t=[0,a.value]),t[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,r=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=n.call(i,s)}catch(e){t=[6,e],r=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}};!function(F){!function(e){"use strict";var c="x",h="y",d="date",_="value",u="record",p=jQuery,t="scxCoordinatePanel",f="scxCoordinateTable",o="scxCoordinate-input-container",l="scxCoordinate-type-container",m="scxCoordinate-type-item",g="scxCoordinate-input",b="scxCoordinate-datetimepicker",y="scxCoordinate-point-label",w="active",x="x",v="y",C="record",S="date",k="price",P=[c,u,d],L=[h,_],T={showArrows:!1,canBeNegative:!0,value:0,minValue:-1e8},D={showArrows:!1,canBeNegative:!0,priceDecimals:5,value:0,minValue:-1e9},i=(n.prototype._init=function(e){this._container=p('<div class="'+t+'" />').appendTo(e)},n.prototype._fill=function(){return __awaiter(this,void 0,void 0,function(){var t,i,n,o,r,a,s,l;return __generator(this,function(e){switch(e.label){case 0:return t=this._table=p('<table class="'+f+'" />'),[4,this._drawing.pointsLocalizationKeys()];case 1:if(!(i=e.sent()))return[2];for(n=0;n<i.length;n++)o=p("<tr/>").appendTo(t),r=this._drawing.createPointBehavior,a=p('<span class="'+y+'" data-i18n="'+i[n]+'"/>'),s=this._createCoordinateInput(n,r.x,P),l=this._createCoordinateInput(n,r.y,L),this._inputs.push(s,l),o.append([p("<td/>").append(a),p("<td/>").append(s.container),p("<td/>").append(l.container)]);return this._drawing.chart.localize(this._container.append(t)),[2]}})})},n.prototype._createCoordinateInput=function(r,e,t){var a=this,i=this._getPointCoordinates(r,e),n=p('<div class="'+o+'"/>'),s=p('<input class="'+g+' form-control scxNumericField">').scxNumericField(T),l=this._createTypeChooser(t,e),c={container:n,inputElement:s,type:e},h=this._createDatePicker();return e===d?(h.data("DateTimePicker").date(i),p(s).hide(),h.show()):(e===_&&s.scxNumericField(D),s.scxNumericField("setValue",i)),n.append(l,s,h),l.find("."+m).on(F.MouseEvent.CLICK,function(e){var t,i,n=p(e.target),o=n.data("type");o!==c.type&&(c.type=o,t=a._getPointCoordinates(r,o),o===d?(h.data("DateTimePicker").date(t),p(s).hide(),h.show()):(i=o===_?D:T,s.scxNumericField(i),s.scxNumericField("setValue",t),p(s).show(),h.hide()),p("."+m,l).removeClass(w),n.addClass(w))}),c},n.prototype._createDatePicker=function(){var t=p('<input class="'+b+' form-control"/>');return p(t).datetimepicker({widgetPositioning:{vertical:"top"},widgetParent:p(".scxDialog.in .modal-content"),locale:this._drawing.chart.locale}),p(t).on("dp.change",function(e){null==e.date&&p(t).data("DateTimePicker").date(e.oldDate.toDate())}).on("dp.hide",function(e){""===p(t).val()&&p(t).data("DateTimePicker").date(e.date.toDate())}).hide(),t},n.prototype._createTypeChooser=function(e,t){for(var i=p('<div class="'+l+'"/>'),n=0,o=e;n<o.length;n++){var r=o[n],a="drawing.all.dialog.coordinates.";switch(r){case c:a+=x;break;case h:a+=v;break;case u:a+=C;break;case d:a+=S;break;case _:a+=k}var s=p('<span class="'+m+'" data-type="'+r+'" data-i18n="'+a+'"></span>');r===t&&s.addClass(w),i.append(s)}return i},n.prototype._getPointCoordinates=function(e,t){var i=this._drawing.projection,n=this._drawing.cartesianPoint(e);switch(t){case c:return n.x;case h:return n.y;case d:return i.dateByX(n.x);case u:return i.recordByX(n.x);case _:return i.valueByY(n.y)}},n.prototype._getCartesianPointByCoordinates=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var i=[],n=this._drawing.projection,o=0,r=e;o<r.length;o++){var a=r[o],s=a.inputElement.scxNumericField("getValue");switch(a.type){case c:case h:i.push(s);break;case u:i.push(n.xByRecord(s));break;case d:var l=p("."+b,a.container).data("DateTimePicker").date().toDate();i.push(n.xByDate(l));break;case _:i.push(n.yByValue(s))}}return{x:i[0],y:i[1]}},n.prototype.setValues=function(e){this._drawing=e,this._reset(),this._fill()},n.prototype._reset=function(){this._table&&this._table.remove(),this._inputs=[]},n.prototype.apply=function(){if(0!==this._inputs.length){for(var e=[],t=0;t<this._inputs.length-1;t+=2){var i=this._inputs[t],n=this._inputs[t+1],o=this._getCartesianPointByCoordinates(i,n);e.push(o)}this._drawing.setChartPointsWithNormalize(e)}},n);function n(e){this._inputs=[],this._init(e)}e.CoordinatePanel=i}(F.UI||(F.UI={}))}(StockChartX=StockChartX||{});__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}(),__awaiter=this&&this.__awaiter||function(r,a,s,l){return new(s=s||Promise)(function(e,t){function i(e){try{o(l.next(e))}catch(e){t(e)}}function n(e){try{o(l.throw(e))}catch(e){t(e)}}function o(t){t.done?e(t.value):new s(function(e){e(t.value)}).then(i,n)}o((l=l.apply(r,a||[])).next())})},__generator=this&&this.__generator||function(i,n){var o,r,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,r&&(a=r[2&t[0]?"return":t[0]?"throw":"next"])&&!(a=a.call(r,t[1])).done)return a;switch(r=0,a&&(t=[0,a.value]),t[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,r=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=n.call(i,s)}catch(e){t=[6,e],r=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}};!function(u){!function(a){"use strict";var o,e;(e=o=o||{})[e.DRAWING=0]="DRAWING",e[e.TOOLTIP=1]="TOOLTIP",e[e.POINTS=2]="POINTS";var i,t="#scxDrawingDialog_",n="#scxDrawingDialog_input_",r="#scxDrawingDialog_label_",s="#scxDrawingDialog_chk_",l="#scxDrawingDialog_panel_figure_",c="#scxDrawingDialog_panel_",h="#scxDrawingDialog_tab_",d=(i=a.Dialog,__extends(_,i),_.prototype.show=function(e){this.initDialog(e)&&(this._isApplyClicked=!1,this._setDialogTitle(),this._switchView(),this._tabs.activate(0),this._setValues(this._config.drawing),i.prototype.show.call(this,e),(u.Environment.isPhone||u.Environment.isMobile)&&event.preventDefault())},_.prototype.hide=function(){!this._isApplyClicked&&this._config.cancel&&this._config.cancel(),this._config.always&&this._config.always(),i.prototype.hide.call(this)},_.prototype._init=function(){var o=this;this._tabs=new a.Tabs({tabsContainer:this._tabItemsContainer,panelsContainer:this._tabPanelsContainer,onChange:function(e){o.resize()}}),this._input_lineWidth.scxNumericField(_._numericFieldConfig),this._input_horizontalLineWidth.scxNumericField(_._numericFieldConfig),this._input_arcWidth.scxNumericField(_._numericFieldConfig),this._chk_lineEnabled=new Switchery(document.querySelector(s+"lineColor"),_._switcherySettings),this._chk_lineEnabled.setPosition(!0),this._chk_fillEnabled=new Switchery(document.querySelector(s+"fillColor"),_._switcherySettings),this._chk_fillEnabled.setPosition(!0),this._chk_fill2Enabled=new Switchery(document.querySelector(s+"fillColor2"),_._switcherySettings),this._chk_fill2Enabled.setPosition(!0),this._fillPropertiesHandler=new a.FillPropertiesHandler({label:this._label_fillEnabled,colorPicker:this._input_fillColor,switcher:this._chk_fillEnabled}),this._fillPropertiesHandler2=new a.FillPropertiesHandler({label:this._label_fill2Enabled,colorPicker:this._input_fillColor2,switcher:this._chk_fill2Enabled}),this._input_labelFont.selectpicker({container:"body"}).change(function(e){o._input_labelFont.next().css({"font-family":e.target.value})}),this._input_labelSize.selectpicker({container:"body"}),this._input_lineStyle.selectpicker({container:"body"}),this._input_horizontalLineStyle.selectpicker({container:"body"}),this._input_arcStyle.selectpicker({container:"body"}),this._input_textFont.selectpicker({container:"body"}).change(function(e){o._input_textFont.next().css({"font-family":e.target.value})}),this._input_textSize.selectpicker({container:"body"}),this._textStylesChooser=new a.TextStyleChooser(this._inputs_textStyles),this._initImagePreview(this._input_imageUrl,this._input_imagePreview),this._input_magnetTo.selectpicker({container:"body"}),this._input_magnetMode.selectpicker({container:"body"}),this._dialog.find(".scxSpectrum").scx().colorPicker({containerClassName:"scxSpectrumDrawingDialog",localStorageKey:"scxThemeDialog_spectrum",showAlpha:!0}),$("body").on("scxSwitcherChanged",function(e,t){var i=$(t.target),n=t.checked;i.is(o._chk_lineEnabledHTMLObj)?o._setLineState(n):i.is(o._chk_fillEnabledHTMLObj)?o._fillPropertiesHandler.setState(n):i.is(o._chk_fill2EnabledHTMLObj)?o._fillPropertiesHandler2.setState(n):i.is(o._chk_textBackgroundEnabledHTMLObj)?o._setTextBackgroundState(n):i.is(o._chk_textBorderEnabledHTMLObj)&&o._setTextBorderState(n)}),this._dialog.find(t+"btn_resetToDefaults").on("click",function(){o.resetToDefaults()}),this._dialog.find(t+"btn_save").on("click",function(){o._save()}),this._dialog.find(t+"btn_apply").on("click",function(){o._apply()})},_.prototype._initImagePreview=function(t,i){var n=null;t.on("keyup",function(){var e=t.val();i.parent().addClass("scxLoading"),i.hide(),n&&clearTimeout(n),n=setTimeout(function(){i.attr("src",e)},1e3)}),i.on("load",function(e){$(e.currentTarget).show(),$(e.currentTarget).parent().removeClass("scxHasBg"),$(e.currentTarget).parent().removeClass("scxLoading")}),i.on("error",function(e){$(e.currentTarget).parent().addClass("scxHasBg"),$(e.currentTarget).parent().removeClass("scxLoading"),$(e.currentTarget).hide()})},_.prototype._resetImagePreview=function(e){e.attr("src","").hide().parent().addClass("scxHasBg").removeClass("scxLoading")},_.prototype.resetToDefaults=function(){var e=u.JsUtil.clone(this._config.drawing);if(this._tabs.activeIndex()===o.DRAWING){switch(e.theme=e.defaultTheme,e.className){case u.NoteDrawing.className:$.extend(!0,e,u.NoteDrawing.defaults);break;case u.ImageDrawing.className:e.url="";break;case u.TextDrawing.className:case u.BalloonDrawing.className:e.text=""}this._setValues(e,!0)}this._tabs.activeIndex()===o.TOOLTIP&&this._tooltipView&&this._tooltipView.resetToDefaults(),this._tabs.activeIndex()===o.POINTS&&(this._input_magnetMode.selectpicker("val",u.MagnetMode.NONE).selectpicker("refresh"),this._input_magnetTo.selectpicker("val",u.MagnetPoint.BAR).selectpicker("refresh"),this._coordinatePanel.setValues(this._config.drawing)),this._config.chart.localize(this._dialog)},_.prototype._setLineState=function(e){e?(this._input_lineColor.spectrum("enable"),this._label_lineEnabled.removeClass("disabled"),this._input_lineStyle.removeAttr("disabled").selectpicker("refresh"),this._input_lineWidth.scxNumericField("enable"),this._chk_lineEnabled.isChecked()||this._chk_lineEnabled.setPosition(!0)):(this._input_lineColor.spectrum("disable"),this._label_lineEnabled.addClass("disabled"),this._input_lineStyle.attr("disabled","disabled").selectpicker("refresh"),this._input_lineWidth.scxNumericField("disable"),this._chk_lineEnabled.isChecked()&&this._chk_lineEnabled.setPosition(!0)),this._config.chart&&this._config.chart.localize(this._panelFigureLine)},_.prototype._setTextBackgroundState=function(e){e?(this._input_textBackColor.spectrum("enable"),this._label_textBackgroundEnabled.removeClass("disabled")):(this._input_textBackColor.spectrum("disable"),this._label_textBackgroundEnabled.addClass("disabled"))},_.prototype._setTextBorderState=function(e){e?(this._input_textBorderColor.spectrum("enable"),this._label_textBorderEnabled.removeClass("disabled")):(this._input_textBorderColor.spectrum("disable"),this._label_textBorderEnabled.addClass("disabled"))},_.prototype._switchView=function(){switch(this._dialog.find(".scxSpectrum").spectrum("enable"),this._panelFigure.hide(),this._panelImage.hide(),this._panelText.hide(),this._panelFigureLine.hide(),this._panelFigureLineEnabled.hide(),this._panelFigureFill.hide(),this._panelFigureFillEnabled.hide(),this._panelFigureFill2.hide(),this._panelFigureFill2Enabled.hide(),this._panelFigureLabel.hide(),this._panelFigureArc.hide(),this._panelFigureHorizontalLine.hide(),this._config.drawing.className){case u.DotDrawing.className:case u.SquareDrawing.className:case u.DiamondDrawing.className:case u.ArrowUpDrawing.className:case u.ArrowDownDrawing.className:case u.ArrowLeftDrawing.className:case u.ArrowRightDrawing.className:case u.Arrow.className:this._panelFigureFill.show(),this._panelFigure.show();break;case u.NoteDrawing.className:this._panelFigureFill.show(),this._panelFigureFillEnabled.show(),this._panelFigureFill2.show(),this._panelFigureFill2Enabled.show(),this._panelFigureLabel.show(),this._panelFigure.show();break;case u.LineSegmentDrawing.className:case u.HorizontalLineDrawing.className:case u.VerticalLineDrawing.className:case u.TrendChannelDrawing.className:case u.ErrorChannelDrawing.className:case u.TironeLevelsDrawing.className:case u.QuadrantLinesDrawing.className:case u.RaffRegressionDrawing.className:case u.SpeedLinesDrawing.className:case u.GannFanDrawing.className:case u.PolylineDrawing.className:case u.AndrewsPitchforkDrawing.className:case u.CyclicLinesDrawing.className:this._panelFigureLine.show(),this._panelFigure.show();break;case u.RectangleDrawing.className:case u.TriangleDrawing.className:case u.CircleDrawing.className:case u.EllipseDrawing.className:case u.PolygonDrawing.className:this._panelFigureLine.show(),this._panelFigureLineEnabled.show(),this._panelFigureFill.show(),this._panelFigureFillEnabled.show(),this._panelFigure.show();break;case u.TextDrawing.className:this._panelText.show(),this._input_text.show(),this._inputs_textStyles.show();break;case u.ImageDrawing.className:this._panelImage.show();break;case u.BalloonDrawing.className:this._panelFigureLine.show(),this._panelFigureLineEnabled.show(),this._panelFigureFill.show(),this._panelFigureFillEnabled.show(),this._panelFigure.show(),this._input_text.show(),this._inputs_textStyles.show(),this._panelText.show();break;case u.MeasureDrawing.className:this._panelFigureLine.show(),this._panelFigureLineEnabled.show(),this._panelFigureFill.show(),this._panelFigureFillEnabled.show(),this._panelFigure.show(),this._panelText.show(),this._input_text.hide(),this._inputs_textStyles.hide();break;case u.FreeHandDrawing.className:this._panelFigure.show(),this._panelFigureLine.show();break;case u.TrendAngleDrawing.className:this._panelFigure.show(),this._panelFigureLine.show(),this._panelFigureArc.show(),this._panelFigureHorizontalLine.show()}},_.prototype._setDialogTitle=function(){return __awaiter(this,void 0,void 0,function(){var t,i;return __generator(this,function(e){switch(e.label){case 0:return[4,u.Localization.localizeText(this._config.chart,"drawing."+this._config.drawing.className+".name")];case 1:return t=e.sent(),[4,u.Localization.localizeText(this._config.chart,"drawing.all.dialog.title",{replace:{drawingName:t}})];case 2:return i=e.sent(),this._title.text(i),[2]}})})},_.prototype._setValues=function(e,t){if(!t||t&&this._tabs.activeIndex()===o.DRAWING){var i=e.theme||e.actualTheme;switch(e.className){case u.DotDrawing.className:case u.SquareDrawing.className:case u.DiamondDrawing.className:case u.ArrowUpDrawing.className:case u.ArrowDownDrawing.className:case u.ArrowLeftDrawing.className:case u.ArrowRightDrawing.className:case u.Arrow.className:this._fillPropertiesHandler.theme=i.fill,this._fillPropertiesHandler.setState(!0);break;case u.NoteDrawing.className:this._fillPropertiesHandler.theme=i.fill,this._fillPropertiesHandler.setState(!1!==i.fill.fillEnabled),this._fillPropertiesHandler2.theme=i.centerPointFill,this._fillPropertiesHandler2.setState(!1!==i.centerPointFill.fillEnabled),this._input_labelText.val(e.label),this._input_labelColor.spectrum("set",i.text.fillColor),this._input_labelFont.selectpicker("val",i.text.fontFamily).selectpicker("refresh"),this._input_labelSize.selectpicker("val",i.text.fontSize).selectpicker("refresh");break;case u.LineSegmentDrawing.className:case u.HorizontalLineDrawing.className:case u.VerticalLineDrawing.className:case u.TrendChannelDrawing.className:case u.ErrorChannelDrawing.className:case u.TironeLevelsDrawing.className:case u.QuadrantLinesDrawing.className:case u.RaffRegressionDrawing.className:case u.SpeedLinesDrawing.className:case u.GannFanDrawing.className:case u.PolylineDrawing.className:case u.AndrewsPitchforkDrawing.className:case u.CyclicLinesDrawing.className:this._setLineState(!0),this._input_lineColor.spectrum("set",i.line.strokeColor),this._input_lineStyle.selectpicker("val",i.line.lineStyle||u.LineStyle.SOLID).selectpicker("refresh"),this._input_lineWidth.scxNumericField("setValue",i.line.width);break;case u.RectangleDrawing.className:case u.TriangleDrawing.className:case u.CircleDrawing.className:case u.EllipseDrawing.className:case u.PolygonDrawing.className:this._setLineState(void 0===i.line.strokeEnabled||i.line.strokeEnabled),this._input_lineColor.spectrum("set",i.line.strokeColor),this._input_lineStyle.selectpicker("val",i.line.lineStyle||u.LineStyle.SOLID).selectpicker("refresh"),this._input_lineWidth.scxNumericField("setValue",i.line.width),this._fillPropertiesHandler.theme=i.fill,this._fillPropertiesHandler.setState(!1!==i.fill.fillEnabled);break;case u.TextDrawing.className:this._input_text.val(e.text),this._input_textColor.spectrum("set",i.text.fillColor),this._input_textFont.selectpicker("val",i.text.fontFamily).selectpicker("refresh"),this._input_textSize.selectpicker("val",i.text.fontSize).selectpicker("refresh"),this._textStylesChooser.setStyle("b","bold"===i.text.fontWeight),this._textStylesChooser.setStyle("i","italic"===i.text.fontStyle),this._textStylesChooser.setStyle("u","underline"===i.text.decoration);break;case u.ImageDrawing.className:var n=e.url;this._input_imageUrl.val(n),this._input_imagePreview.attr("src",n),n||this._resetImagePreview(this._input_imagePreview);break;case u.BalloonDrawing.className:this._setLineState(void 0===i.line.strokeEnabled||i.line.strokeEnabled),this._input_lineColor.spectrum("set",i.line.strokeColor),this._input_lineStyle.selectpicker("val",i.line.lineStyle||u.LineStyle.SOLID).selectpicker("refresh"),this._input_lineWidth.scxNumericField("setValue",i.line.width),this._fillPropertiesHandler.theme=i.fill,this._fillPropertiesHandler.setState(!1!==i.fill.fillEnabled),this._input_text.val(e.text),this._input_textColor.spectrum("set",i.text.fillColor),this._input_textFont.selectpicker("val",i.text.fontFamily).selectpicker("refresh"),this._input_textSize.selectpicker("val",i.text.fontSize).selectpicker("refresh"),this._textStylesChooser.setStyle("b","bold"===i.text.fontWeight),this._textStylesChooser.setStyle("i","italic"===i.text.fontStyle),this._textStylesChooser.setStyle("u","underline"===i.text.decoration);break;case u.MeasureDrawing.className:this._setLineState(void 0===i.line.strokeEnabled||i.line.strokeEnabled),this._input_lineColor.spectrum("set",i.line.strokeColor),this._input_lineStyle.selectpicker("val",i.line.lineStyle||u.LineStyle.SOLID).selectpicker("refresh"),this._input_lineWidth.scxNumericField("setValue",i.line.width),this._fillPropertiesHandler.theme=i.fill,this._fillPropertiesHandler.setState(!1!==i.fill.fillEnabled),this._input_text.val(e.text),this._input_textColor.spectrum("set",i.balloon.text.fillColor),this._input_textFont.selectpicker("val",i.balloon.text.fontFamily).selectpicker("refresh"),this._input_textSize.selectpicker("val",i.balloon.text.fontSize).selectpicker("refresh");break;case u.FreeHandDrawing.className:this._setLineState(!0),this._input_lineColor.spectrum("set",i.line.strokeColor),this._input_lineStyle.selectpicker("val",i.line.lineStyle||u.LineStyle.SOLID).selectpicker("refresh"),this._input_lineWidth.scxNumericField("setValue",i.line.width);break;case u.TrendAngleDrawing.className:this._setLineState(!0),this._input_lineColor.spectrum("set",i.line.strokeColor),this._input_lineStyle.selectpicker("val",i.line.lineStyle||u.LineStyle.SOLID).selectpicker("refresh"),this._input_lineWidth.scxNumericField("setValue",i.line.width),this._input_horizontalLineColor.spectrum("set",i.horizontalLine.strokeColor),this._input_horizontalLineStyle.selectpicker("val",i.horizontalLine.lineStyle||u.LineStyle.DOT).selectpicker("refresh"),this._input_horizontalLineWidth.scxNumericField("setValue",i.horizontalLine.width),this._input_arcColor.spectrum("set",i.arc.strokeColor),this._input_arcStyle.selectpicker("val",i.arc.lineStyle||u.LineStyle.DOT).selectpicker("refresh"),this._input_arcWidth.scxNumericField("setValue",i.arc.width)}}(!t||t&&this._tabs.activeIndex()===o.POINTS)&&(e.magnetMode||(e.magnetPoint=u.MagnetPoint.BAR,e.magnetMode=u.MagnetMode.NONE),this._input_magnetMode.selectpicker("val",e.magnetMode).selectpicker("refresh"),this._input_magnetTo.selectpicker("val",e.magnetPoint).selectpicker("refresh"),this._coordinatePanel||(this._coordinatePanel=new a.CoordinatePanel(this._panelPoints)),this._coordinatePanel.setValues(this._config.drawing)),(!t||t&&this._tabs.activeIndex()===o.TOOLTIP)&&this._loadTooltipView(e.tooltip)},_.prototype._save=function(){this._apply(),this._validateInputValue()&&this.hide()},_.prototype._apply=function(){var t=this,e=this._config.drawing;if(e.chart){var i,n,o=$.extend(!0,{},e.actualTheme),r="";switch(this._coordinatePanel.apply(),e.magnetMode?(e.magnetPoint=this._input_magnetTo.val(),e.magnetMode=this._input_magnetMode.val()):(e.magnetPoint=u.MagnetPoint.BAR,e.magnetMode=u.MagnetMode.NONE),i={colorPicker:this._input_lineColor,widthInput:this._input_lineWidth,lineStyleDropdown:this._input_lineStyle},n=new a.LinePropertiesHandler(i),e.className){case u.DotDrawing.className:case u.SquareDrawing.className:case u.DiamondDrawing.className:case u.ArrowUpDrawing.className:case u.ArrowDownDrawing.className:case u.ArrowLeftDrawing.className:case u.ArrowRightDrawing.className:case u.Arrow.className:o.fill.fillColor=this._fillPropertiesHandler.theme.fillColor;break;case u.NoteDrawing.className:o.fill.fillColor=this._fillPropertiesHandler.theme.fillColor,o.fill.fillEnabled=this._fillPropertiesHandler.isEnabled,o.centerPointFill.fillColor=this._fillPropertiesHandler2.theme.fillColor,o.centerPointFill.fillEnabled=this._fillPropertiesHandler2.isEnabled,e.label=this._input_labelText.val(),o.text.fillColor=this._input_labelColor.spectrum("get").toRgbString(),o.text.fontFamily=this._input_labelFont.selectpicker("val"),o.text.fontSize=this._input_labelSize.selectpicker("val");break;case u.LineSegmentDrawing.className:case u.HorizontalLineDrawing.className:case u.VerticalLineDrawing.className:case u.TrendChannelDrawing.className:case u.ErrorChannelDrawing.className:case u.TironeLevelsDrawing.className:case u.QuadrantLinesDrawing.className:case u.RaffRegressionDrawing.className:case u.SpeedLinesDrawing.className:case u.GannFanDrawing.className:case u.PolylineDrawing.className:case u.AndrewsPitchforkDrawing.className:case u.CyclicLinesDrawing.className:o.line=n.theme;break;case u.RectangleDrawing.className:case u.TriangleDrawing.className:case u.CircleDrawing.className:case u.EllipseDrawing.className:case u.PolygonDrawing.className:o.line=n.theme,o.line.strokeEnabled=this._chk_lineEnabled.isChecked(),o.fill.fillEnabled=this._fillPropertiesHandler.isEnabled,o.fill.fillColor=this._fillPropertiesHandler.theme.fillColor;break;case u.ImageDrawing.className:if(!this._validateInputValue())return void u.Localization.localizeText(this._config.chart,"drawing.all.notification.urlIsNotSpecified").then(function(e){a.Notification.warning(e,t._config.chart)});e.url=u.JsUtil.filterText(this._input_imageUrl.val());break;case u.TextDrawing.className:if(!this._validateInputValue())return void u.Localization.localizeText(this._config.chart,"drawing.all.notification.textIsNotSpecified").then(function(e){a.Notification.warning(e,t._config.chart)});r=u.JsUtil.filterText(this._input_text.val()),e.text=r.length?r:e.text,o.text.fillColor=this._input_textColor.spectrum("get").toRgbString(),o.text.fontFamily=this._input_textFont.selectpicker("val"),o.text.fontSize=parseInt(this._input_textSize.selectpicker("val"),10),o.text.fontWeight=this._textStylesChooser.getStyle("b")?"bold":"normal",o.text.fontStyle=this._textStylesChooser.getStyle("i")?"italic":"normal",o.text.decoration=this._textStylesChooser.getStyle("u")?"underline":"";break;case u.BalloonDrawing.className:if(!this._validateInputValue())return void u.Localization.localizeText(this._config.chart,"drawing.all.notification.textIsNotSpecified").then(function(e){a.Notification.warning(e,t._config.chart)});r=u.JsUtil.filterText(this._input_text.val()),e.text=r.length?r:e.text,o.text.fillColor=this._input_textColor.spectrum("get").toRgbString(),o.text.fontFamily=this._input_textFont.selectpicker("val"),o.text.fontSize=parseInt(this._input_textSize.selectpicker("val"),10),o.text.fontWeight=this._textStylesChooser.getStyle("b")?"bold":"normal",o.text.fontStyle=this._textStylesChooser.getStyle("i")?"italic":"normal",o.text.decoration=this._textStylesChooser.getStyle("u")?"underline":"",o.line=n.theme,o.line.strokeEnabled=this._chk_lineEnabled.isChecked(),o.fill.fillEnabled=this._fillPropertiesHandler.isEnabled,o.fill.fillColor=this._fillPropertiesHandler.theme.fillColor;break;case u.MeasureDrawing.className:o.line=n.theme,o.line.strokeEnabled=this._chk_lineEnabled.isChecked(),o.border=n.theme,o.border.strokeEnabled=this._chk_lineEnabled.isChecked(),o.fill.fillEnabled=this._fillPropertiesHandler.isEnabled,o.fill.fillColor=this._fillPropertiesHandler.theme.fillColor,o.balloon.fill.fillEnabled=this._fillPropertiesHandler.isEnabled,o.balloon.fill.fillColor=this._fillPropertiesHandler.theme.fillColor,o.balloon.text.fillColor=this._input_textColor.spectrum("get").toRgbString(),o.balloon.text.fontFamily=this._input_textFont.selectpicker("val"),o.balloon.text.fontSize=parseInt(this._input_textSize.selectpicker("val"),10);break;case u.FreeHandDrawing.className:o.line=n.theme;break;case u.TrendAngleDrawing.className:o.line=n.theme,i={colorPicker:this._input_horizontalLineColor,widthInput:this._input_horizontalLineWidth,lineStyleDropdown:this._input_horizontalLineStyle},n=new a.LinePropertiesHandler(i),o.horizontalLine=n.theme,i={colorPicker:this._input_arcColor,widthInput:this._input_arcWidth,lineStyleDropdown:this._input_arcStyle},n=new a.LinePropertiesHandler(i),o.arc=n.theme}this._config.drawing.theme=o,this._tooltipView&&this._tooltipView.apply(),this._config.drawing.chartPanel.update(),this._isApplyClicked=!0}},_.prototype._validateInputValue=function(){switch(this._config.drawing.className){case u.ImageDrawing.className:if(!u.JsUtil.filterText(this._input_imageUrl.val()).length)return!1;break;case u.TextDrawing.className:case u.BalloonDrawing.className:if(!u.JsUtil.filterText(this._input_text.val()))return!1}return!0},_.prototype._loadTooltipView=function(t){var i=this;a.ViewLoader.tooltipView(function(e){e.container=i._tab_tooltip,e.setValues(t),i._tooltipView=e,i._tooltipView.chart=i._config.chart,i._config.chart.localize(i._dialog)})},_.prototype._initFields=function(){this._title=this._dialog.find(t+"title"),this._tabItemsContainer=this._dialog.find(".scxTabs"),this._tabPanelsContainer=this._dialog.find(".scxTabsContent"),this._tab_tooltip=this._dialog.find(h+"tooltip"),this._panelFigure=this._dialog.find(c+"figure"),this._panelFigureLine=this._dialog.find(l+"linePanel"),this._panelFigureHorizontalLine=this._dialog.find(l+"horizontalLinePanel"),this._panelFigureArc=this._dialog.find(l+"arcPanel"),this._panelFigureLineEnabled=this._dialog.find(l+"lineEnabled"),this._panelFigureFill=this._dialog.find(l+"fillColorPanel"),this._panelFigureFillEnabled=this._dialog.find(l+"fillColorPanel_fillEnabled"),this._panelFigureFill2=this._dialog.find(l+"fillColorPanel2"),this._panelFigureFill2Enabled=this._dialog.find(l+"fillColorPanel2_fillEnabled"),this._panelFigureLabel=this._dialog.find(l+"label"),this._panelPoints=this._dialog.find(c+"points"),this._panelText=this._dialog.find(c+"text"),this._panelImage=this._dialog.find(c+"image"),this._input_lineColor=this._dialog.find(n+"lineColor"),this._input_lineWidth=this._dialog.find(n+"lineWidth"),this._input_lineStyle=this._dialog.find(n+"lineStyle"),this._input_fillColor=this._dialog.find(n+"fillColor"),this._input_fillColor2=this._dialog.find(n+"fillColor2"),this._input_labelText=this._dialog.find(n+"labelText"),this._input_labelColor=this._dialog.find(n+"labelColor"),this._input_labelFont=this._dialog.find(n+"labelFont"),this._input_labelSize=this._dialog.find(n+"labelSize"),this._input_horizontalLineColor=this._dialog.find(n+"horizontalLineColor"),this._input_horizontalLineWidth=this._dialog.find(n+"horizontalLineWidth"),this._input_horizontalLineStyle=this._dialog.find(n+"horizontalLineStyle"),this._input_arcColor=this._dialog.find(n+"arcColor"),this._input_arcWidth=this._dialog.find(n+"arcWidth"),this._input_arcStyle=this._dialog.find(n+"arcStyle"),this._input_text=this._dialog.find(n+"text"),this._input_textColor=this._dialog.find(n+"textColor"),this._input_textFont=this._dialog.find(n+"textFont"),this._input_textSize=this._dialog.find(n+"textSize"),this._input_textColor=this._dialog.find(n+"textColor"),this._inputs_textStyles=this._dialog.find(".scxDrawingDialog_textStyles"),this._textStylesChooser=null,this._input_textBackColor=this._dialog.find(n+"textBackgroundColor"),this._input_textBorderColor=this._dialog.find(n+"textBorderColor"),this._input_imageUrl=this._dialog.find(n+"imageURL"),this._input_imagePreview=this._dialog.find(t+"imagePreview"),this._chk_lineEnabledHTMLObj=this._dialog.find(s+"lineColor"),this._chk_fillEnabledHTMLObj=this._dialog.find(s+"fillColor"),this._chk_fill2EnabledHTMLObj=this._dialog.find(s+"fillColor2"),this._chk_textBackgroundEnabledHTMLObj=this._dialog.find(s+"textBackgroundColor"),this._chk_textBorderEnabledHTMLObj=this._dialog.find(s+"textBorderColor"),this._label_lineEnabled=this._dialog.find(r+"lineColor"),this._label_fillEnabled=this._dialog.find(r+"fillColor"),this._label_fill2Enabled=this._dialog.find(r+"fillColor2"),this._label_textBackgroundEnabled=this._dialog.find(r+"textBackgroundColor"),this._label_textBorderEnabled=this._dialog.find(r+"textBorderColor"),this._input_magnetTo=this._dialog.find(n+"magnetTo"),this._input_magnetMode=this._dialog.find(n+"magnetMode")},_._numericFieldConfig={showArrows:!1,maxValue:10,minValue:1,value:1},_._switcherySettings={color:"rgba(72, 149, 245, 0.2)",secondaryColor:"rgba(16, 17, 20, 1)",jackColor:"rgba(72, 149, 245, 1)",jackSecondaryColor:"rgba(81, 83, 90, 1)",className:"scx_switchery",disabled:!1,disabledOpacity:.5,speed:"0.4s"},_);function _(e){var t=i.call(this,e)||this;return t._isApplyClicked=!1,t._initFields(),t._init(),t}a.DrawingSettingsDialog=d}(u.UI||(u.UI={}))}(StockChartX=StockChartX||{});__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}(),__awaiter=this&&this.__awaiter||function(r,a,s,l){return new(s=s||Promise)(function(e,t){function i(e){try{o(l.next(e))}catch(e){t(e)}}function n(e){try{o(l.throw(e))}catch(e){t(e)}}function o(t){t.done?e(t.value):new s(function(e){e(t.value)}).then(i,n)}o((l=l.apply(r,a||[])).next())})},__generator=this&&this.__generator||function(i,n){var o,r,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,r&&(a=r[2&t[0]?"return":t[0]?"throw":"next"])&&!(a=a.call(r,t[1])).done)return a;switch(r=0,a&&(t=[0,a.value]),t[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,r=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=n.call(i,s)}catch(e){t=[6,e],r=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}};!function(f){!function(h){"use strict";var d,e;(e=d=d||{})[e.LEVELS=0]="LEVELS",e[e.TOOLTIP=1]="TOOLTIP",e[e.POINTS=2]="POINTS";var i,l="#scxFibonacciDrawingDialog_",_=".scxFibonacciDrawingDialog_input_",t="#scxFibonacciDrawingDialog_tab_",c=".scxFibonacciDrawingDialog_chk_",n=".scxFibonacciDrawingDialog_panel_figure_",u=".scxFibonacciDrawingDialog_panel_",o="scxSpectrumDrawingDialog",r=(i=h.Dialog,__extends(p,i),p.prototype.show=function(e){this.initDialog(e)&&(this._setDialogTitle(),this._setDrawingConfig(this._config.drawing),this._tabs.activate(0),this._setDialogFields(),i.prototype.show.call(this,e))},p.prototype.hide=function(){this._clearDialogFields(),i.prototype.hide.call(this)},p.prototype._init=function(){var r=this;this._tabs=new h.Tabs({tabsContainer:this._tabItemsContainer,panelsContainer:this._tabPanelsContainer,onChange:function(e){r.resize()}}),this._input_magnetTo.selectpicker({container:"body"}),this._input_magnetMode.selectpicker({container:"body"}),$("body").on("scxSwitcherChanged",function(e,t){var i,n=$(t.target),o=!!t.checked;n.is(r._chk_lineEnabledHTMLObj)&&(i=$(t.target).index(".scxFibonacciDrawingDialog_chk_lineEnable"),r._setLineState(o,i)),n.is(r._chk_trendLineEnabledHTMLObj)&&r._setTrendLineState(o),n.is(r._chk_levelsValueEnabledHTMLObj)&&(r._showLevelValues=o,r._setLevelsState(o)),n.is(r._chk_levelsPriceEnabledHTMLObj)&&(r._setLabelState(r._label_levelPrices,o),r._showLevelPrices=o),n.is(r._chk_levelsPercentEnabledHTMLObj)&&(r._setLabelState(r._label_levelPercents,o),r._showLevelPercents=o),n.is(r._chk_linesReverseEnabledHTMLObj)&&(r._setLabelState(r._label_reverse,o),r._reverse=o),n.is(r._chk_extendLinesLeftEnabledHTMLObj)&&(r._setLabelState(r._label_extendLinesLeft,o),r._setLevelLinesExtension(o,f.FibonacciLevelLineExtension.RIGHT,f.FibonacciLevelLineExtension.LEFT)),n.is(r._chk_extendLinesRightEnabledHTMLObj)&&(r._setLabelState(r._label_extendLinesRight,o),r._setLevelLinesExtension(o,f.FibonacciLevelLineExtension.LEFT,f.FibonacciLevelLineExtension.RIGHT)),n.is(r._chk_extendLinesTopEnabledHTMLObj)&&(r._setLabelState(r._label_extendLinesTop,o),r._setLevelLinesExtension(o,f.FibonacciLevelLineExtension.BOTTOM,f.FibonacciLevelLineExtension.TOP)),n.is(r._chk_extendLinesBottomEnabledHTMLObj)&&(r._setLabelState(r._label_extendLinesBottom,o),r._setLevelLinesExtension(o,f.FibonacciLevelLineExtension.TOP,f.FibonacciLevelLineExtension.BOTTOM)),n.is(r._chk_backgroundEnabledHTMLObj)&&(r._setLabelState(r._label_background,o),r._showLevelBackgrounds=o)}),this._dialog.find(l+"btn_resetToDefaults").on("click",function(){r.resetToDefaults()}),this._dialog.find(l+"btn_save").on("click",function(){r._save()}),this._dialog.find(l+"btn_apply").on("click",function(){r._apply()}),this._dialog.find(u+"addLinePanel").on("click",function(){r._addNewLinePanel()});var e=this._panelFigureTrendLinePanel.find(".scxFibonacciDrawingDialog_chk_trendLine");this._chk_trendLineEnabled=new Switchery(e[0],p._switcherySettings);var t=this._dialog.find(c+"extendLinesLeft");this._chk_extendLinesLeftEnabled=new Switchery(t[0],p._switcherySettings);var i=this._dialog.find(c+"extendLinesRight");this._chk_extendLinesRightEnabled=new Switchery(i[0],p._switcherySettings);var n=this._dialog.find(c+"extendLinesTop");this._chk_extendLinesTopEnabled=new Switchery(n[0],p._switcherySettings);var o=this._dialog.find(c+"extendLinesBottom");this._chk_extendLinesBottomEnabled=new Switchery(o[0],p._switcherySettings);var a=this._dialog.find(c+"linesReverse");this._chk_linesReverseEnabled=new Switchery(a[0],p._switcherySettings);var s=this._dialog.find(c+"background");this._chk_backgroundEnabled=new Switchery(s[0],p._switcherySettings)},p.prototype._initFields=function(){this._title=this._dialog.find(l+"title"),this._tabItemsContainer=this._dialog.find(".scxTabs"),this._tabPanelsContainer=this._dialog.find(".scxTabsContent"),this._panelFigure=this._dialog.find(u+"figure"),this._panelFigureLine=this._dialog.find(n+"linePanel"),this._panelFigureTrendLinePanel=this._dialog.find(n+"trendLinePanel"),this._panelFigureLevelParametersPanel=this._dialog.find(n+"levelParametersPanel"),this._panelFigureRetracementsOptionsPanel=this._dialog.find(n+"retracementsOptionsPanel"),this._panelFigureLabelsParametersPanel=this._dialog.find(n+"labelsParametersPanel"),this._tabTooltip=this._dialog.find(t+"tooltip"),this._panelPoints=this._dialog.find(u+"points"),this._input_magnetTo=this._dialog.find(_+"magnetTo"),this._input_magnetMode=this._dialog.find(_+"magnetMode")},p.prototype._setDialogFields=function(e){this._addLinePanel(),this._generateLevelParameters(),this._defineDomObjects(),this._setTrendLineParameters(),this._setRetracementsOptions(),this._setLevelParameters(),this._setLabelsParameters(),this._setBackgroundParameters(),this._setValues(e),this._switchView()},p.prototype._setDrawingConfig=function(e){this._showTrendLine=e.showTrendLine,this._showLevelValues=e.showLevelValues,this._showLevelPrices=e.showLevelPrices,this._showLevelPercents=e.showLevelPercents,this._showLevelBackgrounds=e.showLevelBackgrounds,this._levelLinesExtension=e.levelLinesExtension,this._reverse=e.reverse,this._levelTextHorPosition=e.levelTextHorPosition,this._levelTextVerPosition=e.levelTextVerPosition,this._levels=$.extend(!0,[],e.levels)},p.prototype._setLabelState=function(e,t){t?e.removeClass("disabled"):e.addClass("disabled")},p.prototype._setLevelLinesExtension=function(e,t,i){e?this._levelLinesExtension=this._levelLinesExtension===t?f.FibonacciLevelLineExtension.BOTH:i:this._levelLinesExtension===f.FibonacciLevelLineExtension.BOTH?this._levelLinesExtension=t:this._levelLinesExtension=f.FibonacciLevelLineExtension.NONE},p.prototype._setLineState=function(e,t){var i=this._panelFigureLine.find(_+"lineColor").eq(t),n=this._panelFigureLine.find(_+"lineLevel").eq(t),o=this._panelFigureLine.find(_+"lineWidth").eq(t),r=this._panelFigureLine.find(_+"lineStyle:even").eq(t);e?(i.spectrum("enable"),r.removeAttr("disabled"),r.selectpicker("refresh"),o.scxNumericField("enable"),n.scxNumericField("enable"),this._levels[t].visible=!0):(i.spectrum("disable"),r.attr("disabled","disabled"),r.selectpicker("refresh"),o.scxNumericField("disable"),n.scxNumericField("disable"),this._levels[t].visible=!1),this._config.chart&&this._config.chart.localize(this._panelFigureLine)},p.prototype._setTrendLineState=function(e){e?(this._label_trendLine.removeClass("disabled"),this._input_trendLineColor.spectrum("enable"),this._input_trendLineWidth.scxNumericField("enable"),this._input_trendLineStyle.removeAttr("disabled"),this._input_trendLineStyle.selectpicker("refresh"),this._chk_trendLineEnabled.isChecked()||this._chk_trendLineEnabled.setPosition(!0),this._showTrendLine=!0):(this._label_trendLine.addClass("disabled"),this._input_trendLineColor.spectrum("disable"),this._input_trendLineWidth.scxNumericField("disable"),this._input_trendLineStyle.attr("disabled","disabled"),this._input_trendLineStyle.selectpicker("refresh"),this._chk_trendLineEnabled.isChecked()&&this._chk_trendLineEnabled.setPosition(!0),this._showTrendLine=!1),this._config&&this._config.chart.localize(this._panelFigureTrendLinePanel)},p.prototype._setLevelsState=function(e){e?(this._label_levels.removeClass("disabled"),this._chk_levelsPriceEnabled.isChecked()&&this._label_levelPrices.removeClass("disabled"),this._chk_levelsPercentEnabled.isChecked()&&this._label_levelPercents.removeClass("disabled"),this._chk_levelsPriceEnabled.enable(),this._chk_levelsPercentEnabled.enable()):(this._label_levels.addClass("disabled"),this._label_levelPrices.addClass("disabled"),this._label_levelPercents.addClass("disabled"),this._chk_levelsPriceEnabled.disable(),this._chk_levelsPercentEnabled.disable()),p._switcherySettings.disabled=!1},p.prototype._switchView=function(){switch(this._panelFigureLine.show(),this._panelFigure.show(),this._config.drawing.className){case f.FibonacciArcsDrawing.className:return this._panelFigureRetracementsOptionsPanel.hide(),this._levelsPriceEnabled.hide(),this._labelsHorEnabled.show(),void this._panelFigureTrendLinePanel.show();case f.FibonacciEllipsesDrawing.className:return this._panelFigureRetracementsOptionsPanel.hide(),this._labelsHorEnabled.show(),this._levelsPriceEnabled.hide(),void this._panelFigureTrendLinePanel.show();case f.FibonacciTimeZonesDrawing.className:return this._levelsExtendHorEnabled.hide(),this._levelsExtendVerEnabled.show(),this._levelsReverseEnabled.hide(),this._panelFigureRetracementsOptionsPanel.show(),this._levelsPriceEnabled.hide(),this._levelsPercentEnabled.hide(),void this._panelFigureTrendLinePanel.show();case f.FibonacciRetracementsDrawing.className:return this._levelsExtendHorEnabled.show(),this._levelsExtendVerEnabled.hide(),this._levelsReverseEnabled.show(),this._panelFigureRetracementsOptionsPanel.show(),void this._panelFigureTrendLinePanel.show();case f.FibonacciFanDrawing.className:return this._panelFigureRetracementsOptionsPanel.hide(),this._panelFigureTrendLinePanel.hide(),void this._labelsHorEnabled.hide();case f.FibonacciExtensionsDrawing.className:return this._levelsExtendHorEnabled.show(),this._levelsExtendVerEnabled.hide(),this._levelsReverseEnabled.show(),this._panelFigureRetracementsOptionsPanel.show(),void this._panelFigureTrendLinePanel.show();default:return}},p.prototype._setDialogTitle=function(){return __awaiter(this,void 0,void 0,function(){var t,i,n;return __generator(this,function(e){switch(e.label){case 0:return t=this._config.drawing.className,[4,f.Localization.localizeText(this._config.chart,"drawing."+t+".name",{defaultValue:t})];case 1:return i=e.sent(),[4,f.Localization.localizeText(this._config.chart,"drawing.all.dialog.title",{replace:{drawingName:i}})];case 2:return n=e.sent(),this._title.text(n),[2]}})})},p.prototype._setValues=function(e){var t=this._config.drawing;if(!e||e&&this._tabs.activeIndex()===d.LEVELS){for(var i=0;i<this._levels.length;i++){var n=this._levels[i],o=t.className===f.FibonacciTimeZonesDrawing.className;this._input_lineLevel[i].value=o?n.value:n.value.toFixed(3);var r=this._dialog.find(_+"lineColor").eq(i),a=this._dialog.find(_+"lineWidth").eq(i),s=this._dialog.find(_+"lineStyle:even").eq(i),l=n.theme&&n.theme.line||t.actualTheme&&t.actualTheme.line,c={colorPicker:r,widthInput:a,lineStyleDropdown:s};new h.LinePropertiesHandler(c).theme=l}t.className!==f.FibonacciFanDrawing.className&&(c={colorPicker:this._input_trendLineColor,widthInput:this._input_trendLineWidth,lineStyleDropdown:this._input_trendLineStyle},new h.LinePropertiesHandler(c).theme=t.actualTheme.trendLine)}(!e||e&&this._tabs.activeIndex()===d.TOOLTIP)&&this._loadTooltipView(t.tooltip),(!e||e&&this._tabs.activeIndex()===d.POINTS)&&(this._input_magnetMode.selectpicker("val",this._config.drawing.magnetMode).selectpicker("refresh"),this._input_magnetTo.selectpicker("val",this._config.drawing.magnetPoint).selectpicker("refresh"),this._coordinatePanel||(this._coordinatePanel=new h.CoordinatePanel(this._panelPoints)),this._coordinatePanel.setValues(this._config.drawing)),this._config.chart.localize(this._dialog)},p.prototype._getValues=function(){for(var e=0;e<this._levels.length;e++){var t=this._levels[e];t.value=parseFloat(this._input_lineLevel[e].value);var i=this._dialog.find(_+"lineColor").eq(e),n={colorPicker:i,widthInput:this._dialog.find(_+"lineWidth").eq(e),lineStyleDropdown:this._dialog.find(_+"lineStyle:even").eq(e)},o=new h.LinePropertiesHandler(n);t.theme||(t.theme={}),t.theme.line||(t.theme.line={}),t.theme.fill||(t.theme.fill={}),t.theme.text||(t.theme.text=this._config.drawing.actualTheme.text?$.extend(!0,{},this._config.drawing.actualTheme.text):{}),t.theme.line=o.theme;var r=i.spectrum("get").toRgb();t.theme.text.fillColor=tinycolor(r).toRgbString(),r.a=.3,t.theme.fill.fillColor=tinycolor(r).toRgbString()}var a=this._config.drawing.theme=$.extend(!0,{},this._config.drawing.actualTheme);this._config.drawing.className!==f.FibonacciFanDrawing.className&&(n={colorPicker:this._input_trendLineColor,widthInput:this._input_trendLineWidth,lineStyleDropdown:this._input_trendLineStyle},o=new h.LinePropertiesHandler(n),a.trendLine=o.theme),this._levelTextHorPosition=this._input_labelsPosition.val(),this._levelTextVerPosition=this._input_labelsTextPosition.val()},p.prototype.resetToDefaults=function(){var e,t,i=this._config.drawing.defaultTheme;if(this._tabs.activeIndex()===d.LEVELS){switch(this._config.drawing.className){case f.FibonacciArcsDrawing.className:e=f.FibonacciArcsDrawing.defaults;break;case f.FibonacciEllipsesDrawing.className:e=f.FibonacciEllipsesDrawing.defaults;break;case f.FibonacciRetracementsDrawing.className:e=f.FibonacciRetracementsDrawing.defaults;break;case f.FibonacciFanDrawing.className:e=f.FibonacciFanDrawing.defaults;break;case f.FibonacciExtensionsDrawing.className:e=f.FibonacciExtensionsDrawing.defaults;break;case f.FibonacciTimeZonesDrawing.className:e=f.FibonacciTimeZonesDrawing.defaults}t=$.extend(!1,f.FibonacciDrawingBase.defaults,e),this._clearDialogFields(),this._setDrawingConfig(t),this._setDialogFields(!0),this.resize(),this._config.drawing.className!==f.FibonacciFanDrawing.className&&(this._input_trendLineColor.spectrum("set",i.trendLine.strokeColor),this._input_trendLineWidth.scxNumericField("setValue",i.trendLine.width),this._input_trendLineStyle.selectpicker("val",i.trendLine.lineStyle).selectpicker("refresh"))}this._tabs.activeIndex()===d.TOOLTIP&&this._tooltipView.resetToDefaults(),this._tabs.activeIndex()===d.POINTS&&(this._input_magnetMode.selectpicker("val",f.MagnetMode.NONE).selectpicker("refresh"),this._input_trendLineStyle.selectpicker("val",i.trendLine.lineStyle).selectpicker("refresh"),this._input_magnetTo.selectpicker("val",f.MagnetPoint.BAR).selectpicker("refresh"),this._coordinatePanel.setValues(this._config.drawing)),this._config.chart.localize(this._dialog)},p.prototype._apply=function(){var e;this._config.drawing.chart&&(e=this._config.drawing,this._getValues(),this._tooltipView&&this._tooltipView.apply(),e.magnetMode?(e.magnetPoint=this._input_magnetTo.val(),e.magnetMode=this._input_magnetMode.val()):(e.magnetPoint=f.MagnetPoint.BAR,e.magnetMode=f.MagnetMode.NONE),this._coordinatePanel.apply(),e.showTrendLine=this._showTrendLine,e.showLevels=this._showLevelValues,e.showLevelPrices=this._showLevelPrices,e.showLevelPercents=this._showLevelPercents,e.showLevelBackgrounds=this._showLevelBackgrounds,void 0!==e.levelLinesExtension&&(e.levelLinesExtension=this._levelLinesExtension),void 0!==e.reverse&&(e.reverse=this._reverse),e.levelTextHorPosition=this._levelTextHorPosition,e.levelTextVerPosition=this._levelTextVerPosition,e.levels=this._levels,e.chartPanel.update())},p.prototype._save=function(){this._apply(),this.hide()},p.prototype._addNewLinePanel=function(){var e=this._config.drawing.actualTheme;this._getValues(),this._levels.push({value:0,visible:!0,theme:$.extend(!0,{},{line:e.line})}),this._clearLinePanel(),this._addLinePanel(),this._setValues(!0),this.resize()},p.prototype._addLinePanel=function(){var e=this;this._levels.forEach(function(){e._generateLinePanel()}),this._defineDomLevelObjects(),this._setLinePanelsProperties()},p.prototype._deleteLinePanel=function(e){this._getValues();var t=$(e.currentTarget).index(".scxFibonacciDrawingDialog_panel_deleteLinePanel");this._levels.splice(t,1),this._panelFigureLine.eq(t).remove(),this._clearLinePanel(),this._addLinePanel(),this._setValues(!0),this.resize()},p.prototype._clearDialogFields=function(){$(".scxDropdown").removeClass("open"),this._clearLinePanel(),this._clearDialogParameters()},p.prototype._clearLinePanel=function(){this._panelFigureLine.remove(),$("body").find(_+"lineColor"+o).remove()},p.prototype._clearDialogParameters=function(){this._panelFigureLevelParameters.remove()},p.prototype._setBackgroundParameters=function(){this._setSwitcheryPosition(this._showLevelBackgrounds,this._chk_backgroundEnabled),this._setLabelState(this._label_background,this._showLevelBackgrounds)},p.prototype._setLabelsParameters=function(){this._input_labelsPosition.selectpicker({container:"body"}),this._input_labelsPosition.selectpicker("val",this._levelTextHorPosition).selectpicker("refresh"),this._input_labelsTextPosition.selectpicker({container:"body"}),this._input_labelsTextPosition.selectpicker("val",this._levelTextVerPosition).selectpicker("refresh")},p.prototype._setRetracementsOptions=function(){switch(this._setSwitcheryPosition(this._reverse,this._chk_linesReverseEnabled),this._setLabelState(this._label_reverse,this._reverse),this._levelLinesExtension){case f.FibonacciLevelLineExtension.NONE:return this._setSwitcheryPosition(!1,this._chk_extendLinesLeftEnabled),this._setSwitcheryPosition(!1,this._chk_extendLinesRightEnabled),this._setSwitcheryPosition(!1,this._chk_extendLinesTopEnabled),this._setSwitcheryPosition(!1,this._chk_extendLinesBottomEnabled),this._setLabelState(this._label_extendLinesLeft,!1),this._setLabelState(this._label_extendLinesRight,!1),this._setLabelState(this._label_extendLinesTop,!1),void this._setLabelState(this._label_extendLinesBottom,!1);case f.FibonacciLevelLineExtension.LEFT:return this._setSwitcheryPosition(!0,this._chk_extendLinesLeftEnabled),void this._setLabelState(this._label_extendLinesLeft,!0);case f.FibonacciLevelLineExtension.RIGHT:return this._setSwitcheryPosition(!0,this._chk_extendLinesRightEnabled),void this._setLabelState(this._label_extendLinesRight,!0);case f.FibonacciLevelLineExtension.TOP:return this._setSwitcheryPosition(!0,this._chk_extendLinesTopEnabled),void this._setLabelState(this._label_extendLinesTop,!0);case f.FibonacciLevelLineExtension.BOTTOM:return this._setSwitcheryPosition(!0,this._chk_extendLinesBottomEnabled),void this._setLabelState(this._label_extendLinesBottom,!0);case f.FibonacciLevelLineExtension.BOTH:return this._setSwitcheryPosition(!0,this._chk_extendLinesLeftEnabled),this._setSwitcheryPosition(!0,this._chk_extendLinesRightEnabled),this._setSwitcheryPosition(!0,this._chk_extendLinesTopEnabled),this._setSwitcheryPosition(!0,this._chk_extendLinesBottomEnabled),this._setLabelState(this._label_extendLinesLeft,!0),this._setLabelState(this._label_extendLinesRight,!0),this._setLabelState(this._label_extendLinesTop,!0),void this._setLabelState(this._label_extendLinesBottom,!0);default:return}},p.prototype._setSwitcheryPosition=function(e,t){e?t.isChecked()||t.setPosition(!0):t.isChecked()&&t.setPosition(!0)},p.prototype._setLevelParameters=function(){var e=this._dialog.find(c+"levelsValue"),t=new Switchery(e[0],p._switcherySettings),i=this._dialog.find(c+"levelsPrice");this._chk_levelsPriceEnabled=new Switchery(i[0],p._switcherySettings);var n=this._dialog.find(c+"levelsPercent");this._chk_levelsPercentEnabled=new Switchery(n[0],p._switcherySettings),this._chk_levelsPriceEnabled.setPosition(this._showLevelPrices),this._chk_levelsPercentEnabled.setPosition(this._showLevelPercents),t.setPosition(this._showLevelValues),this._showLevelValues||this._setLevelsState(this._showLevelValues)},p.prototype._setTrendLineParameters=function(){this._input_trendLineWidth.scxNumericField(p._numericFieldConfig),this._setTrendLineState(this._showTrendLine)},p.prototype._setLinePanelsProperties=function(){this._config.drawing.className===f.FibonacciTimeZonesDrawing.className?this._input_lineLevel.scxNumericField(p._numericTimeZoneFieldConfig):this._input_lineLevel.scxNumericField(p._numericDoubleFieldConfig),this._input_lineWidth.scxNumericField(p._numericFieldConfig),this._input_lineStyle.selectpicker({container:"body"}),this._dialog.find("#scxFibonacciDrawingDialog_panel_levels .scxSpectrum").scx().colorPicker({containerClassName:o,localStorageKey:"scxThemeDialog_spectrum",showAlpha:!0});for(var e=Array.prototype.slice.call(this._panelFigureLine.find(".js-switch")),t=0;t<e.length;t++){var i=new Switchery(e[t],p._switcherySettings);void 0===this._levels[t].visible&&(this._levels[t].visible=!0),i.setPosition(this._levels[t].visible),this._setLineState(this._levels[t].visible,t)}},p.prototype._generateLinePanel=function(){$('<tr class="scxFibonacciDrawingDialog_panel_figure_linePanel"><td><span class="scxFibonacciDrawingDialog_panel_figure_lineEnabled"><input class="scxFibonacciDrawingDialog_chk_lineEnable js-switch" type="checkbox"/></span><input class="scxFibonacciDrawingDialog_input_lineLevel form-control" type="text"><input class="scxFibonacciDrawingDialog_input_lineColor scxSpectrum" type="text"><input class="scxFibonacciDrawingDialog_input_lineWidth form-control" type="text"><select class="scxFibonacciDrawingDialog_input_lineStyle scxLineStyleSelector scxDropdown"><option value="solid" data-manuali18="graphics.line.style.solid">&nbsp;</option><option value="dash" data-manuali18="graphics.line.style.dash">&nbsp;</option><option value="dot" data-manuali18="graphics.line.style.dot">&nbsp;</option><option value="dash-dot" data-manuali18="graphics.line.style.dashDot">&nbsp;</option></select><a href="#" aria-hidden="true" class="close scxFibonacciDrawingDialog_panel_deleteLinePanel">&#215;</a></td></tr>').appendTo(this._panelFigure.find("table"))},p.prototype._generateLevelParameters=function(){$('<tr class="scxFibonacciDrawingDialog_panel_figure_levelParameters"><td><span class="scxFibonacciDrawingDialog_panel_figure_lineEnabled"><input class="scxFibonacciDrawingDialog_chk_levelsValue js-switch" type="checkbox"/></span><label class="scxFibonacciDrawingDialog_label_levels" data-i18n="drawing.all.dialog.levels"></label><div class="scxFibonacciDrawingDialog_levelsPrice"><span class="scxFibonacciDrawingDialog_panel_figure_lineEnabled"><input class="scxFibonacciDrawingDialog_chk_levelsPrice js-switch" type="checkbox"/></span><label class="scxFibonacciDrawingDialog_label_prices" data-i18n="drawing.all.dialog.prices"></label> </div><div class="scxFibonacciDrawingDialog_levelsPercent"><span class="scxFibonacciDrawingDialog_panel_figure_lineEnabled"><input class="scxFibonacciDrawingDialog_chk_levelsPercent js-switch" type="checkbox"/></span><label class="scxFibonacciDrawingDialog_label_percents" data-i18n="drawing.all.dialog.percents"></label></div></td></tr>').appendTo(this._panelFigureLevelParametersPanel.find("table"))},p.prototype._defineDomObjects=function(){var e=_,t=c;this._panelFigureLevelParameters=this._dialog.find(n+"levelParameters"),this._input_trendLineColor=this._panelFigureTrendLinePanel.find(e+"lineColor"),this._input_trendLineWidth=this._panelFigureTrendLinePanel.find(e+"lineWidth"),this._input_trendLineStyle=this._panelFigureTrendLinePanel.find(e+"lineStyle"),this._input_labelsPosition=this._panelFigureLabelsParametersPanel.find(e+"labelsPosition"),this._input_labelsTextPosition=this._panelFigureLabelsParametersPanel.find(e+"labelsTextPosition"),this._chk_trendLineEnabledHTMLObj=this._dialog.find(t+"trendLine"),this._chk_levelsValueEnabledHTMLObj=this._dialog.find(t+"levelsValue"),this._chk_levelsPriceEnabledHTMLObj=this._dialog.find(t+"levelsPrice"),this._chk_levelsPercentEnabledHTMLObj=this._dialog.find(t+"levelsPercent"),this._chk_linesReverseEnabledHTMLObj=this._dialog.find(t+"linesReverse"),this._chk_extendLinesLeftEnabledHTMLObj=this._dialog.find(t+"extendLinesLeft"),this._chk_extendLinesRightEnabledHTMLObj=this._dialog.find(t+"extendLinesRight"),this._chk_extendLinesTopEnabledHTMLObj=this._dialog.find(t+"extendLinesTop"),this._chk_extendLinesBottomEnabledHTMLObj=this._dialog.find(t+"extendLinesBottom"),this._chk_backgroundEnabledHTMLObj=this._dialog.find(t+"background"),this._levelsPriceEnabled=this._dialog.find(".scxFibonacciDrawingDialog_levelsPrice"),this._levelsPercentEnabled=this._dialog.find(".scxFibonacciDrawingDialog_levelsPercent"),this._levelsExtendHorEnabled=this._dialog.find(".scxFibonacciDrawingDialog_extendHor"),this._levelsExtendVerEnabled=this._dialog.find(".scxFibonacciDrawingDialog_extendVer"),this._labelsHorEnabled=this._dialog.find(".scxFibonacciDrawingDialog_labelsPosition"),this._levelsReverseEnabled=this._dialog.find(".scxFibonacciDrawingDialog_reverse"),this._label_trendLine=this._dialog.find(".scxFibonacciDrawingDialog_label_trendLine"),this._label_extendLinesLeft=this._dialog.find(".scxFibonacciDrawingDialog_label_extendLinesLeft"),this._label_extendLinesRight=this._dialog.find(".scxFibonacciDrawingDialog_label_extendLinesRight"),this._label_extendLinesTop=this._dialog.find(".scxFibonacciDrawingDialog_label_extendLinesTop"),this._label_extendLinesBottom=this._dialog.find(".scxFibonacciDrawingDialog_label_extendLinesBottom"),this._label_reverse=this._dialog.find(".scxFibonacciDrawingDialog_label_linesReverse"),this._label_levels=this._dialog.find(".scxFibonacciDrawingDialog_label_levels"),this._label_levelPercents=this._dialog.find(".scxFibonacciDrawingDialog_label_percents"),this._label_levelPrices=this._dialog.find(".scxFibonacciDrawingDialog_label_prices"),this._label_background=this._dialog.find(".scxFibonacciDrawingDialog_label_background")},p.prototype._loadTooltipView=function(t){var i=this;h.ViewLoader.tooltipView(function(e){e.container=i._tabTooltip,e.setValues(t),i._tooltipView=e,i._tooltipView.chart=i._config.chart,i._config.chart.localize(i._dialog)})},p.prototype._defineDomLevelObjects=function(){var t=this;this._panelFigureLine=this._dialog.find(n+"linePanel"),this._input_lineLevel=this._dialog.find(_+"lineLevel"),this._input_lineWidth=this._dialog.find(_+"lineWidth"),this._input_lineStyle=this._dialog.find(_+"lineStyle"),this._chk_lineEnabledHTMLObj=this._dialog.find(c+"lineEnable"),this._dialog.find(u+"deleteLinePanel").on("click",function(e){t._deleteLinePanel(e)})},p._numericFieldConfig={showArrows:!1,maxValue:10,minValue:1,value:1},p._numericDoubleFieldConfig={showArrows:!1,priceDecimals:3,maxValue:500,minValue:0,value:1},p._numericTimeZoneFieldConfig={showArrows:!1,maxValue:1e4,minValue:0,value:1},p._switcherySettings={color:"rgba(72, 149, 245, 0.2)",secondaryColor:"rgba(16, 17, 20, 1)",jackColor:"rgba(72, 149, 245, 1)",jackSecondaryColor:"rgba(81, 83, 90, 1)",className:"scx_switchery",disabled:!1,disabledOpacity:.5,speed:"0.4s"},p);function p(e){var t=i.call(this,e)||this;return t._levels=[],t._initFields(),t._init(),t}h.FibonacciDrawingSettingsDialog=r}(f.UI||(f.UI={}))}(StockChartX=StockChartX||{}),function(r){!function(e){"use strict";var o=jQuery,t="scxComponentsContainer",i=(Object.defineProperty(n.prototype,"componentsContainer",{get:function(){return this._componentsContainer},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"elements",{get:function(){return this._elements},enumerable:!0,configurable:!0}),Object.defineProperty(n,"instance",{get:function(){return null==n._instance&&(n._instance=new n),n._instance},enumerable:!0,configurable:!0}),n.prototype.register=function(e,t,i){void 0===i&&(i=!0);var n=null;return t&&(n=i?o(t).appendTo(this.componentsContainer):o(t),this._elements.push({name:e,element:n})),n},n.prototype.resetSelf=function(e){e&&(e.windowMode===r.WindowMode.FULL_SCREEN?this.reset(e.container):this.reset())},n.prototype.reset=function(e){e=e||o("body"),o.contains(e.get(0),this._componentsContainer.get(0))&&this._componentsContainer.detach(),this._componentsContainer.appendTo(e)},n._instance=null,n);function n(){this._componentsContainer=o('<div class="'+t+'"></div>').appendTo(o("body")),this._elements=[]}e.HtmlContainer=i}(r.UI||(r.UI={}))}(StockChartX=StockChartX||{}),function(a){!function(e){"use strict";var n=jQuery,o=(t.prototype._isLoaded=function(){return!!this._html},t.prototype.setHtml=function(e){this._html=e;for(var t=this._subscribers.length-1;0<=t;t--)this._subscribers[t](e);this._subscribers=[]},t.prototype.subscribe=function(e){this._isLoaded()?e(this._html):this._subscribers.push(e)},t);function t(e){this._subscribers=[],e&&this._subscribers.push(e)}var i=(r.loadHtml=function(e,t){var i=this._fileName2Html.get(e);i?i.subscribe(t):(this._fileName2Html.add(e,new o(t)),this._loadContent(e))},r._expandPath=function(e){return a.Environment.Path.view+e},r._loadContent=function(t){var i=this;n.get(this._expandPath(t),function(e){i._onContentLoaded(t,e)}).fail(function(){e.Notification.error("Load "+t+" failed.")})},r._onContentLoaded=function(e,t){var i=this._fileName2Html.get(e);i&&i.setHtml(t)},r._fileName2Html=new a.Dictionary,r);function r(){}e.HtmlLoader=i}(a.UI||(a.UI={}))}(StockChartX=StockChartX||{});__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}();!function(s){!function(o){"use strict";var r,i="scxIndicatorInfoDialog",e=(r=o.Dialog,__extends(a,r),a.prototype.show=function(e){var i,t,n=this;this.initDialog(e)&&(this._clear(),this._showWaitingBar(),r.prototype.show.call(this,e),"object"==typeof e.indicator&&e.indicator instanceof s.Indicator?(i=e.indicator.className,this._setTitle(i),o.HtmlLoader.loadHtml("IndicatorsHelp.html",function(e){n._config.chart.localize(n._dialog);var t=$(e).find("#scxIndicatorTooltip_"+i).clone().show();t.find("> h1").remove(),t=t.length?t:a._generateHelpDoesntExistContent(),n._insertContent(t)})):(t=a._getIndicatorOwnAbout(e.indicator)||a._generateHelpDoesntExistContent(),this._setTitle("IndicatorHelp"),this._insertContent(t)))},a.prototype._setTitle=function(e){this._title.scxLocalize("indicator."+e+".name",e)},a.prototype._insertContent=function(e){this._hideWaitingBar(),this._helpContainer.append(e),this.resize(),this._config.chart.localize(this._helpContainer)},a.prototype._clear=function(){this._helpContainer.empty()},a._getIndicatorOwnAbout=function(e){var t=e.getInfoAbout();return t?$(t):null},a._generateHelpDoesntExistContent=function(){return $('<p class="'+i+'__noInfo" data-i18n="indicator.all.help.dialog.noInfo"></p>')},a.prototype._showWaitingBar=function(){this._waitingBar.show(this._waitingBarConfig)},a.prototype._hideWaitingBar=function(){this._waitingBar.hide()},a);function a(e){var t=r.call(this,e)||this;return t._waitingBarConfig={dotsCount:5},t._title=t._dialog.find("."+i+"__title"),t._helpContainer=t._dialog.find("."+i+"__help-content"),t._waitingBar=t._dialogContent.body.scx().waitingBar(),t}o.IndicatorInfoDialog=e}(s.UI||(s.UI={}))}(StockChartX=StockChartX||{});__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}();!function(e){!function(n){"use strict";var o="scxMenuItemChecked",r="disabled",e={ABOUT:"about",SETTINGS:"settings",SHOW_PARAMS:"showParams",SHOW_MARKERS:"showMarkers",SHOW_VALUES:"showTitleValues",VISIBLE:"visible",DELETE:"delete",MERGE_UP:"mergeUp",MERGE_DOWN:"mergeDown",UNMERGE_UP:"unmergeUp",UNMERGE_DOWN:"unmergeDown",LINE_LEVELS:"lineLevels"};Object.freeze(e);var a,t=(a=n.ContextMenu,__extends(s,a),s.prototype._initMenu=function(t){var i=this;t.menuContainer=s._container,t.onShow=function(){var e=t.indicator;i._toggleClass("settings",r,!e.allowSettingsDialog),i._toggleClass("showParams",o,e.showParamsInTitle),i._toggleClass("showMarkers",o,e.showValueMarkers),i._toggleClass("showTitleValues",o,e.showValuesInTitle),i._toggleClass("visible",o,e.visible),i._toggleClass("lineLevels",o,e.showLineLevels),i._toggleClass("lineLevels",r,0===e._lineLevels.length),i._toggleClass("mergeUp",r,!e.canMergeUp),i._toggleClass("mergeDown",r,!e.canMergeDown),i._toggleClass("unmergeUp",r,!e.canUnmergeUp),i._toggleClass("unmergeDown",r,!e.canUnmergeDown)}},s.prototype._toggleClass=function(e,t,i){var n=s._container.find("[data-id="+e+"]");i?n.addClass(t):n.removeClass(t)},s._container=null,s.MenuItem=e,s);function s(e,t){var i=a.call(this,t,e)||this;return n.HtmlLoader.loadHtml("IndicatorContextMenu.html",function(e){s._container||(s._container=n.HtmlContainer.instance.register("IndicatorContextMenu",e)),i._initMenu(t)}),i}n.IndicatorContextMenu=t}(e.UI||(e.UI={}))}(StockChartX=StockChartX||{});__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}();!function(h){!function(n){"use strict";var e={NEW_ORDER:"newOrder",BUY:"buy",SELL:"sell",BUY_MARKET:"buyMarket",SELL_MARKET:"sellMarket"};Object.freeze(e);var l={BUY_ABOVE_MARKET:"trading.contextMenu.buyAboveMarket",SELL_ABOVE_MARKET:"trading.contextMenu.sellAboveMarket",BUY_BELOW_MARKET:"trading.contextMenu.buyBelowMarket",SELL_BELOW_MARKET:"trading.contextMenu.sellBelowMarket",BUY_MARKET:"trading.contextMenu.buyMarket",SELL_MARKET:"trading.contextMenu.sellMarket"};Object.freeze(l);var o,t=(o=n.ContextMenu,__extends(c,o),c.prototype._initMenu=function(a){var s=this;a.menuContainer=c._container,a.onShow=function(){var e=a.crossHairView.chart,t=h.JsUtil.calculateDigitsOnTickSize(e.instrument.tickSize),i=parseFloat(a.crossHairView.markerValue.toFixed(t)),n=e.instrument.symbol,o=e.barDataSeries().close.lastValue>a.crossHairView.markerValue,r=c.MenuItem;if(i){if(i<=0)throw new Error("Price must be greater than 0");a.crossHairView.tradingPrice=i,(a.crossHairView.isAboveMarket=o)?(s._addText(a.chart,r.BUY,l.BUY_BELOW_MARKET,n,a.quantity,i),s._addText(a.chart,r.SELL,l.SELL_BELOW_MARKET,n,a.quantity,i)):(s._addText(a.chart,r.BUY,l.BUY_ABOVE_MARKET,n,a.quantity,i),s._addText(a.chart,r.SELL,l.SELL_ABOVE_MARKET,n,a.quantity,i)),s._addText(a.chart,r.BUY_MARKET,l.BUY_MARKET,n,a.quantity),s._addText(a.chart,r.SELL_MARKET,l.SELL_MARKET,n,a.quantity)}}},c.prototype._addText=function(e,t,i,n,o,r){var a=c._container.find("[data-id="+t+"]");h.Localization.localizeText(e,i,{replace:{symbol:n,count:o,price:r}}).then(function(e){a.children().text(e)})},c._container=null,c.MenuItem=e,c);function c(e,t){var i=o.call(this,t,e)||this;return n.HtmlLoader.loadHtml("TradingContextMenu.html",function(e){c._container||(c._container=n.HtmlContainer.instance.register("TradingContextMenu",e)),i._initMenu(t)}),i}n.TradingContextMenu=t}(h.UI||(h.UI={}))}(StockChartX=StockChartX||{});__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}();!function(e){!function(n){"use strict";var o="scxMenuItemChecked",r="disabled",e={ABOUT:"about",SETTINGS:"settings",SHOW_MARKERS:"showMarkers",VISIBLE:"visible",DELETE:"delete"};Object.freeze(e);var a,t=(a=n.ContextMenu,__extends(s,a),s.prototype._initMenu=function(t){var i=this;t.menuContainer=s._container,t.onShow=function(){var e=t.instrumentCompare;i._toggleClass(s.MenuItem.SETTINGS,r,!e.allowSettingsDialog),i._toggleClass(s.MenuItem.SHOW_MARKERS,o,e.showValueMarker),i._toggleClass(s.MenuItem.SHOW_MARKERS,r,!e.allowCheckValueMarker),i._toggleClass(s.MenuItem.VISIBLE,o,e.visible),i._toggleClass(s.MenuItem.ABOUT,r,!e.allowAboutDialog)}},s.prototype._toggleClass=function(e,t,i){var n=s._container.find("[data-id="+e+"]");i?n.addClass(t):n.removeClass(t)},s._container=null,s.MenuItem=e,s);function s(e,t){var i=a.call(this,t,e)||this;return n.HtmlLoader.loadHtml("ComparingContextMenu.html",function(e){s._container||(s._container=n.HtmlContainer.instance.register("ComparingContextMenu",e)),i._initMenu(t)}),i}n.CompareContextMenu=t}(e.UI||(e.UI={}))}(StockChartX=StockChartX||{});__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}(),__awaiter=this&&this.__awaiter||function(r,a,s,l){return new(s=s||Promise)(function(e,t){function i(e){try{o(l.next(e))}catch(e){t(e)}}function n(e){try{o(l.throw(e))}catch(e){t(e)}}function o(t){t.done?e(t.value):new s(function(e){e(t.value)}).then(i,n)}o((l=l.apply(r,a||[])).next())})},__generator=this&&this.__generator||function(i,n){var o,r,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,r&&(a=r[2&t[0]?"return":t[0]?"throw":"next"])&&!(a=a.call(r,t[1])).done)return a;switch(r=0,a&&(t=[0,a.value]),t[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,r=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=n.call(i,s)}catch(e){t=[6,e],r=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}};!function(x){!function(i){"use strict";var n,o="scxInvalidValue",t="#scxIndicatorDialog_title",y="#scxIndicatorDialog_container_",w="#scxIndicatorDialog_input_",a="#scxIndicatorDialog_label_",r=".scxIndicatorDialog_switchery_",s={value:1},l={priceDecimals:2,value:1},e=(n=i.Dialog,__extends(f,n),f.prototype.show=function(e){this.initDialog(e)&&(this._indicator=e.indicator,this._setDialogTitle(),this._setViewAndValues(),n.prototype.show.call(this,e))},f.prototype.hide=function(){this._dialog.find(".scxSpectrum").spectrum("hide"),n.prototype.hide.call(this)},f.prototype._init=function(){var t=this,e={containerClassName:"scxSpectrumIndicatorPropertiesDialog",localStorageKey:"scxIndicatorDialog_spectrum",showAlpha:!0};this._input_line1_color=this._dialog.find(w+"line1_color").scx().colorPicker(e),this._input_line2_color=this._dialog.find(w+"line2_color").scx().colorPicker(e),this._input_line3_color=this._dialog.find(w+"line3_color").scx().colorPicker(e),this._input_line4_color=this._dialog.find(w+"line4_color").scx().colorPicker(e),this._input_line5_color=this._dialog.find(w+"line5_color").scx().colorPicker(e),this._input_label1_color=this._dialog.find(w+"label1_color").scx().colorPicker(e),this._input_label2_color=this._dialog.find(w+"label2_color").scx().colorPicker(e),this._input_label3_color=this._dialog.find(w+"label3_color").scx().colorPicker(e),this._input_label4_color=this._dialog.find(w+"label4_color").scx().colorPicker(e),this._input_aboveFill=this._dialog.find(w+"fillAbove").scx().colorPicker(e),this._input_belowFill=this._dialog.find(w+"fillBelow").scx().colorPicker(e),this._dialog.find(".scxComboBox").selectpicker({container:"body"}),this._dialog.find("#scxIndicatorDialog_btn_save").off("click").click(function(){0===t._dialog.find("."+o).length&&t._save()}),this._dialog.find("#scxIndicatorDialog_btn_apply").off("click").click(function(){0===t._dialog.find("."+o).length&&t._apply()}),this._tabs=new i.Tabs({tabsContainer:this._tabItemsContainer,panelsContainer:this._tabPanelsContainer,onChange:function(e){t.resize()}}),this._initSwitchery(),this._groupLines(),this._groupLabels()},f._getMAType=function(e){var t=parseInt(e,10);switch(t){case x.MovingAverageType.exponentialMovingAverage:case x.MovingAverageType.hullMovingAverage:case x.MovingAverageType.simpleMovingAverage:case x.MovingAverageType.triangularMovingAverage:case x.MovingAverageType.TEMA:case x.MovingAverageType.weightedMovingAverage:case x.MovingAverageType.variable:case x.MovingAverageType.wws:case x.MovingAverageType.vidya:return t;default:return x.MovingAverageType.simpleMovingAverage}},f.prototype._getSource=function(e){return this._indicator.chart.findDataSeries(e)?e:e===x.InputSeriesKind.typical?x.DataSeriesSuffix.TYPICAL:e===x.InputSeriesKind.median?x.DataSeriesSuffix.MEDIAN:e===x.InputSeriesKind.weighted?x.DataSeriesSuffix.WEIGHTED:x.DataSeriesSuffix.CLOSE},f._getLineStyle=function(e){switch(e){case x.LineStyle.SOLID:case x.LineStyle.DASH:case x.LineStyle.DOT:case x.LineStyle.DASH_DOT:return e;default:return x.LineStyle.SOLID}},f.prototype.numericValue=function(e){return e.scxNumericField("getValue")},f.prototype.setNumericValue=function(e,t){null!=t&&e.scxNumericField("setValue",t)},f.prototype.updateNumericFromIndicator=function(e,t){this.setNumericValue(e,this._indicator.getParameterValue(t))},f.prototype.updateIndicatorFromNumeric=function(e,t){this._indicator.setParameterValue(e,this.numericValue(t))},f.prototype.updateIndicatorLineStyle=function(e,t){this._indicator.setParameterValue(e,f._getLineStyle(t.val()))},f.prototype._hideFields=function(){var t=this;this._dialogContent.body.find("[id^='scxIndicatorDialog_container_']").hide(),x.Localization.localizeText(this._config.chart,"indicator.all.plot.line").then(function(e){t._label_line1.text(e)})},f.prototype._restoreFields=function(){this._input_line1_width.show(),this._input_line1_style.selectpicker("show"),this._input_line3_width.show(),this._input_line3_style.selectpicker("show")},f.prototype._resetErrors=function(){this._dialog.find("."+o).each(function(e,t){$(t).removeClass(o)})},f.prototype._initSwitchery=function(){var o=this;this._line1_enabled=new Switchery(this._line1_switchery[0],f._switcherySettings),this._line2_enabled=new Switchery(this._line2_switchery[0],f._switcherySettings),this._line3_enabled=new Switchery(this._line3_switchery[0],f._switcherySettings),this._line4_enabled=new Switchery(this._line4_switchery[0],f._switcherySettings),this._line5_enabled=new Switchery(this._line5_switchery[0],f._switcherySettings),this._label1_enabled=new Switchery(this._label1_switchery[0],f._switcherySettings),this._label2_enabled=new Switchery(this._label2_switchery[0],f._switcherySettings),this._label3_enabled=new Switchery(this._label3_switchery[0],f._switcherySettings),this._label4_enabled=new Switchery(this._label4_switchery[0],f._switcherySettings),this._fill_enabled=new Switchery(this._fill_switchery[0],f._switcherySettings),$("body").on("scxSwitcherChanged",function(e,t){var i=$(t.target),n=t.checked;i.is(o._line1_switchery)?o._setLineState(n,o._label_line1,o._input_line1_width,o._input_line1_style,o._dialog.find(w+"line1_color"),o._line1_enabled):i.is(o._line2_switchery)?o._setLineState(n,o._label_line2,o._input_line2_width,o._input_line2_style,o._dialog.find(w+"line2_color"),o._line2_enabled):i.is(o._line3_switchery)?o._setLineState(n,o._label_line3,o._input_line3_width,o._input_line3_style,o._dialog.find(w+"line3_color"),o._line3_enabled):i.is(o._line4_switchery)?o._setLineState(n,o._label_line4,o._input_line4_width,o._input_line4_style,o._dialog.find(w+"line4_color"),o._line4_enabled):i.is(o._line5_switchery)?o._setLineState(n,o._label_line5,o._input_line5_width,o._input_line5_style,o._dialog.find(w+"line5_color"),o._line5_enabled):i.is(o._label1_switchery)?o._setLabelState(n,o._label_label1,o._dialog.find(w+"label1_color"),o._label1_enabled):i.is(o._label2_switchery)?o._setLabelState(n,o._label_label2,o._dialog.find(w+"label2_color"),o._label2_enabled):i.is(o._label3_switchery)?o._setLabelState(n,o._label_label3,o._dialog.find(w+"label3_color"),o._label3_enabled):i.is(o._label4_switchery)?o._setLabelState(n,o._label_label4,o._dialog.find(w+"label4_color"),o._label4_enabled):i.is(o._fill_switchery)&&o._setFillState(n,o._fill_enabled),n?i.addClass("scxCheckboxChecked"):i.removeClass("scxCheckboxChecked")})},f.prototype._setLineState=function(e,t,i,n,o,r){e?(t.removeClass("disabled"),o.spectrum("enable"),n.removeAttr("disabled"),n.selectpicker("refresh"),i.scxNumericField("enable"),r.isChecked()||r.setPosition(!0)):(t.addClass("disabled"),o.spectrum("disable"),n.attr("disabled","disabled"),n.selectpicker("refresh"),i.scxNumericField("disable"),r.isChecked()&&r.setPosition(!0)),this._config.chart&&this._config.chart.localize(this._dialog)},f.prototype._setLabelState=function(e,t,i,n){e?(t.removeClass("disabled"),i.spectrum("enable"),n.isChecked()||n.setPosition(!0)):(t.addClass("disabled"),i.spectrum("disable"),n.isChecked()&&n.setPosition(!0)),this._config.chart&&this._config.chart.localize(this._dialog)},f.prototype._setFillState=function(e,t){var i=this._dialog.find(a+"fillAbove"),n=this._dialog.find(a+"fillBelow"),o=this._dialog.find(w+"fillAbove"),r=this._dialog.find(w+"fillBelow");e?(i.removeClass("disabled"),n.removeClass("disabled"),o.spectrum("enable"),r.spectrum("enable"),t.isChecked()||t.setPosition(!0)):(i.addClass("disabled"),n.addClass("disabled"),r.spectrum("disable"),o.spectrum("disable"),t.isChecked()&&t.setPosition(!0)),this._config.chart&&this._config.chart.localize(this._dialog)},f.prototype._setFieldValueBounds=function(){var e=this._indicator?this._indicator.chart.recordCount:0,t=parseInt((e/2).toString(),10),i=1e4;this._input_periods.scxNumericField("setBounds",1,i),this._input_standardDeviations.scxNumericField("setBounds",0,5),this._input_kPeriods.scxNumericField("setBounds",2,t),this._input_dPeriods.scxNumericField("setBounds",2,t),this._input_roc.scxNumericField("setBounds",0,100),this._input_shortCycle.scxNumericField("setBounds",2,i),this._input_longCycle.scxNumericField("setBounds",2,i),this._input_line1_width.scxNumericField("setBounds",1,20),this._input_line2_width.scxNumericField("setBounds",1,20),this._input_line3_width.scxNumericField("setBounds",1,20),this._input_line4_width.scxNumericField("setBounds",1,20),this._input_line5_width.scxNumericField("setBounds",1,20),this._input_bandPct.scxNumericField("setBounds",0,100),this._input_smooth.scxNumericField("setBounds",1,i),this._input_slow.scxNumericField("setBounds",1,i),this._input_fast.scxNumericField("setBounds",1,i),this._input_maPeriods.scxNumericField("setBounds",1,i),this._input_rocPeriods.scxNumericField("setBounds",1,i),this._input_volumeDivisor.scxNumericField("setBounds",1,1e7),this._input_barCount.scxNumericField("setBounds",1,1e7),this._input_forecast.scxNumericField("setBounds",1,i),this._input_ema1Periods.scxNumericField("setBounds",1,i),this._input_ema2Periods.scxNumericField("setBounds",1,i),this._input_envelopePercentage.scxNumericField("setBounds",0,100),this._input_offsetMultiplier.scxNumericField("setBounds",0,i),this._input_qPeriods.scxNumericField("setBounds",1,i),this._input_volatilityPeriod.scxNumericField("setBounds",1,i),this._input_basePeriods.scxNumericField("setBounds",1,i),this._input_conversionPeriods.scxNumericField("setBounds",1,i),this._input_logginPeriods.scxNumericField("setBounds",1,i),this._input_limitValue.scxNumericField("setBounds",0,i),this._input_r2Scale.scxNumericField("setBounds",0,1),this._input_signalPeriods.scxNumericField("setBounds",1,i),this._input_intermediate.scxNumericField("setBounds",1,i),this._input_lookback.scxNumericField("setBounds",1,i)},f.prototype._setFieldsRestrictions=function(){this._input_shortCycle.scxNumericField("onChange",null),this._input_longCycle.scxNumericField("onChange",null)},f.prototype._setViewAndValues=function(){var t=this,e=x.IndicatorParam,m=this._indicator,g=m.linePlots,_=m.labelPlots;m.indicatorHasParameters?this._tabs.activate(0):this._tabs.activate(1),this._restoreFields(),this._hideFields(),this._resetErrors(),this._setFieldValueBounds(),this._setFieldsRestrictions();for(var b=this,i=0;i<g.length;i++)!function(e){var t=b._lines[e],i=t.label,n=t.width,o=t.style,r=t.color,a=t.enabled,s=t.widthParamName,l=t.styleParamName,c=t.enabledParamName,h=e+1,d=g[e],_=b._dialog.find(y+"line"+h),u=b._dialog.find(w+"line"+h+"_color"),p=m.getParameterValue(c),f=d.dataSeries[0].name;r.setColor(d.actualTheme.strokeColor||d.actualTheme.fill.fillColor),b.updateNumericFromIndicator(n,s),o.val(m.getParameterValue(l)),_.show(),b._setLineState(p,i,n,o,u,a),x.Localization.localizeText(b._config.chart,"indicator.all.panelTitle."+f).then(function(e){i.text(e)})}(i);for(var u=this,i=0;i<_.length;i++)!function(e){var t=u._labels[e],i=t.label,n=t.color,o=t.enabled,r=t.enabledParamName,a=e+1,s=_[e],l=u._dialog.find(y+"label"+a),c=u._dialog.find(w+"line"+a+"_color"),h=m.getParameterValue(r),d=s.dataSeries[0].name;n.setColor(s.actualTheme.strokeColor||s.actualTheme.fill.fillColor),l.show(),u._setLabelState(h,i,c,o),x.Localization.localizeText(u._config.chart,"indicator.all.panelTitle."+d).then(function(e){i.text(e)})}(i);switch(m.hasParameter(e.SOURCE)&&(this._input_source.val(m.getParameterValue(e.SOURCE)),this._dialog.find(y+"source").show()),m.hasParameter(e.SOURCE2)&&(this._input_source2.val(m.getParameterValue(e.SOURCE2)),this._dialog.find(y+"source2").show()),m.hasParameter(e.PERIODS)&&(this.updateNumericFromIndicator(this._input_periods,e.PERIODS),this._dialog.find(y+"periods").show()),m.hasParameter(e.VOLATILITY_PERIOD)&&(this.updateNumericFromIndicator(this._input_volatilityPeriod,e.VOLATILITY_PERIOD),this._dialog.find(y+"volatilityPeriod").show()),m.hasParameter(e.MA_TYPE)&&(this._input_maType.val(m.getParameterValue(e.MA_TYPE)),this._dialog.find(y+"maType").show()),m.hasParameter(e.STANDARD_DEVIATIONS)&&(this.updateNumericFromIndicator(this._input_standardDeviations,e.STANDARD_DEVIATIONS),this._dialog.find(y+"standardDeviations").show()),m.hasParameter(e.BAND_PCT)&&(this.updateNumericFromIndicator(this._input_bandPct,e.BAND_PCT),this._dialog.find(y+"bandPct").show()),m.hasParameter(e.SMOOTH)&&(this.updateNumericFromIndicator(this._input_smooth,e.SMOOTH),this._dialog.find(y+"smooth").show()),m.hasParameter(e.FAST)&&(this.updateNumericFromIndicator(this._input_fast,e.FAST),this._dialog.find(y+"fast").show()),m.hasParameter(e.SLOW)&&(this.updateNumericFromIndicator(this._input_slow,e.SLOW),this._dialog.find(y+"slow").show()),m.hasParameter(e.MA_PERIOD)&&(this._input_maPeriods.val(m.getParameterValue(e.MA_PERIOD)),this._dialog.find(y+"maPeriods").show()),m.hasParameter(e.RATE_OF_CHANGE)&&(this.updateNumericFromIndicator(this._input_rocPeriods,e.RATE_OF_CHANGE),this._dialog.find(y+"rocPeriods").show()),m.hasParameter(e.VOLUME_DIVISOR)&&(this.updateNumericFromIndicator(this._input_volumeDivisor,e.VOLUME_DIVISOR),this._dialog.find(y+"volumeDivisor").show()),m.hasParameter(e.BAR_COUNT)&&(this.updateNumericFromIndicator(this._input_barCount,e.BAR_COUNT),this._dialog.find(y+"barCount").show()),m.hasParameter(e.FORECAST)&&(this.updateNumericFromIndicator(this._input_forecast,e.FORECAST),this._dialog.find(y+"forecast").show()),m.hasParameter(e.EMA1)&&(this.updateNumericFromIndicator(this._input_ema1Periods,e.EMA1),this._dialog.find(y+"ema1Periods").show()),m.hasParameter(e.EMA2)&&(this.updateNumericFromIndicator(this._input_ema2Periods,e.EMA2),this._dialog.find(y+"ema2Periods").show()),m.hasParameter(e.PCT_K_PERIODS)&&(this.updateNumericFromIndicator(this._input_kPeriods,e.PCT_K_PERIODS),this._dialog.find(y+"kPeriods").show()),m.hasParameter(e.PCT_D_PERIODS)&&(this.updateNumericFromIndicator(this._input_dPeriods,e.PCT_D_PERIODS),this._dialog.find(y+"dPeriods").show()),m.hasParameter(e.ENVELOPE_PERCENTAGE)&&(this.updateNumericFromIndicator(this._input_envelopePercentage,e.ENVELOPE_PERCENTAGE),this._dialog.find(y+"envelopePercentage").show()),m.hasParameter(e.OFFSET_MULTIPLIER)&&(this.updateNumericFromIndicator(this._input_offsetMultiplier,e.OFFSET_MULTIPLIER),this._dialog.find(y+"offsetMultiplier").show()),m.hasParameter(e.Q_PERIODS)&&(this.updateNumericFromIndicator(this._input_qPeriods,e.Q_PERIODS),this._dialog.find(y+"qPeriods").show()),m.hasParameter(e.LOGIN_SPAN2_PERIODS)&&(this.updateNumericFromIndicator(this._input_logginPeriods,e.LOGIN_SPAN2_PERIODS),this._dialog.find(y+"logginPeriods").show()),m.hasParameter(e.BASE_PERIODS)&&(this.updateNumericFromIndicator(this._input_basePeriods,e.BASE_PERIODS),this._dialog.find(y+"basePeriods").show()),m.hasParameter(e.CONVERSION_PERIODS)&&(this.updateNumericFromIndicator(this._input_conversionPeriods,e.CONVERSION_PERIODS),this._dialog.find(y+"conversionPeriods").show()),m.hasParameter(e.LIMIT_VALUE)&&(this.updateNumericFromIndicator(this._input_limitValue,e.LIMIT_VALUE),this._dialog.find(y+"limitValue").show()),m.hasParameter(e.R2_SCALE)&&(this.updateNumericFromIndicator(this._input_r2Scale,e.R2_SCALE),this._dialog.find(y+"r2Scale").show()),m.hasParameter(e.SHORT_CYCLE)&&(this.updateNumericFromIndicator(this._input_shortCycle,e.SHORT_CYCLE),this._dialog.find(y+"shortCycle").show()),m.hasParameter(e.LONG_CYCLE)&&(this.updateNumericFromIndicator(this._input_longCycle,e.LONG_CYCLE),this._dialog.find(y+"longCycle").show()),m.hasParameter(e.SIGNAL_PERIODS)&&(this.updateNumericFromIndicator(this._input_signalPeriods,e.SIGNAL_PERIODS),this._dialog.find(y+"signalPeriods").show()),m.hasParameter(e.INTERMEDIATE)&&(this.updateNumericFromIndicator(this._input_intermediate,e.INTERMEDIATE),this._dialog.find(y+"intermediate").show()),m.hasParameter(e.LOOKBACK)&&(this.updateNumericFromIndicator(this._input_lookback,e.LOOKBACK),this._dialog.find(y+"lookback").show()),m.className){case x.MACD.className:this._input_line3_style.selectpicker("hide"),this._input_line3_width.hide(),this._input_line2_style.selectpicker("show"),this._input_line2_width.show();break;case x.NBarsUp.className:case x.NBarsDown.className:case x.VolumeOscillator.className:case x.BOP.className:this._input_line1_style.selectpicker("hide"),this._input_line1_width.hide();break;case x.VolumeUpDown.className:this._input_line2_style.selectpicker("hide"),this._input_line2_width.hide(),this._input_line1_style.selectpicker("hide"),this._input_line1_width.hide();break;case x.Ichimoku.className:this._fillContainer.show(),this._input_belowFill.setColor(m._fillPlot.actualTheme.belowCross.fillColor),this._input_aboveFill.setColor(m._fillPlot.actualTheme.aboveCross.fillColor);var n=m.getParameterValue(e.FILL_ENABLED);this._setFillState(n,this._fill_enabled),x.Localization.localizeText(this._config.chart,"indicator.Ichimoku.plot.tenkanSen").then(function(e){t._label_line1.text(e)}),x.Localization.localizeText(this._config.chart,"indicator.Ichimoku.plot.kijunSen").then(function(e){t._label_line2.text(e)}),x.Localization.localizeText(this._config.chart,"indicator.Ichimoku.plot.chikouSpan").then(function(e){t._label_line3.text(e)}),x.Localization.localizeText(this._config.chart,"indicator.Ichimoku.plot.senkouSpanA").then(function(e){t._label_line4.text(e)}),x.Localization.localizeText(this._config.chart,"indicator.Ichimoku.plot.senkouSpanB").then(function(e){t._label_line5.text(e)})}[this._input_source,this._input_source2,this._input_maType,this._input_line1_style,this._input_line2_style,this._input_line3_style,this._input_line4_style,this._input_line5_style].forEach(function(e){e.selectpicker("refresh")})},f.prototype._updateIndicatorFromUI=function(){for(var e=x.IndicatorParam,t=this._indicator,i=t.linePlots,n=t.labelPlots,o=0;o<i.length;o++){var r=this._lines[o],a=r.width,s=r.style,l=r.color,c=r.enabled,h=r.widthParamName,d=r.styleParamName,_=r.colorParamName,u=r.enabledParamName;t.setParameterValue(_,l.getColor()),t.setParameterValue(u,c.isChecked()),this.updateIndicatorFromNumeric(h,a),this.updateIndicatorLineStyle(d,s)}for(o=0;o<n.length;o++){var p=this._labels[o],l=p.color,c=p.enabled,_=p.colorParamName,u=p.enabledParamName;t.setParameterValue(_,l.getColor()),t.setParameterValue(u,c.isChecked())}t.className===x.Ichimoku.className&&(t.setParameterValue(e.FILL_ABOVE,this._input_aboveFill.getColor()),t.setParameterValue(e.FILL_BELOW,this._input_belowFill.getColor()),t.setParameterValue(e.FILL_ENABLED,this._fill_enabled.isChecked())),t.hasParameter(e.PERIODS)&&this.updateIndicatorFromNumeric(e.PERIODS,this._input_periods),t.hasParameter(e.VOLATILITY_PERIOD)&&this.updateIndicatorFromNumeric(e.VOLATILITY_PERIOD,this._input_volatilityPeriod),t.hasParameter(e.SOURCE)&&t.setParameterValue(e.SOURCE,this._getSource(this._input_source.val())),t.hasParameter(e.SOURCE2)&&t.setParameterValue(e.SOURCE2,this._getSource(this._input_source2.val())),t.hasParameter(e.MA_TYPE)&&t.setParameterValue(e.MA_TYPE,f._getMAType(this._input_maType.val())),t.hasParameter(e.STANDARD_DEVIATIONS)&&this.updateIndicatorFromNumeric(e.STANDARD_DEVIATIONS,this._input_standardDeviations),t.hasParameter(e.BAND_PCT)&&this.updateIndicatorFromNumeric(e.BAND_PCT,this._input_bandPct),t.hasParameter(e.SMOOTH)&&this.updateIndicatorFromNumeric(e.SMOOTH,this._input_smooth),t.hasParameter(e.FAST)&&this.updateIndicatorFromNumeric(e.FAST,this._input_fast),t.hasParameter(e.SLOW)&&this.updateIndicatorFromNumeric(e.SLOW,this._input_slow),t.hasParameter(e.MA_PERIOD)&&this.updateIndicatorFromNumeric(e.MA_PERIOD,this._input_maPeriods),t.hasParameter(e.RATE_OF_CHANGE)&&this.updateIndicatorFromNumeric(e.RATE_OF_CHANGE,this._input_rocPeriods),t.hasParameter(e.VOLUME_DIVISOR)&&this.updateIndicatorFromNumeric(e.VOLUME_DIVISOR,this._input_volumeDivisor),t.hasParameter(e.BAR_COUNT)&&this.updateIndicatorFromNumeric(e.BAR_COUNT,this._input_barCount),t.hasParameter(e.FORECAST)&&this.updateIndicatorFromNumeric(e.FORECAST,this._input_forecast),t.hasParameter(e.EMA1)&&this.updateIndicatorFromNumeric(e.EMA1,this._input_ema1Periods),t.hasParameter(e.EMA2)&&this.updateIndicatorFromNumeric(e.EMA2,this._input_ema2Periods),t.hasParameter(e.PCT_K_PERIODS)&&this.updateIndicatorFromNumeric(e.PCT_K_PERIODS,this._input_kPeriods),t.hasParameter(e.PCT_D_PERIODS)&&this.updateIndicatorFromNumeric(e.PCT_D_PERIODS,this._input_dPeriods),t.hasParameter(e.ENVELOPE_PERCENTAGE)&&this.updateIndicatorFromNumeric(e.ENVELOPE_PERCENTAGE,this._input_envelopePercentage),t.hasParameter(e.OFFSET_MULTIPLIER)&&this.updateIndicatorFromNumeric(e.OFFSET_MULTIPLIER,this._input_offsetMultiplier),t.hasParameter(e.Q_PERIODS)&&this.updateIndicatorFromNumeric(e.Q_PERIODS,this._input_qPeriods),t.hasParameter(e.LOGIN_SPAN2_PERIODS)&&this.updateIndicatorFromNumeric(e.LOGIN_SPAN2_PERIODS,this._input_logginPeriods),t.hasParameter(e.BASE_PERIODS)&&this.updateIndicatorFromNumeric(e.BASE_PERIODS,this._input_basePeriods),t.hasParameter(e.CONVERSION_PERIODS)&&this.updateIndicatorFromNumeric(e.CONVERSION_PERIODS,this._input_conversionPeriods),t.hasParameter(e.LIMIT_VALUE)&&this.updateIndicatorFromNumeric(e.LIMIT_VALUE,this._input_limitValue),t.hasParameter(e.R2_SCALE)&&this.updateIndicatorFromNumeric(e.R2_SCALE,this._input_r2Scale),t.hasParameter(e.SHORT_CYCLE)&&this.updateIndicatorFromNumeric(e.SHORT_CYCLE,this._input_shortCycle),t.hasParameter(e.LONG_CYCLE)&&this.updateIndicatorFromNumeric(e.LONG_CYCLE,this._input_longCycle),t.hasParameter(e.SIGNAL_PERIODS)&&this.updateIndicatorFromNumeric(e.SIGNAL_PERIODS,this._input_signalPeriods),t.hasParameter(e.INTERMEDIATE)&&this.updateIndicatorFromNumeric(e.INTERMEDIATE,this._input_intermediate),t.hasParameter(e.LOOKBACK)&&this.updateIndicatorFromNumeric(e.LOOKBACK,this._input_lookback)},f.prototype._save=function(){this._restoreFields(),this._apply(),this.hide()},f.prototype._apply=function(){this._updateIndicatorFromUI(),this._config.done()&&this._config.done()},f.prototype._setDialogTitle=function(){this._setTitle(this._indicator.name)},f.prototype._setTitle=function(n){return __awaiter(this,void 0,void 0,function(){var t,i;return __generator(this,function(e){switch(e.label){case 0:return[4,x.Localization.localizeText(this._config.chart,"indicator."+n+".name",{defaultValue:n})];case 1:return t=e.sent(),[4,x.Localization.localizeText(this._config.chart,"indicator.all.dialog.title",{replace:{indicatorName:t}})];case 2:return i=e.sent(),this._title.text(i),[2]}})})},f.prototype._initFields=function(){var e=this._dialog;this._title=e.find(t),this._tabItemsContainer=this._dialog.find(".scxTabs"),this._tabPanelsContainer=this._dialog.find(".scxTabsContent"),this._input_source=e.find(w+"source"),this._input_source2=e.find(w+"source2"),this._input_maType=e.find(w+"maType"),this._input_periods=e.find(w+"periods").scxNumericField(s),this._input_standardDeviations=e.find(w+"standardDeviations").scxNumericField(l),this._input_kPeriods=e.find(w+"kPeriods").scxNumericField(s),this._input_dPeriods=e.find(w+"dPeriods").scxNumericField(s),this._input_roc=e.find(w+"rateOfChange").scxNumericField(l),this._input_shortCycle=e.find(w+"shortCycle").scxNumericField(s),this._input_longCycle=e.find(w+"longCycle").scxNumericField(s),this._label_line1=e.find(a+"line1"),this._input_line1_width=e.find(w+"line1_width").scxNumericField(s),this._input_line1_style=e.find(w+"line1_style"),this._label_line2=e.find(a+"line2"),this._input_line2_width=e.find(w+"line2_width").scxNumericField(s),this._input_line2_style=e.find(w+"line2_style"),this._label_line3=e.find(a+"line3"),this._input_line3_width=e.find(w+"line3_width").scxNumericField(s),this._input_line3_style=e.find(w+"line3_style"),this._label_line4=e.find(a+"line4"),this._input_line4_width=e.find(w+"line4_width").scxNumericField(s),this._input_line4_style=e.find(w+"line4_style"),this._label_line5=e.find(a+"line5"),this._input_line5_width=e.find(w+"line5_width").scxNumericField(s),this._input_line5_style=e.find(w+"line5_style"),this._label_label1=e.find(a+"label1"),this._label_label2=e.find(a+"label2"),this._label_label3=e.find(a+"label3"),this._label_label4=e.find(a+"label4"),this._input_bandPct=e.find(w+"bandPct").scxNumericField(l),this._input_smooth=e.find(w+"smooth").scxNumericField(s),this._input_fast=e.find(w+"fast").scxNumericField(s),this._input_slow=e.find(w+"slow").scxNumericField(s),this._input_maPeriods=e.find(w+"maPeriods").scxNumericField(s),this._input_rocPeriods=e.find(w+"rocPeriods").scxNumericField(s),this._input_volatilityPeriod=e.find(w+"volatilityPeriod").scxNumericField(s),this._input_volumeDivisor=e.find(w+"volumeDivisor").scxNumericField(s),this._input_barCount=e.find(w+"barCount").scxNumericField(s),this._input_forecast=e.find(w+"forecast").scxNumericField(s),this._input_ema1Periods=e.find(w+"ema1Periods").scxNumericField(s),this._input_ema2Periods=e.find(w+"ema2Periods").scxNumericField(s),this._input_envelopePercentage=e.find(w+"envelopePercentage").scxNumericField(l),this._input_offsetMultiplier=e.find(w+"offsetMultiplier").scxNumericField(l),this._input_qPeriods=e.find(w+"qPeriods").scxNumericField(s),this._input_basePeriods=e.find(w+"basePeriods").scxNumericField(s),this._input_conversionPeriods=e.find(w+"conversionPeriods").scxNumericField(s),this._input_logginPeriods=e.find(w+"logginPeriods").scxNumericField(s),this._input_limitValue=e.find(w+"limitValue").scxNumericField(l),this._input_r2Scale=e.find(w+"r2Scale").scxNumericField(l),this._input_signalPeriods=e.find(w+"signalPeriods").scxNumericField(s),this._input_intermediate=e.find(w+"intermediate").scxNumericField(s),this._input_lookback=e.find(w+"lookback").scxNumericField(s),this._fillContainer=e.find(y+"fill"),this._line1_switchery=this._dialog.find(r+"line1"),this._line2_switchery=this._dialog.find(r+"line2"),this._line3_switchery=this._dialog.find(r+"line3"),this._line4_switchery=this._dialog.find(r+"line4"),this._line5_switchery=this._dialog.find(r+"line5"),this._label1_switchery=this._dialog.find(r+"label1"),this._label2_switchery=this._dialog.find(r+"label2"),this._label3_switchery=this._dialog.find(r+"label3"),this._label4_switchery=this._dialog.find(r+"label4"),this._fill_switchery=this._dialog.find(r+"fill"),this._input_line3_color=null,this._input_line2_color=null,this._input_line1_color=null},f.prototype._groupLines=function(){this._lines=[{label:this._label_line1,width:this._input_line1_width,style:this._input_line1_style,color:this._input_line1_color,enabled:this._line1_enabled,widthParamName:x.IndicatorParam.LINE_WIDTH,styleParamName:x.IndicatorParam.LINE_STYLE,colorParamName:x.IndicatorParam.LINE_COLOR,enabledParamName:x.IndicatorParam.LINE_ENABLED},{label:this._label_line2,width:this._input_line2_width,style:this._input_line2_style,color:this._input_line2_color,enabled:this._line2_enabled,widthParamName:x.IndicatorParam.LINE2_WIDTH,styleParamName:x.IndicatorParam.LINE2_STYLE,colorParamName:x.IndicatorParam.LINE2_COLOR,enabledParamName:x.IndicatorParam.LINE2_ENABLED},{label:this._label_line3,width:this._input_line3_width,style:this._input_line3_style,color:this._input_line3_color,enabled:this._line3_enabled,widthParamName:x.IndicatorParam.LINE3_WIDTH,styleParamName:x.IndicatorParam.LINE3_STYLE,colorParamName:x.IndicatorParam.LINE3_COLOR,enabledParamName:x.IndicatorParam.LINE3_ENABLED},{label:this._label_line4,width:this._input_line4_width,style:this._input_line4_style,color:this._input_line4_color,enabled:this._line4_enabled,widthParamName:x.IndicatorParam.LINE4_WIDTH,styleParamName:x.IndicatorParam.LINE4_STYLE,colorParamName:x.IndicatorParam.LINE4_COLOR,enabledParamName:x.IndicatorParam.LINE4_ENABLED},{label:this._label_line5,width:this._input_line5_width,style:this._input_line5_style,color:this._input_line5_color,enabled:this._line5_enabled,widthParamName:x.IndicatorParam.LINE5_WIDTH,styleParamName:x.IndicatorParam.LINE5_STYLE,colorParamName:x.IndicatorParam.LINE5_COLOR,enabledParamName:x.IndicatorParam.LINE5_ENABLED}]},f.prototype._groupLabels=function(){this._labels=[{label:this._label_label1,color:this._input_label1_color,enabled:this._label1_enabled,colorParamName:x.IndicatorParam.LABEL_COLOR,enabledParamName:x.IndicatorParam.LABEL_ENABLED},{label:this._label_label2,color:this._input_label2_color,enabled:this._label2_enabled,colorParamName:x.IndicatorParam.LABEL2_COLOR,enabledParamName:x.IndicatorParam.LABEL2_ENABLED},{label:this._label_label3,color:this._input_label3_color,enabled:this._label3_enabled,colorParamName:x.IndicatorParam.LABEL3_COLOR,enabledParamName:x.IndicatorParam.LABEL3_ENABLED},{label:this._label_label4,color:this._input_label4_color,enabled:this._label4_enabled,colorParamName:x.IndicatorParam.LABEL4_COLOR,enabledParamName:x.IndicatorParam.LABEL4_ENABLED}]},f._switcherySettings={color:"rgba(72, 149, 245, 0.2)",secondaryColor:"rgba(16, 17, 20, 1)",jackColor:"rgba(72, 149, 245, 1)",jackSecondaryColor:"rgba(81, 83, 90, 1)",className:"scx_switchery",disabled:!1,disabledOpacity:.5,speed:"0.4s"},f);function f(e){var t=n.call(this,e)||this;return t._initFields(),t._init(),t}i.IndicatorSettingsDialog=e}(x.UI||(x.UI={}))}(StockChartX=StockChartX||{});__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}();!function(a){!function(o){"use strict";var i,t="scxIndicatorItem",n="scxHasTooltip",e=(i=o.Dialog,__extends(r,i),r.prototype.show=function(e){this.initDialog(e)&&(this._inp_search.val(""),this._setDialogTitle(),this._filterIndicators(""),i.prototype.show.call(this,e),a.Environment.isPhone||this._inp_search.focus())},r.prototype.hide=function(){this._dialogContent.body.find("."+n).popover("hide"),i.prototype.hide.call(this)},r.prototype._init=function(){var i,n=this,e=$("body");this._noResultObj.hide(),this._generateObjects(),this._resultContainer.append(this._allIndicators.container.root),this._inp_search.on("keyup",function(e){n._filterIndicators($(e.currentTarget).val())}),this._btnClearInput.on("click",function(){n._inp_search.val().length&&n._clearInput()}),this._resultContainer.on("click","."+t,function(e){var t,i=$(e.currentTarget);i.addClass("active"),setTimeout(function(){i.removeClass("active")},200);try{n._config.done&&(t=i.attr("data-scx_id"),n._config.done(t))}catch(e){a.Localization.localizeText(n._config.chart,"indicator.all.notification.noMoreSpace").then(function(e){o.Notification.warning(e)})}}),this._resultContainer.on("mouseover","."+t,function(e){var t;n._helpEnabled&&(t=$(e.currentTarget),n._tooltipBodyHovered=!1,n._tooltipHoverTimer=setTimeout(function(){n._lastHoveredLi=t,n._lastHoveredLi.popover("show"),n._tooltipHoverTimer=null},500))}),this._resultContainer.on("mouseout","."+t,function(){n._helpEnabled&&(n._tooltipHoverTimer&&(clearTimeout(n._tooltipHoverTimer),n._tooltipHoverTimer=null),setTimeout(function(){n._tooltipBodyHovered||n._lastHoveredLi&&n._lastHoveredLi.popover("hide")},100))}),e.on("mouseover","div.popover",function(){n._helpEnabled&&(n._tooltipBodyHovered=!0)}),e.on("mouseleave","div.popover",function(){n._helpEnabled&&(n._lastHoveredLi&&n._lastHoveredLi.popover("hide"),n._tooltipBodyHovered=!1)}),a.Environment.isMobile?this._helpPanel.remove():(i=new Switchery(document.querySelector("#scxIndicators_chkHelpSwitcher"),{color:"rgba(72, 149, 245, 0.2)",secondaryColor:"rgba(16, 17, 20, 1)",jackColor:"rgba(72, 149, 245, 1)",jackSecondaryColor:"rgba(81, 83, 90, 1)",className:"scx_switchery",disabled:!1,disabledOpacity:.5,speed:"0.4s"}),e.on("scxSwitcherChanged",function(e,t){$(t.target).is(n._tooltipSwitcher)&&(!1===n._helpDownloaded?(n._tooltipLabel.hide(),n._tooltipDownloading.show(),i.disable(),o.HtmlLoader.loadHtml("IndicatorsHelp.html",function(e){n._helpDownloaded=!0,n._tooltipDownloading.hide(),n._tooltipLabel.show(),i.enable(),n._tooltipHTMLObj=$(e),n._helpEnabled=!0,n._switchHelpTooltips()})):(n._helpEnabled=t.checked,n._switchHelpTooltips()))}))},r.prototype._generateObjects=function(){var o=this,r=a.Indicator.allIndicators(),e=this._resultContainer,t=function(){for(var e=[],t=0,i=r;t<i.length;t++){var n=i[t];e.push(o._generateIndicatorItem(n))}return e}();e.append(t),this._sortItems(e),this._applyColumns(e),this._allIndicators={indicators:t,container:e}},r.prototype._filterIndicators=function(e){e=e.toString().trim().toLowerCase();for(var t,i=0,n=0,o=this._allIndicators.indicators;n<o.length;n++){o[n].detach()}(t=this._allIndicators.container).empty();for(var r=0,a=0,s=this._allIndicators.indicators;a<s.length;a++){var l=s[a];0<=l.text().toLowerCase().indexOf(e)&&(r++,i++,t.append(l))}r?(this._sortItems(t),this._applyColumns(t),t.show()):t.hide(),i?this._noResultObj.hide():this._noResultObj.show()},r.prototype._sortItems=function(e){var t=e.children().detach();t.sort(function(e,t){return $(e).text()<$(t).text()?-1:1}),e.append(t)},r.prototype._applyColumns=function(e){e.autocolumnlist({columns:3,classname:"scxIndicatorColumn"})},r.prototype._switchHelpTooltips=function(){for(var e=0,t=this._allIndicators.indicators;e<t.length;e++){var i=t[e];this._helpEnabled?this._enableItemHelpTooltip(i):this._disableItemHelpTooltip(i)}},r.prototype._enableItemHelpTooltip=function(e){var t;this._helpEnabled&&((t=this._tooltipHTMLObj.find("#scxIndicatorTooltip_"+e.attr("data-scx_id")).clone()).length||(t=$('<p style="margin-bottom: 0;" data-i18n="indicator.all.help.dialog.noInfo"></p>')),t.css({display:"block"}).addClass("scxIndicators_tooltipWrapper"),this._config.chart.localize(t),e.addClass(n).popover({trigger:"manual",placement:"auto left",delay:{show:500,hide:100},container:o.HtmlContainer.instance.componentsContainer,viewport:{selector:"body",padding:0},html:!0,content:function(){return $("<div></div>").append(t).html()}}))},r.prototype._disableItemHelpTooltip=function(e){e.removeClass(n).popover("destroy")},r.prototype._generateIndicatorItem=function(e){return $('<li class="scxIndicatorItem" data-scx_id=""></li>').attr("data-scx_id",e).scxLocalize("indicator."+e+".name")},r.prototype._clearInput=function(){this._inp_search.val(""),this._filterIndicators(""),this._inp_search.focus()},r.prototype._setDialogTitle=function(){this._title.scxLocalize("indicator.all.title")},r.prototype._initFields=function(){this._inp_search=this._dialog.find("#scxIndicators_inp_search"),this._title=this._dialog.find("#scxIndicatorsDialog_title"),this._resultContainer=this._dialog.find("#scxIndicatorsResult"),this._noResultObj=this._dialog.find(".scxNoResult"),this._tooltipSwitcher=this._dialog.find("#scxIndicators_chkHelpSwitcher"),this._tooltipDownloading=this._dialog.find(".scxLabel_downloading"),this._tooltipLabel=this._dialog.find('label[for="scxIndicators_chkHelpSwitcher"]'),this._btnClearInput=this._dialog.find("#scxIndicators_btn_clearInput"),this._helpPanel=this._dialog.find(".scxIndicators_helpControlPanel")},r.showSettingsBeforeAdding=!1,r);function r(e){var t=i.call(this,e)||this;return t._helpDownloaded=!1,t._helpEnabled=!1,t._tooltipHoverTimer=null,t._tooltipBodyHovered=!1,t._lastHoveredLi=null,t._tooltipHTMLObj=null,t._initFields(),t._init(),t}o.IndicatorsDialog=e}(a.UI||(a.UI={}))}(StockChartX=StockChartX||{});var __assign=this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},__awaiter=this&&this.__awaiter||function(r,a,s,l){return new(s=s||Promise)(function(e,t){function i(e){try{o(l.next(e))}catch(e){t(e)}}function n(e){try{o(l.throw(e))}catch(e){t(e)}}function o(t){t.done?e(t.value):new s(function(e){e(t.value)}).then(i,n)}o((l=l.apply(r,a||[])).next())})},__generator=this&&this.__generator||function(i,n){var o,r,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,r&&(a=r[2&t[0]?"return":t[0]?"throw":"next"])&&!(a=a.call(r,t[1])).done)return a;switch(r=0,a&&(t=[0,a.value]),t[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,r=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=n.call(i,s)}catch(e){t=[6,e],r=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}};!function(u){!function(e){"use strict";var i="scxToolbarLoadableInputLoading",s="data-scxinstrument",l="active",c=13,h=27,d=40,_=38,t=(n.prototype._init=function(){var i=this;this._inputField.addClass("scxInstrumentSearchInputField"),this._inputField.attr("type","text"),this._inputField.wrap('<div class="scxToolbarLoadableInput"></div>'),this._inputContainer=this._inputField.parent(),this._config.value?(this._inputField.val(this._value),this._currentText=this._value):this._inputField.val(""),e.HtmlContainer.instance.register("searchResult",this._resultsDropDown),this._setupInputListeners(),this._inputField.on(u.MouseEvent.CLICK,function(){i._inputField.select()}),$(window).scroll(function(){i._hideDropDown()}),$(window).resize(function(){i._hideDropDown()}),this._resultsDropDown.on(u.MouseEvent.CLICK,".scxInstrumentSearchItem",function(e){i._setValue($(e.currentTarget).attr(s),!0),i._hideDropDown()}),this._resultsDropDown.on(u.MouseEvent.OVER,".scxInstrumentSearchItem",function(e){$(e.currentTarget).parent().children().removeClass(l),$(e.currentTarget).addClass(l)}),this._resultsDropDown.on("scroll",function(s){return __awaiter(i,void 0,void 0,function(){var t,i,n,o,r,a;return __generator(this,function(e){switch(e.label){case 0:return(s.stopPropagation(),t=s.target,i=t.clientHeight,n=t.scrollTop,o=t.scrollHeight,i+n<o)?[2]:(this._repositoryParams.skip+=this._repositoryParams.take,r=this._generateSearchResults,a=[this._getInputValue().toUpperCase()],[4,this._search(this._getInputValue())]);case 1:return r.apply(this,a.concat([e.sent(),!1])),[2]}})})}),$(document).on(u.MouseEvent.CLICK,function(e){var t=$(e.currentTarget);i._isDropDownVisible&&!t.is(i._inputField)&&0===t.parents(".scxInstrumentSearchResults").length&&(i._inputField.val(i._value),i._hideDropDown())}),$("body").bind("scxContextMenuOpen",function(e){i._inputField.val(i._value),i._hideDropDown()})},n.prototype.set=function(e){this._setValue(e?e.symbol:"")},n.prototype.getBySymbol=function(){throw new Error("getBySymbol is deprecated!")},n.prototype._setupInputListeners=function(){var e=this;this._inputField.on("input",function(){return __awaiter(e,void 0,void 0,function(){var t,i;return __generator(this,function(e){switch(e.label){case 0:return this._isDropDownVisible||$("body").trigger("click"),(t=this._getInputValue())===this._currentText?[3,2]:[4,this._search(t)];case 1:i=e.sent(),this._currentText=t,this._resultsCount=i.length,this._showDropDown(),this._generateSearchResults(t.toUpperCase(),i),e.label=2;case 2:return[2]}})})}),this._inputField.focus(function(e){$(e.currentTarget).addClass(l)}),this._inputField.blur(function(e){$(e.currentTarget).removeClass(l)}),this._inputField.keyup(function(a){return __awaiter(e,void 0,void 0,function(){var t,i,n,o,r;return __generator(this,function(e){switch(e.label){case 0:switch(t=a.which){case h:this._inputField.val(this._value),this._hideDropDown(),this._inputField.blur();break;case c:i=this._getInputValue(),this._isDropDownVisible&&0<(n=this._resultsDropDown.find(" > ."+l)).length&&(i=n.attr(s)),this._setValue(i,!0),this._hideDropDown(),this._inputField.blur()}return this._isDropDownVisible||t!==d&&t!==_?[3,2]:(this._showDropDown(),o=this._generateSearchResults,r=[this._getInputValue().toUpperCase()],[4,this._search(this._getInputValue())]);case 1:o.apply(this,r.concat([e.sent()])),e.label=2;case 2:if(0<this._resultsCount)switch(t){case d:this._highlightDropDownItem(!1);break;case _:this._highlightDropDownItem(!0)}return[2]}})})})},n.prototype._getInputValue=function(){return $("<div></div>").text(this._inputField.val()).html()},n.prototype._highlightDropDownItem=function(e){var t=this._resultsDropDown,i=t.find(" > ."+l),n=this._resultsDropDown.children();0===i.length?e?n.last().addClass(l):n.first().addClass(l):(i.removeClass(l),e?i.is(n.first())?n.last().addClass(l):i.prev().addClass(l):i.is(n.last())?n.first().addClass(l):i.next().addClass(l));var o=(i=t.find(" > ."+l)).outerHeight()*i.index(),r=o+i.outerHeight();o<t.scrollTop()?t.scrollTop(o):r>t.scrollTop()+t.outerHeight()&&t.scrollTop(r-t.height())},n.prototype._setValue=function(e,t){this._value=this._currentText=e,this._inputField.val(e),t&&this._config.onChange&&this._config.onChange(this._getInstrumentBySymbol(e))},n.prototype._hideDropDown=function(){this._isDropDownVisible=!1,this._resultsDropDown.empty().hide(),this._currentText=this._inputField.val(),this._repositoryParams.skip=0},n.prototype._showDropDown=function(){var t=this;this._resultsDropDown.width("41.6651em");var e,i,n,o,r,a=$(window),s=a.width(),l=this._resultsDropDown.outerWidth(!0);s<l&&this._resultsDropDown.outerWidth(s),this._isDropDownVisible||(this._isDropDownVisible=!0,e=this._inputField.outerHeight(),i=a.scrollTop(),n=a.scrollLeft(),r=(o=this._inputField.offset()).left,0<n&&(r-=n),0<i&&(e-=i),this._resultsDropDown.css({top:o.top+e+2,left:r,maxHeight:a.height()-o.top-e-10}),s<l&&this._resultsDropDown.width(s),this._resultsDropDown.show(),u.Localization.localizeText(this._config.chart,"instrument.noResults").then(function(e){t._noResults.text(e)}))},n.prototype._generateSearchResults=function(e,t,i){if(void 0===i&&(i=!0),this._noResults.detach(),i?(this._instruments=t,this._resultsDropDown.empty()):this._instruments.concat(t),0!==t.length){for(var n="",o=0,r=t;o<r.length;o++){var a=r[o];n+=this._generateListElement(e,a.symbol,a.company,a.exchange)}0<n.length&&this._resultsDropDown.append($(n))}else this._noResults.appendTo(this._resultsDropDown)},n.prototype._generateListElement=function(e,t,i,n){return'<div class="scxInstrumentSearchItem" '+s+'="'+t+'"><div class="scxInstrumentSearchItem_SymbolContainer"><span class="scxInstrumentSearchItem_Symbol">'+this._highlightHTMLText(e,t)+'</span></div><div class="scxInstrumentSearchItem_NameContainer"><span class="scxInstrumentSearchItem_Name">'+this._highlightHTMLText(e,i)+'</span></div><div class="scxInstrumentSearchItem_ExchangeContainer"><span class="scxInstrumentSearchItem_Exchange">'+n+"</span></div></div>"},n.prototype._highlightHTMLText=function(e,t){if(""===e)return t;var i=this._searchTextPositions(e,t),n="",o=0;if(1===e.length&&1<i.length)for(var r=i.length-1;0<r;r--)i[r].pos-1===i[r-1].pos&&(i[r-1].len+=1,i.splice(r,1));for(var a=0,s=i;a<s.length;a++){var l=s[a];n+=t.substr(o,l.pos-o)+'<span class="scxHighlightedText">'+t.substr(l.pos,l.len)+"</span>",o=l.pos+l.len}return o<t.length&&(n+=t.substr(o,t.length-o)),n},n.prototype._searchTextPositions=function(e,t){var i,n=0,o=[],r=e.length;for(e=e.toLowerCase(),t=t.toLowerCase();-1<(i=t.indexOf(e,n));)o.push({pos:i,len:r}),n=i+1;return o},n.prototype._search=function(e){var t=this;return e=e.toLowerCase()||"",this._inputContainer.addClass(i),this._getInstruments(__assign({},this._repositoryParams,{search:e})).then(function(e){return t._inputContainer.removeClass(i),e})},n.prototype._getInstrumentBySymbol=function(t){return this._instruments.find(function(e){return e.symbol===t})||null},n.prototype._getInstruments=function(e){return this._config.chart.instrumentsRepository.getItems(e)},n);function n(e,t){this._instruments=[],this._repositoryParams={skip:0,take:10},this._inputField=e,this._config=t,this._value=t.value||"",this._config.onChange=u.JsUtil.isFunction(t.onChange)?t.onChange:null,this._isDropDownVisible=!1,this._resultsCount=0,this._currentText="",this._resultsDropDown=$('<div class="scxInstrumentSearchResults"></div>'),this._noResults=$('<div class="scxInstrumentSearchNoResults"></div>'),null!==t.instruments&&Array.isArray(t.instruments)&&0<t.instruments.length&&(this._config.instruments=t.instruments),this._init()}e.InstrumentSearch=t}(u.UI||(u.UI={}))}(StockChartX=StockChartX||{}),function(a){!function(e){"use strict";var r=jQuery,t=(Object.defineProperty(i.prototype,"visible",{get:function(){return this._visible},set:function(e){this._visible=e,this._updateVisibility()},enumerable:!0,configurable:!0}),i.prototype._init=function(e,t){var i=this,n=r(e).appendTo(t.target);this.container=n.find(".scxNavigation");var o=this.chart=t.chart;this.container.find(".scxNavigation-btn-scrollLeft").on("click",function(){o.scrollOnPixels(o.size.width/5),o.setNeedsUpdate(!0)}),this.container.find(".scxNavigation-btn-scrollRight").on("click",function(){o.scrollOnPixels(-o.size.width/5),o.setNeedsUpdate(!0)}),this.container.find(".scxNavigation-btn-zoomIn").on("click",function(){o.zoomOnPixels(o.size.width/5),o.setNeedsUpdate(!0)}),this.container.find(".scxNavigation-btn-zoomOut").on("click",function(){o.zoomOnPixels(-o.size.width/5),o.setNeedsUpdate(!0)}),this.container.find(".scxNavigation-btn-reload").on("click",function(){o.reload()}),this.container.find(".scxNavigation-btn-scrollToFirst").on("click",function(){var e=i.chart.lastVisibleRecord-o.firstVisibleRecord;1<e&&(o.firstVisibleRecord=0,o.lastVisibleRecord=Math.min(e,o.recordCount-1),o.setNeedsUpdate(!0))}),this.container.find(".scxNavigation-btn-scrollToLast").on("click",function(){var e,t,i=o.recordCount;0<i&&(e=o.firstVisibleRecord,t=o.lastVisibleRecord,o.lastVisibleRecord=i-1,o.firstVisibleRecord=Math.max(i-(t-e+1),0),o.setNeedsUpdate(!0))}),n.mouseover(function(){a.HtmlUtil.setVisibility(i.container,i._visible)}),n.mouseout(function(){a.HtmlUtil.setVisibility(i.container,!1)}),this._updateVisibility(),this.chart.pixelsPrice&&this.chart.setPixelsPrice(this.chart.pixelsPrice)},i.prototype._updateVisibility=function(){this.container&&a.HtmlUtil.setVisibility(this.container,!1)},i.prototype.draw=function(){this.dateScaleContainer||(this.dateScaleContainer=this.chart&&this.chart.rootDiv.find(".scxBottomDateScale")),this.dateScaleContainer},i.prototype.destroy=function(){this.chart=null},i);function i(t){var i=this;this._visible=!0,e.HtmlLoader.loadHtml("Navigation.html",function(e){i._init(e,t)})}e.ChartNavigation=t}(a.UI||(a.UI={}))}(StockChartX=StockChartX||{});__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}(),__awaiter=this&&this.__awaiter||function(r,a,s,l){return new(s=s||Promise)(function(e,t){function i(e){try{o(l.next(e))}catch(e){t(e)}}function n(e){try{o(l.throw(e))}catch(e){t(e)}}function o(t){t.done?e(t.value):new s(function(e){e(t.value)}).then(i,n)}o((l=l.apply(r,a||[])).next())})},__generator=this&&this.__generator||function(i,n){var o,r,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,r&&(a=r[2&t[0]?"return":t[0]?"throw":"next"])&&!(a=a.call(r,t[1])).done)return a;switch(r=0,a&&(t=[0,a.value]),t[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,r=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=n.call(i,s)}catch(e){t=[6,e],r=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}};!function(c){!function(e){"use strict";var i,t="#scxPriceStyleDialog_",n=".scxPriceStyleDialog_input_",o=".scxPriceStyleDialog_panel_ntb_",r={showArrows:!0,maxValue:100,minValue:1,value:1},a={showArrows:!0,maxValue:100,minValue:.01,priceDecimals:5,value:1},s=(i=e.Dialog,__extends(l,i),l.prototype.show=function(e){this.initDialog(e)&&(this._priceStyleKind=e.priceStyle.chart.priceStyleKind,this._setDialogTitle(),this._setValues(this._priceStyleKind),this._switchView(this._priceStyleKind),i.prototype.show.call(this,e))},l.prototype._init=function(){var e=this;this._input_ATRlength.scxNumericField(r),this._input_boxSize.scxNumericField(a),this._input_pointsCount.scxNumericField(r),this._input_reversalAmount.scxNumericField(r),this._input_reversalDoubleAmount.scxNumericField(a),this._input_numberOfLine.scxNumericField(r),this._input_source.selectpicker({container:"body"}),this._input_boxSizeKind.selectpicker({container:"body"}),this._input_barStyle.selectpicker({container:"body"}),this._input_coloredBarStyle.selectpicker({container:"body"}),this._input_source.on("change",function(){e._source=e._input_source.val(),e._switchPriceStyleMethod()}),this._input_boxSizeKind.on("change",function(){e._boxSizeKind=e._input_boxSizeKind.val(),e._switchPriceStyleMethod()}),this._input_barStyle.on("change",function(){e._barsStyle=e._input_barStyle.val()}),this._input_coloredBarStyle.on("change",function(){e._coloredBarsStyle=e._input_coloredBarStyle.val()}),this._dialog.find(t+"btn_save").on("click",function(){e._apply()})},l.prototype._switchView=function(e){switch(this._panelFigureInputsPanel.show(),e){case c.PointAndFigurePriceStyle.className:return this._switchPriceStyleMethod(),this._panelFigureNumberOfLine.hide(),this._panelFigureSource.show(),this._panelFigureBoxCalculationMethods.show(),this._panelFigureReversalAmount.show(),this._panelFigureReversalDoubleAmount.hide(),this._panelFigureBarStyle.hide(),void this._panelFigureColoredBarStyle.hide();case c.RenkoPriceStyle.className:case c.KagiPriceStyle.className:return this._switchPriceStyleMethod(),this._panelFigureNumberOfLine.hide(),this._panelFigureSource.hide(),this._panelFigureBoxCalculationMethods.show(),this._panelFigureReversalAmount.hide(),this._panelFigureReversalDoubleAmount.hide(),this._panelFigureBarStyle.hide(),void this._panelFigureColoredBarStyle.hide();case c.LineBreakPriceStyle.className:return this._panelFigureNumberOfLine.show(),this._panelFigureSource.hide(),this._panelFigureBoxCalculationMethods.hide(),this._panelFigureReversalAmount.hide(),this._panelFigureBoxSize.hide(),this._panelFigurePointsCount.hide(),this._panelFigureATRLength.hide(),this._panelFigureReversalDoubleAmount.hide(),this._panelFigureBarStyle.hide(),void this._panelFigureColoredBarStyle.hide();case c.BarPriceStyle.className:case c.HLBarPriceStyle.className:case c.HLCBarPriceStyle.className:return this._panelFigureBarStyle.show(),this._panelFigureNumberOfLine.hide(),this._panelFigureSource.hide(),this._panelFigureBoxCalculationMethods.hide(),this._panelFigureReversalAmount.hide(),this._panelFigureBoxSize.hide(),this._panelFigurePointsCount.hide(),this._panelFigureATRLength.hide(),this._panelFigureReversalDoubleAmount.hide(),void this._panelFigureColoredBarStyle.hide();case c.ColoredBarPriceStyle.className:case c.ColoredHLBarPriceStyle.className:case c.ColoredHLCBarPriceStyle.className:return this._panelFigureColoredBarStyle.show(),this._panelFigureBarStyle.hide(),this._panelFigureNumberOfLine.hide(),this._panelFigureSource.hide(),this._panelFigureBoxCalculationMethods.hide(),this._panelFigureReversalAmount.hide(),this._panelFigureBoxSize.hide(),this._panelFigurePointsCount.hide(),this._panelFigureATRLength.hide(),void this._panelFigureReversalDoubleAmount.hide();default:return}},l.prototype._switchPriceStyleMethod=function(){switch(this._boxSizeKind){case c.PointAndFigureBoxSizeKind.ATR:this._panelFigureBoxSize.hide(),this._panelFigurePointsCount.hide(),this._panelFigureATRLength.show();break;case c.PointAndFigureBoxSizeKind.FIXED:this._panelFigureBoxSize.show(),this._panelFigurePointsCount.hide(),this._panelFigureATRLength.hide();break;case c.PointAndFigureBoxSizeKind.POINTS:this._panelFigureBoxSize.hide(),this._panelFigurePointsCount.show(),this._panelFigureATRLength.hide()}},l.prototype._setValues=function(e){switch(e){case c.PointAndFigurePriceStyle.className:var t=this._config.priceStyle;switch(this._source=t.source,this._input_source.selectpicker("val",this._source||c.PointAndFigureSource.CLOSE).selectpicker("refresh"),this._boxSizeKind=t.boxSize.kind,this._input_boxSizeKind.selectpicker("val",this._boxSizeKind||c.PointAndFigureBoxSizeKind.ATR).selectpicker("refresh"),this._boxSizeKind){case c.PointAndFigureBoxSizeKind.ATR:this._input_ATRlength.scxNumericField("setValue",t.boxSize.value||1);break;case c.PointAndFigureBoxSizeKind.FIXED:this._input_boxSize.scxNumericField("setValue",t.boxSize.value||1);break;case c.PointAndFigureBoxSizeKind.POINTS:this._input_pointsCount.scxNumericField("setValue",t.boxSize.value||1)}return void this._input_reversalAmount.scxNumericField("setValue",t.reversal||1);case c.RenkoPriceStyle.className:var i=this._config.priceStyle;switch(this._boxSizeKind=i.boxSize.kind,this._input_boxSizeKind.selectpicker("val",this._boxSizeKind||c.RenkoBoxSizeKind.ATR).selectpicker("refresh"),this._boxSizeKind){case c.PointAndFigureBoxSizeKind.ATR:this._input_ATRlength.scxNumericField("setValue",i.boxSize.value||1);break;case c.PointAndFigureBoxSizeKind.FIXED:this._input_boxSize.scxNumericField("setValue",i.boxSize.value||1);break;case c.PointAndFigureBoxSizeKind.POINTS:this._input_pointsCount.scxNumericField("setValue",i.boxSize.value||1)}return;case c.KagiPriceStyle.className:var n=this._config.priceStyle;switch(this._boxSizeKind=n.reversal.kind,this._input_boxSizeKind.selectpicker("val",this._boxSizeKind||c.KagiReversalKind.ATR).selectpicker("refresh"),this._boxSizeKind){case c.PointAndFigureBoxSizeKind.ATR:this._input_reversalAmount.scxNumericField("setValue",n.reversal.value||1);break;case c.PointAndFigureBoxSizeKind.FIXED:case c.PointAndFigureBoxSizeKind.POINTS:this._input_reversalDoubleAmount.scxNumericField("setValue",n.reversal.value||1)}return;case c.LineBreakPriceStyle.className:var o=this._config.priceStyle;return void this._input_numberOfLine.scxNumericField("setValue",o.lines||1);case c.BarPriceStyle.className:case c.HLBarPriceStyle.className:case c.HLCBarPriceStyle.className:return void this._setBarStyle(e);case c.ColoredBarPriceStyle.className:case c.ColoredHLBarPriceStyle.className:case c.ColoredHLCBarPriceStyle.className:return void this._setBarStyle(e,!0);default:return void this.hide()}},l.prototype._setBarStyle=function(e,t){t?(this._coloredBarsStyle=e,this._input_coloredBarStyle.selectpicker("val",e).selectpicker("refresh")):(this._barsStyle=e,this._input_barStyle.selectpicker("val",e).selectpicker("refresh"))},l.prototype._getValues=function(){var e=this._config.chart,t={value:c.PointAndFigurePriceStyle.defaults.boxSize.value,kind:this._input_boxSizeKind.val()};switch(this._priceStyleKind){case c.PointAndFigurePriceStyle.className:var i=this._config.priceStyle;switch(i.source=this._input_source.val(),t.kind=this._input_boxSizeKind.val(),i.boxSize.kind){case c.PointAndFigureBoxSizeKind.ATR:t.value=this._input_ATRlength.scxNumericField("getValue");break;case c.PointAndFigureBoxSizeKind.FIXED:t.value=this._input_boxSize.scxNumericField("getValue");break;case c.PointAndFigureBoxSizeKind.POINTS:t.value=this._input_pointsCount.scxNumericField("getValue")}i.boxSize=t,i.reversal=this._input_reversalAmount.scxNumericField("getValue");break;case c.RenkoPriceStyle.className:var n=this._config.priceStyle;switch(t.kind=this._input_boxSizeKind.val(),n.boxSize.kind){case c.PointAndFigureBoxSizeKind.ATR:t.value=this._input_ATRlength.scxNumericField("getValue");break;case c.PointAndFigureBoxSizeKind.FIXED:t.value=this._input_boxSize.scxNumericField("getValue");break;case c.PointAndFigureBoxSizeKind.POINTS:t.value=this._input_pointsCount.scxNumericField("getValue")}n.boxSize=t;break;case c.KagiPriceStyle.className:var o=this._config.priceStyle,r={kind:this._input_boxSizeKind.val(),value:c.KagiPriceStyle.defaults.reversal.value};switch(o.reversal.kind){case c.PointAndFigureBoxSizeKind.ATR:r.value=this._input_reversalAmount.scxNumericField("getValue");break;case c.PointAndFigureBoxSizeKind.FIXED:case c.PointAndFigureBoxSizeKind.POINTS:r.value=this._input_reversalDoubleAmount.scxNumericField("getValue")}o.reversal=r;break;case c.LineBreakPriceStyle.className:this._config.priceStyle.lines=this._input_numberOfLine.scxNumericField("getValue");break;case c.BarPriceStyle.className:case c.HLBarPriceStyle.className:case c.HLCBarPriceStyle.className:e.priceStyleKind=this._barsStyle,e.update();break;case c.ColoredBarPriceStyle.className:case c.ColoredHLBarPriceStyle.className:case c.ColoredHLCBarPriceStyle.className:e.priceStyleKind=this._coloredBarsStyle,e.update();break;default:throw new Error("Unknown price style: "+this._priceStyleKind)}},l.prototype._apply=function(){this._getValues();var e=this._config.chart.priceStyleKind;e!==c.BarPriceStyle.className&&e!==c.HLBarPriceStyle.className&&e!==c.HLCBarPriceStyle.className&&e!==c.ColoredBarPriceStyle.className&&e!==c.ColoredHLBarPriceStyle.className&&e!==c.ColoredHLCBarPriceStyle.className&&this._config.priceStyle.apply(),this._config.chart.dateScale.setNeedsAutoScale(),this._config.chart.setNeedsUpdate(!0),this.hide()},l.prototype._setDialogTitle=function(){return __awaiter(this,void 0,void 0,function(){var t,i;return __generator(this,function(e){switch(e.label){case 0:return[4,c.Localization.localizeText(this._config.chart,"priceStyle.all.dialog.kind."+this._priceStyleKind)];case 1:return t=e.sent(),[4,c.Localization.localizeText(this._config.chart,"priceStyle.all.dialog.title",{replace:{priceStyleName:t}})];case 2:return i=e.sent(),this._title.text(i),[2]}})})},l.prototype._initFields=function(){var e=this._dialog;this._title=e.find(t+"title"),this._panelFigureInputsPanel=e.find(o+"inputsPanel"),this._input_source=e.find(n+"source"),this._input_boxSizeKind=e.find(n+"boxSizeKind"),this._input_ATRlength=e.find(n+"ATRLength"),this._input_boxSize=e.find(n+"boxSize"),this._input_pointsCount=e.find(n+"pointsCount"),this._input_reversalAmount=e.find(n+"reversalAmount"),this._input_reversalDoubleAmount=e.find(n+"reversalDoubleAmount"),this._input_numberOfLine=e.find(n+"numberOfLine"),this._panelFigureSource=e.find(o+"source"),this._panelFigureBoxCalculationMethods=e.find(o+"boxSizeKind"),this._panelFigureATRLength=e.find(o+"ATRLength"),this._panelFigureBoxSize=e.find(o+"boxSize"),this._panelFigurePointsCount=e.find(o+"pointsCount"),this._panelFigureReversalAmount=e.find(o+"reversalAmount"),this._panelFigureReversalDoubleAmount=e.find(o+"reversalDoubleAmount"),this._panelFigureNumberOfLine=e.find(o+"numberOfLine"),this._panelFigureBarStyle=e.find(o+"barStyle"),this._input_barStyle=e.find(n+"barStyle"),this._panelFigureColoredBarStyle=e.find(o+"coloredBarStyle"),this._input_coloredBarStyle=e.find(n+"coloredBarStyle")},l);function l(e){var t=i.call(this,e)||this;return t._initFields(),t._init(),t}e.PriceStyleSettingsDialog=s}(c.UI||(c.UI={}))}(StockChartX=StockChartX||{});__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}(),__awaiter=this&&this.__awaiter||function(r,a,s,l){return new(s=s||Promise)(function(e,t){function i(e){try{o(l.next(e))}catch(e){t(e)}}function n(e){try{o(l.throw(e))}catch(e){t(e)}}function o(t){t.done?e(t.value):new s(function(e){e(t.value)}).then(i,n)}o((l=l.apply(r,a||[])).next())})},__generator=this&&this.__generator||function(i,n){var o,r,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,r&&(a=r[2&t[0]?"return":t[0]?"throw":"next"])&&!(a=a.call(r,t[1])).done)return a;switch(r=0,a&&(t=[0,a.value]),t[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,r=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=n.call(i,s)}catch(e){t=[6,e],r=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}};!function(h){!function(i){"use strict";var n,e="#scxThemeDialog_",t="#scxThemeDialog_label_",r="#scxThemeDialog_chk_",o="#scxThemeDialog_input_",a="#scxThemeDialog_btn_",s="theme.name.",l=(n=i.Dialog,__extends(c,n),c.prototype.show=function(e){this.initDialog(e)&&(this._setValues(),this._hideNewThemeForm(),n.prototype.show.call(this,e),this._chart=e.chart)},c.prototype._init=function(){var o=this;this._fieldTextFont.selectpicker({container:"body"}).change(function(e){o._fieldTextFont.next().css({"font-family":e.target.value})}),this._fieldTextSize.selectpicker({container:"body"}),this._fieldTheme.selectpicker({container:"body"}).change(function(e){var t=$(e.currentTarget).val();t&&o._config.theme.name!==t&&(o._setTitle(t),o._config.theme=h.Theme[t],o._setValues())}),this._btnNewTheme.on("click",function(){var e,t=o._dialogBody.scrollTop();o._showNewThemeForm(),o.resize(),o._dialogBody[0].scrollHeight>$(window).height()&&(t=t<(e=o._wrapperTheme.position().top+o._wrapperTheme.outerHeight(!0)-o._dialogBody.height())?e:t,o._dialogBody.scrollTop(t))}),this._fieldNewThemeName.keyup(function(e){13===e.which&&o._addNewTheme()}),this._fieldNewThemeName.on("input",function(e){o._highlightNewThemeNameInvalid(!1),o._switchNewThemeConfirmButton($(e.currentTarget).val().length)}),this._btnNewThemeConfirm.on("click",function(){o._addNewTheme()}),this._dialog.find(".scxSpectrum").scx().colorPicker({localStorageKey:"scxThemeDialog_spectrum"}),this._chkUpBarBorderEnabled=new Switchery(document.querySelector(r+"upBarBorderColor"),c._switcherySettings),this._chkDownBarBorderEnabled=new Switchery(document.querySelector(r+"downBarBorderColor"),c._switcherySettings),this._chkUpBarBorderEnabled.setPosition(!1),this._chkDownBarBorderEnabled.setPosition(!1),$("body").on("scxSwitcherChanged",function(e,t){var i=$(t.target),n=t.checked;i.is(o._fieldUpBarBorderEnabled)?o._setUpBarBorderState(n):i.is(o._fieldDownBarBorderEnabled)&&o._setDownBarBorderState(n)}),this._btnSaveTheme.on("click",function(){var e=o._getValues();o._saveTheme(e),o._apply(e)}),this._btnApply.on("click",function(){o._apply()})},c.prototype._saveTheme=function(e){var t=this;null==e&&(e=this._getValues()),e.name=this._config.theme.name,this._config.theme=e,h.Theme[this._config.theme.name]=this._config.theme,h.Localization.localizeText(this._chart,"theme.notification.msg.success").then(function(e){i.Notification.success(t._chart,e,null)})},c.prototype._addNewTheme=function(){var e=(e=h.JsUtil.filterText(this._fieldNewThemeName.val())).replace(/\/|;|$|'|"|/gi,"");void 0===h.Theme[e]?(""!==e&&(this._setTitle(e),this._fieldTheme.append(c._generateThemeSelectorItem(e)),this._config.theme=this._getValues(),this._config.theme.name=e,h.Theme[e]=this._config.theme,this._fieldTheme.selectpicker("val",e).selectpicker("refresh")),this._hideNewThemeForm()):this._highlightNewThemeNameInvalid(!0)},c.prototype._showNewThemeForm=function(){this._btnNewTheme.hide(),this._wrapperTheme.show(),h.Environment.isMobile||this._fieldNewThemeName.focus()},c.prototype._hideNewThemeForm=function(){this._fieldNewThemeName.val(""),this._wrapperTheme.hide(),this._btnNewTheme.show()},c.prototype._switchNewThemeConfirmButton=function(e){e?this._btnNewThemeConfirm.scxLocalize("dialog.button.ok").removeClass(c.CLASS_BTN_DEFAULT).addClass(c.CLASS_BTN_PRIMARY):this._btnNewThemeConfirm.scxLocalize("dialog.button.cancel").removeClass(c.CLASS_BTN_PRIMARY).addClass(c.CLASS_BTN_DEFAULT),this._config.chart.localize(this._btnNewThemeConfirm)},c.prototype._setTitle=function(o){return __awaiter(this,void 0,void 0,function(){var t,i,n;return __generator(this,function(e){switch(e.label){case 0:return t=this._config.chart,[4,h.Localization.localizeText(t,s+o,{defaultValue:o})];case 1:return i=e.sent(),[4,h.Localization.localizeText(t,"theme.dialog.title",{replace:{themeName:i}})];case 2:return n=e.sent(),this._dialogTitle.text(n),[2]}})})},c._generateThemeSelectorItem=function(e){return e=h.JsUtil.filterText(e),$('<option title="'+e+'" value="'+e+'" data-i18n="'+(s+e)+'">'+e+"</option>")},c.prototype._setUpBarBorderState=function(e){e?(this._fieldUpBarBorderColor.spectrum("enable"),this._labelUpBarBorderColor.removeClass("disabled"),this._chkUpBarBorderEnabled.isChecked()||this._chkUpBarBorderEnabled.setPosition(!0)):(this._fieldUpBarBorderColor.spectrum("disable"),this._labelUpBarBorderColor.addClass("disabled"),this._chkUpBarBorderEnabled.isChecked()&&this._chkUpBarBorderEnabled.setPosition(!0))},c.prototype._setDownBarBorderState=function(e){e?(this._fieldDownBarBorderColor.spectrum("enable"),this._labelDownBarBorderColor.removeClass("disabled"),this._chkDownBarBorderEnabled.isChecked()||this._chkDownBarBorderEnabled.setPosition(!0)):(this._fieldDownBarBorderColor.spectrum("disable"),this._labelDownBarBorderColor.addClass("disabled"),this._chkDownBarBorderEnabled.isChecked()&&this._chkDownBarBorderEnabled.setPosition(!0))},c.prototype._setValues=function(){var e=this._config.theme;this._setTitle(e.name),this._fieldLineBarColor.spectrum("set",e.plot.line.simple.strokeColor),this._fieldUpBarColor.spectrum("set",e.plot.bar.candle.upCandle.fill.fillColor),this._fieldDownBarColor.spectrum("set",e.plot.bar.candle.downCandle.fill.fillColor),this._fieldUpBarBorderColor.spectrum("set",e.plot.bar.candle.upCandle.border.strokeColor),this._setUpBarBorderState(e.plot.bar.candle.upCandle.border.strokeEnabled),this._fieldDownBarBorderColor.spectrum("set",e.plot.bar.candle.downCandle.border.strokeColor),this._setDownBarBorderState(e.plot.bar.candle.downCandle.border.strokeEnabled),this._fieldWickColor.spectrum("set",e.plot.bar.candle.upCandle.wick.strokeColor),this._fieldTextFont.selectpicker("val",e.valueScale.text.fontFamily).selectpicker("refresh"),this._fieldTextSize.selectpicker("val",e.valueScale.text.fontSize).selectpicker("refresh"),this._fieldTextColor.spectrum("set",e.valueScale.text.fillColor);var t=e.chart.background;Array.isArray(t)?(this._fieldGradient1Color.spectrum("set",t[0]),this._fieldGradient2Color.spectrum("set",t[1]||t[0])):(this._fieldGradient1Color.spectrum("set",t),this._fieldGradient2Color.spectrum("set",t)),this._fieldValueScalePanelColor.spectrum("set",e.valueScale.fill.fillColor),this._fieldDateScalePanelColor.spectrum("set",e.dateScale.fill.fillColor),this._fieldGridColor.spectrum("set",e.chartPanel.grid.strokeColor);var i=[];for(var n in h.Theme)h.Theme.hasOwnProperty(n)&&i.push(c._generateThemeSelectorItem(h.Theme[n].name));this._fieldTheme.empty().append(i),this._fieldTheme.selectpicker("val",this._config.theme.name),this._fieldTheme.selectpicker("refresh"),this._config.chart.localize()},c.prototype._getValues=function(){var e=$.extend(!0,{},this._config.theme),t=this._fieldLineBarColor.spectrum("get").toRgbString();e.plot.line.simple.strokeColor=t,e.plot.line.mountain.line.strokeColor=t,e.plot.bar.OHLC.strokeColor=t,e.plot.bar.HLC.strokeColor=t,e.plot.bar.HL.strokeColor=t;var i=this._fieldUpBarColor.spectrum("get").toRgbString();e.plot.bar.candle.upCandle.fill.fillColor=i,e.plot.bar.coloredOHLC.upBar.strokeColor=i,e.plot.bar.coloredHLC.upBar.strokeColor=i,e.plot.bar.coloredHL.upBar.strokeColor=i,e.plot.bar.candle.upCandle.fill.fillColor=i,e.plot.bar.hollowCandle.upCandle.fill.fillColor=i,e.plot.bar.hollowCandle.upHollowCandle.border.strokeColor=i,e.plot.bar.hollowCandle.upHollowCandle.wick.strokeColor=i,e.plot.bar.heikinAshi.upCandle.fill.fillColor=i,e.plot.bar.renko.upCandle.fill.fillColor=i,e.plot.bar.lineBreak.upCandle.fill.fillColor=i,e.plot.bar.pointAndFigure.upCandle.border.strokeColor=i,e.plot.bar.kagi.upCandle.border.strokeColor=i,e.plot.bar.candleVolume.upCandle.border.strokeColor=i,e.plot.bar.candleVolume.upCandle.fill.fillColor=i,e.plot.bar.equiVolume.upCandle.border.strokeColor=i,e.plot.bar.equiVolume.upCandle.fill.fillColor=i,e.plot.bar.equiVolumeShadow.upCandle.border.strokeColor=i,e.plot.bar.equiVolumeShadow.upCandle.fill.fillColor=i;var n=this._fieldDownBarColor.spectrum("get").toRgbString();e.plot.bar.candle.downCandle.fill.fillColor=n,e.plot.bar.coloredOHLC.downBar.strokeColor=n,e.plot.bar.coloredHLC.downBar.strokeColor=n,e.plot.bar.coloredHL.downBar.strokeColor=n,e.plot.bar.candle.downCandle.fill.fillColor=n,e.plot.bar.hollowCandle.downCandle.fill.fillColor=n,e.plot.bar.hollowCandle.downHollowCandle.border.strokeColor=n,e.plot.bar.hollowCandle.downHollowCandle.wick.strokeColor=n,e.plot.bar.heikinAshi.downCandle.fill.fillColor=n,e.plot.bar.renko.downCandle.fill.fillColor=n,e.plot.bar.lineBreak.downCandle.fill.fillColor=n,e.plot.bar.pointAndFigure.downCandle.border.strokeColor=n,e.plot.bar.kagi.downCandle.border.strokeColor=n,e.plot.bar.candleVolume.downCandle.border.strokeColor=n,e.plot.bar.candleVolume.downCandle.fill.fillColor=n,e.plot.bar.equiVolume.downCandle.border.strokeColor=n,e.plot.bar.equiVolume.downCandle.fill.fillColor=n,e.plot.bar.equiVolumeShadow.downCandle.border.strokeColor=n,e.plot.bar.equiVolumeShadow.downCandle.fill.fillColor=n,e.plot.bar.candle.upCandle.border.strokeColor=this._fieldUpBarBorderColor.spectrum("get").toRgbString(),e.plot.bar.candle.upCandle.border.strokeEnabled=this._chkUpBarBorderEnabled.isChecked(),e.plot.bar.equiVolume.upCandle.border.strokeColor=this._fieldUpBarBorderColor.spectrum("get").toRgbString(),e.plot.bar.equiVolume.upCandle.border.strokeEnabled=this._chkUpBarBorderEnabled.isChecked(),e.plot.bar.candle.downCandle.border.strokeColor=this._fieldDownBarBorderColor.spectrum("get").toRgbString(),e.plot.bar.candle.downCandle.border.strokeEnabled=this._chkDownBarBorderEnabled.isChecked(),e.plot.bar.equiVolume.downCandle.border.strokeColor=this._fieldDownBarBorderColor.spectrum("get").toRgbString(),e.plot.bar.equiVolume.downCandle.border.strokeEnabled=this._chkDownBarBorderEnabled.isChecked(),e.plot.bar.candleVolume.upCandle.border.strokeColor=this._fieldUpBarBorderColor.spectrum("get").toRgbString(),e.plot.bar.candleVolume.upCandle.border.strokeEnabled=this._chkUpBarBorderEnabled.isChecked(),e.plot.bar.candleVolume.downCandle.border.strokeColor=this._fieldDownBarBorderColor.spectrum("get").toRgbString(),e.plot.bar.candleVolume.downCandle.border.strokeEnabled=this._chkDownBarBorderEnabled.isChecked();var o=this._fieldWickColor.spectrum("get").toRgbString();e.plot.bar.candle.upCandle.wick.strokeColor=o,e.plot.bar.candle.downCandle.wick.strokeColor=o,e.plot.bar.hollowCandle.upCandle.wick.strokeColor=o,e.plot.bar.hollowCandle.downCandle.wick.strokeColor=o,e.plot.bar.heikinAshi.upCandle.wick.strokeColor=o,e.plot.bar.heikinAshi.downCandle.wick.strokeColor=o,e.plot.bar.candleVolume.downCandle.wick.strokeColor=o,e.plot.bar.candleVolume.upCandle.wick.strokeColor=o;var r=this._fieldTextFont.selectpicker("val");r&&(e.chartPanel.title.fontFamily=r,e.valueScale.text.fontFamily=r,e.valueScale.valueMarker.text.fontFamily=r,e.dateScale.text.fontFamily=r,e.dateScale.dateMarker.text.fontFamily=r,e.orderBar.buy.market.pendingSubmit.kind.text.fontFamily=r,e.orderBar.buy.market.pendingCancel.kind.text.fontFamily=r,e.orderBar.buy.market.pendingReplace.kind.text.fontFamily=r,e.orderBar.buy.market.submitted.kind.text.fontFamily=r,e.orderBar.buy.market.accepted.kind.text.fontFamily=r,e.orderBar.buy.market.pendingSubmit.quantity.text.fontFamily=r,e.orderBar.buy.market.pendingCancel.quantity.text.fontFamily=r,e.orderBar.buy.market.pendingReplace.quantity.text.fontFamily=r,e.orderBar.buy.market.submitted.quantity.text.fontFamily=r,e.orderBar.buy.market.accepted.quantity.text.fontFamily=r,e.orderBar.buy.market.pendingSubmit.price.text.fontFamily=r,e.orderBar.buy.market.pendingCancel.price.text.fontFamily=r,e.orderBar.buy.market.pendingReplace.price.text.fontFamily=r,e.orderBar.buy.market.submitted.price.text.fontFamily=r,e.orderBar.buy.market.accepted.price.text.fontFamily=r,e.orderBar.buy.stop.pendingSubmit.kind.text.fontFamily=r,e.orderBar.buy.stop.pendingCancel.kind.text.fontFamily=r,e.orderBar.buy.stop.pendingReplace.kind.text.fontFamily=r,e.orderBar.buy.stop.submitted.kind.text.fontFamily=r,e.orderBar.buy.stop.accepted.kind.text.fontFamily=r,e.orderBar.buy.stop.pendingSubmit.quantity.text.fontFamily=r,e.orderBar.buy.stop.pendingCancel.quantity.text.fontFamily=r,e.orderBar.buy.stop.pendingReplace.quantity.text.fontFamily=r,e.orderBar.buy.stop.submitted.quantity.text.fontFamily=r,e.orderBar.buy.stop.accepted.quantity.text.fontFamily=r,e.orderBar.buy.stop.pendingSubmit.price.text.fontFamily=r,e.orderBar.buy.stop.pendingCancel.price.text.fontFamily=r,e.orderBar.buy.stop.pendingReplace.price.text.fontFamily=r,e.orderBar.buy.stop.submitted.price.text.fontFamily=r,e.orderBar.buy.stop.accepted.price.text.fontFamily=r,e.orderBar.buy.limit.pendingSubmit.kind.text.fontFamily=r,e.orderBar.buy.limit.pendingCancel.kind.text.fontFamily=r,e.orderBar.buy.limit.pendingReplace.kind.text.fontFamily=r,e.orderBar.buy.limit.submitted.kind.text.fontFamily=r,e.orderBar.buy.limit.accepted.kind.text.fontFamily=r,e.orderBar.buy.limit.pendingSubmit.quantity.text.fontFamily=r,e.orderBar.buy.limit.pendingCancel.quantity.text.fontFamily=r,e.orderBar.buy.limit.pendingReplace.quantity.text.fontFamily=r,e.orderBar.buy.limit.submitted.quantity.text.fontFamily=r,e.orderBar.buy.limit.accepted.quantity.text.fontFamily=r,e.orderBar.buy.limit.pendingSubmit.price.text.fontFamily=r,e.orderBar.buy.limit.pendingCancel.price.text.fontFamily=r,e.orderBar.buy.limit.pendingReplace.price.text.fontFamily=r,e.orderBar.buy.limit.submitted.price.text.fontFamily=r,e.orderBar.buy.limit.accepted.price.text.fontFamily=r,e.orderBar.buy.stopLimit.pendingSubmit.kind.text.fontFamily=r,e.orderBar.buy.stopLimit.pendingCancel.kind.text.fontFamily=r,e.orderBar.buy.stopLimit.pendingReplace.kind.text.fontFamily=r,e.orderBar.buy.stopLimit.submitted.kind.text.fontFamily=r,e.orderBar.buy.stopLimit.accepted.kind.text.fontFamily=r,e.orderBar.buy.stopLimit.pendingSubmit.quantity.text.fontFamily=r,e.orderBar.buy.stopLimit.pendingCancel.quantity.text.fontFamily=r,e.orderBar.buy.stopLimit.pendingReplace.quantity.text.fontFamily=r,e.orderBar.buy.stopLimit.submitted.quantity.text.fontFamily=r,e.orderBar.buy.stopLimit.accepted.quantity.text.fontFamily=r,e.orderBar.buy.stopLimit.pendingSubmit.price.text.fontFamily=r,e.orderBar.buy.stopLimit.pendingCancel.price.text.fontFamily=r,e.orderBar.buy.stopLimit.pendingReplace.price.text.fontFamily=r,e.orderBar.buy.stopLimit.submitted.price.text.fontFamily=r,e.orderBar.buy.stopLimit.accepted.price.text.fontFamily=r,e.orderBar.sell.market.pendingSubmit.kind.text.fontFamily=r,e.orderBar.sell.market.pendingCancel.kind.text.fontFamily=r,e.orderBar.sell.market.pendingReplace.kind.text.fontFamily=r,e.orderBar.sell.market.submitted.kind.text.fontFamily=r,e.orderBar.sell.market.accepted.kind.text.fontFamily=r,e.orderBar.sell.market.pendingSubmit.quantity.text.fontFamily=r,e.orderBar.sell.market.pendingCancel.quantity.text.fontFamily=r,e.orderBar.sell.market.pendingReplace.quantity.text.fontFamily=r,e.orderBar.sell.market.submitted.quantity.text.fontFamily=r,e.orderBar.sell.market.accepted.quantity.text.fontFamily=r,e.orderBar.sell.market.pendingSubmit.price.text.fontFamily=r,e.orderBar.sell.market.pendingCancel.price.text.fontFamily=r,e.orderBar.sell.market.pendingReplace.price.text.fontFamily=r,e.orderBar.sell.market.submitted.price.text.fontFamily=r,e.orderBar.sell.market.accepted.price.text.fontFamily=r,e.orderBar.sell.stop.pendingSubmit.kind.text.fontFamily=r,e.orderBar.sell.stop.pendingCancel.kind.text.fontFamily=r,e.orderBar.sell.stop.pendingReplace.kind.text.fontFamily=r,e.orderBar.sell.stop.submitted.kind.text.fontFamily=r,e.orderBar.sell.stop.accepted.kind.text.fontFamily=r,e.orderBar.sell.stop.pendingSubmit.quantity.text.fontFamily=r,e.orderBar.sell.stop.pendingCancel.quantity.text.fontFamily=r,e.orderBar.sell.stop.pendingReplace.quantity.text.fontFamily=r,e.orderBar.sell.stop.submitted.quantity.text.fontFamily=r,e.orderBar.sell.stop.accepted.quantity.text.fontFamily=r,e.orderBar.sell.stop.pendingSubmit.price.text.fontFamily=r,e.orderBar.sell.stop.pendingCancel.price.text.fontFamily=r,e.orderBar.sell.stop.pendingReplace.price.text.fontFamily=r,e.orderBar.sell.stop.submitted.price.text.fontFamily=r,e.orderBar.sell.stop.accepted.price.text.fontFamily=r,e.orderBar.sell.limit.pendingSubmit.kind.text.fontFamily=r,e.orderBar.sell.limit.pendingCancel.kind.text.fontFamily=r,e.orderBar.sell.limit.pendingReplace.kind.text.fontFamily=r,e.orderBar.sell.limit.submitted.kind.text.fontFamily=r,e.orderBar.sell.limit.accepted.kind.text.fontFamily=r,e.orderBar.sell.limit.pendingSubmit.quantity.text.fontFamily=r,e.orderBar.sell.limit.pendingCancel.quantity.text.fontFamily=r,e.orderBar.sell.limit.pendingReplace.quantity.text.fontFamily=r,e.orderBar.sell.limit.submitted.quantity.text.fontFamily=r,e.orderBar.sell.limit.accepted.quantity.text.fontFamily=r,e.orderBar.sell.limit.pendingSubmit.price.text.fontFamily=r,e.orderBar.sell.limit.pendingCancel.price.text.fontFamily=r,e.orderBar.sell.limit.pendingReplace.price.text.fontFamily=r,e.orderBar.sell.limit.submitted.price.text.fontFamily=r,e.orderBar.sell.limit.accepted.price.text.fontFamily=r,e.orderBar.sell.stopLimit.pendingSubmit.kind.text.fontFamily=r,e.orderBar.sell.stopLimit.pendingCancel.kind.text.fontFamily=r,e.orderBar.sell.stopLimit.pendingReplace.kind.text.fontFamily=r,e.orderBar.sell.stopLimit.submitted.kind.text.fontFamily=r,e.orderBar.sell.stopLimit.accepted.kind.text.fontFamily=r,e.orderBar.sell.stopLimit.pendingSubmit.quantity.text.fontFamily=r,e.orderBar.sell.stopLimit.pendingCancel.quantity.text.fontFamily=r,e.orderBar.sell.stopLimit.pendingReplace.quantity.text.fontFamily=r,e.orderBar.sell.stopLimit.submitted.quantity.text.fontFamily=r,e.orderBar.sell.stopLimit.accepted.quantity.text.fontFamily=r,e.orderBar.sell.stopLimit.pendingSubmit.price.text.fontFamily=r,e.orderBar.sell.stopLimit.pendingCancel.price.text.fontFamily=r,e.orderBar.sell.stopLimit.pendingReplace.price.text.fontFamily=r,e.orderBar.sell.stopLimit.submitted.price.text.fontFamily=r,e.orderBar.sell.stopLimit.accepted.price.text.fontFamily=r,e.positionBar.short.kind.text.fontFamily=r,e.positionBar.short.kind.text.fontFamily=r,e.positionBar.short.kind.text.fontFamily=r,e.positionBar.short.kind.text.fontFamily=r,e.positionBar.short.kind.text.fontFamily=r,e.positionBar.short.quantity.text.fontFamily=r,e.positionBar.short.quantity.text.fontFamily=r,e.positionBar.short.quantity.text.fontFamily=r,e.positionBar.short.quantity.text.fontFamily=r,e.positionBar.short.quantity.text.fontFamily=r,e.positionBar.short.price.text.fontFamily=r,e.positionBar.short.price.text.fontFamily=r,e.positionBar.short.price.text.fontFamily=r,e.positionBar.short.price.text.fontFamily=r,e.positionBar.short.price.text.fontFamily=r,e.positionBar.long.kind.text.fontFamily=r,e.positionBar.long.kind.text.fontFamily=r,e.positionBar.long.kind.text.fontFamily=r,e.positionBar.long.kind.text.fontFamily=r,e.positionBar.long.kind.text.fontFamily=r,e.positionBar.long.quantity.text.fontFamily=r,e.positionBar.long.quantity.text.fontFamily=r,e.positionBar.long.quantity.text.fontFamily=r,e.positionBar.long.quantity.text.fontFamily=r,e.positionBar.long.quantity.text.fontFamily=r,e.positionBar.long.price.text.fontFamily=r,e.positionBar.long.price.text.fontFamily=r,e.positionBar.long.price.text.fontFamily=r,e.positionBar.long.price.text.fontFamily=r,e.positionBar.long.price.text.fontFamily=r);var a=parseInt(this._fieldTextSize.selectpicker("val"),10);e.chartPanel.title.fontSize=a,e.valueScale.text.fontSize=a,e.valueScale.valueMarker.text.fontSize=a,e.dateScale.text.fontSize=a,e.dateScale.dateMarker.text.fontSize=a,e.orderBar.buy.market.pendingSubmit.kind.text.fontSize=a,e.orderBar.buy.market.pendingCancel.kind.text.fontSize=a,e.orderBar.buy.market.pendingReplace.kind.text.fontSize=a,e.orderBar.buy.market.submitted.kind.text.fontSize=a,e.orderBar.buy.market.accepted.kind.text.fontSize=a,e.orderBar.buy.market.pendingSubmit.quantity.text.fontSize=a,e.orderBar.buy.market.pendingCancel.quantity.text.fontSize=a,e.orderBar.buy.market.pendingReplace.quantity.text.fontSize=a,e.orderBar.buy.market.submitted.quantity.text.fontSize=a,e.orderBar.buy.market.accepted.quantity.text.fontSize=a,e.orderBar.buy.market.pendingSubmit.price.text.fontSize=a,e.orderBar.buy.market.pendingCancel.price.text.fontSize=a,e.orderBar.buy.market.pendingReplace.price.text.fontSize=a,e.orderBar.buy.market.submitted.price.text.fontSize=a,e.orderBar.buy.market.accepted.price.text.fontSize=a,e.orderBar.buy.stop.pendingSubmit.kind.text.fontSize=a,e.orderBar.buy.stop.pendingCancel.kind.text.fontSize=a,e.orderBar.buy.stop.pendingReplace.kind.text.fontSize=a,e.orderBar.buy.stop.submitted.kind.text.fontSize=a,e.orderBar.buy.stop.accepted.kind.text.fontSize=a,e.orderBar.buy.stop.pendingSubmit.quantity.text.fontSize=a,e.orderBar.buy.stop.pendingCancel.quantity.text.fontSize=a,e.orderBar.buy.stop.pendingReplace.quantity.text.fontSize=a,e.orderBar.buy.stop.submitted.quantity.text.fontSize=a,e.orderBar.buy.stop.accepted.quantity.text.fontSize=a,e.orderBar.buy.stop.pendingSubmit.price.text.fontSize=a,e.orderBar.buy.stop.pendingCancel.price.text.fontSize=a,e.orderBar.buy.stop.pendingReplace.price.text.fontSize=a,e.orderBar.buy.stop.submitted.price.text.fontSize=a,e.orderBar.buy.stop.accepted.price.text.fontSize=a,e.orderBar.buy.limit.pendingSubmit.kind.text.fontSize=a,e.orderBar.buy.limit.pendingCancel.kind.text.fontSize=a,e.orderBar.buy.limit.pendingReplace.kind.text.fontSize=a,e.orderBar.buy.limit.submitted.kind.text.fontSize=a,e.orderBar.buy.limit.accepted.kind.text.fontSize=a,e.orderBar.buy.limit.pendingSubmit.quantity.text.fontSize=a,e.orderBar.buy.limit.pendingCancel.quantity.text.fontSize=a,e.orderBar.buy.limit.pendingReplace.quantity.text.fontSize=a,e.orderBar.buy.limit.submitted.quantity.text.fontSize=a,e.orderBar.buy.limit.accepted.quantity.text.fontSize=a,e.orderBar.buy.limit.pendingSubmit.price.text.fontSize=a,e.orderBar.buy.limit.pendingCancel.price.text.fontSize=a,e.orderBar.buy.limit.pendingReplace.price.text.fontSize=a,e.orderBar.buy.limit.submitted.price.text.fontSize=a,e.orderBar.buy.limit.accepted.price.text.fontSize=a,e.orderBar.buy.stopLimit.pendingSubmit.kind.text.fontSize=a,e.orderBar.buy.stopLimit.pendingCancel.kind.text.fontSize=a,e.orderBar.buy.stopLimit.pendingReplace.kind.text.fontSize=a,e.orderBar.buy.stopLimit.submitted.kind.text.fontSize=a,e.orderBar.buy.stopLimit.accepted.kind.text.fontSize=a,e.orderBar.buy.stopLimit.pendingSubmit.quantity.text.fontSize=a,e.orderBar.buy.stopLimit.pendingCancel.quantity.text.fontSize=a,e.orderBar.buy.stopLimit.pendingReplace.quantity.text.fontSize=a,e.orderBar.buy.stopLimit.submitted.quantity.text.fontSize=a,e.orderBar.buy.stopLimit.accepted.quantity.text.fontSize=a,e.orderBar.buy.stopLimit.pendingSubmit.price.text.fontSize=a,e.orderBar.buy.stopLimit.pendingCancel.price.text.fontSize=a,e.orderBar.buy.stopLimit.pendingReplace.price.text.fontSize=a,e.orderBar.buy.stopLimit.submitted.price.text.fontSize=a,e.orderBar.buy.stopLimit.accepted.price.text.fontSize=a,e.orderBar.sell.market.pendingSubmit.kind.text.fontSize=a,e.orderBar.sell.market.pendingCancel.kind.text.fontSize=a,e.orderBar.sell.market.pendingReplace.kind.text.fontSize=a,e.orderBar.sell.market.submitted.kind.text.fontSize=a,e.orderBar.sell.market.accepted.kind.text.fontSize=a,e.orderBar.sell.market.pendingSubmit.quantity.text.fontSize=a,e.orderBar.sell.market.pendingCancel.quantity.text.fontSize=a,e.orderBar.sell.market.pendingReplace.quantity.text.fontSize=a,e.orderBar.sell.market.submitted.quantity.text.fontSize=a,e.orderBar.sell.market.accepted.quantity.text.fontSize=a,e.orderBar.sell.market.pendingSubmit.price.text.fontSize=a,e.orderBar.sell.market.pendingCancel.price.text.fontSize=a,e.orderBar.sell.market.pendingReplace.price.text.fontSize=a,e.orderBar.sell.market.submitted.price.text.fontSize=a,e.orderBar.sell.market.accepted.price.text.fontSize=a,e.orderBar.sell.stop.pendingSubmit.kind.text.fontSize=a,e.orderBar.sell.stop.pendingCancel.kind.text.fontSize=a,e.orderBar.sell.stop.pendingReplace.kind.text.fontSize=a,e.orderBar.sell.stop.submitted.kind.text.fontSize=a,e.orderBar.sell.stop.accepted.kind.text.fontSize=a,e.orderBar.sell.stop.pendingSubmit.quantity.text.fontSize=a,e.orderBar.sell.stop.pendingCancel.quantity.text.fontSize=a,e.orderBar.sell.stop.pendingReplace.quantity.text.fontSize=a,e.orderBar.sell.stop.submitted.quantity.text.fontSize=a,e.orderBar.sell.stop.accepted.quantity.text.fontSize=a,e.orderBar.sell.stop.pendingSubmit.price.text.fontSize=a,e.orderBar.sell.stop.pendingCancel.price.text.fontSize=a,e.orderBar.sell.stop.pendingReplace.price.text.fontSize=a,e.orderBar.sell.stop.submitted.price.text.fontSize=a,e.orderBar.sell.stop.accepted.price.text.fontSize=a,e.orderBar.sell.limit.pendingSubmit.kind.text.fontSize=a,e.orderBar.sell.limit.pendingCancel.kind.text.fontSize=a,e.orderBar.sell.limit.pendingReplace.kind.text.fontSize=a,e.orderBar.sell.limit.submitted.kind.text.fontSize=a,e.orderBar.sell.limit.accepted.kind.text.fontSize=a,e.orderBar.sell.limit.pendingSubmit.quantity.text.fontSize=a,e.orderBar.sell.limit.pendingCancel.quantity.text.fontSize=a,e.orderBar.sell.limit.pendingReplace.quantity.text.fontSize=a,e.orderBar.sell.limit.submitted.quantity.text.fontSize=a,e.orderBar.sell.limit.accepted.quantity.text.fontSize=a,e.orderBar.sell.limit.pendingSubmit.price.text.fontSize=a,e.orderBar.sell.limit.pendingCancel.price.text.fontSize=a,e.orderBar.sell.limit.pendingReplace.price.text.fontSize=a,e.orderBar.sell.limit.submitted.price.text.fontSize=a,e.orderBar.sell.limit.accepted.price.text.fontSize=a,e.orderBar.sell.stopLimit.pendingSubmit.kind.text.fontSize=a,e.orderBar.sell.stopLimit.pendingCancel.kind.text.fontSize=a,e.orderBar.sell.stopLimit.pendingReplace.kind.text.fontSize=a,e.orderBar.sell.stopLimit.submitted.kind.text.fontSize=a,e.orderBar.sell.stopLimit.accepted.kind.text.fontSize=a,e.orderBar.sell.stopLimit.pendingSubmit.quantity.text.fontSize=a,e.orderBar.sell.stopLimit.pendingCancel.quantity.text.fontSize=a,e.orderBar.sell.stopLimit.pendingReplace.quantity.text.fontSize=a,e.orderBar.sell.stopLimit.submitted.quantity.text.fontSize=a,e.orderBar.sell.stopLimit.accepted.quantity.text.fontSize=a,e.orderBar.sell.stopLimit.pendingSubmit.price.text.fontSize=a,e.orderBar.sell.stopLimit.pendingCancel.price.text.fontSize=a,e.orderBar.sell.stopLimit.pendingReplace.price.text.fontSize=a,e.orderBar.sell.stopLimit.submitted.price.text.fontSize=a,e.orderBar.sell.stopLimit.accepted.price.text.fontSize=a,e.positionBar.short.kind.text.fontSize=a,e.positionBar.short.kind.text.fontSize=a,e.positionBar.short.kind.text.fontSize=a,e.positionBar.short.kind.text.fontSize=a,e.positionBar.short.kind.text.fontSize=a,e.positionBar.short.quantity.text.fontSize=a,e.positionBar.short.quantity.text.fontSize=a,e.positionBar.short.quantity.text.fontSize=a,e.positionBar.short.quantity.text.fontSize=a,e.positionBar.short.quantity.text.fontSize=a,e.positionBar.short.price.text.fontSize=a,e.positionBar.short.price.text.fontSize=a,e.positionBar.short.price.text.fontSize=a,e.positionBar.short.price.text.fontSize=a,e.positionBar.short.price.text.fontSize=a,e.positionBar.long.kind.text.fontSize=a,e.positionBar.long.kind.text.fontSize=a,e.positionBar.long.kind.text.fontSize=a,e.positionBar.long.kind.text.fontSize=a,e.positionBar.long.kind.text.fontSize=a,e.positionBar.long.quantity.text.fontSize=a,e.positionBar.long.quantity.text.fontSize=a,e.positionBar.long.quantity.text.fontSize=a,e.positionBar.long.quantity.text.fontSize=a,e.positionBar.long.quantity.text.fontSize=a,e.positionBar.long.price.text.fontSize=a,e.positionBar.long.price.text.fontSize=a,e.positionBar.long.price.text.fontSize=a,e.positionBar.long.price.text.fontSize=a,e.positionBar.long.price.text.fontSize=a;var s=this._fieldTextColor.spectrum("get").toHexString();e.chartPanel.title.fillColor=s,e.valueScale.text.fillColor=s,e.valueScale.valueMarker.text.fillColor=s,e.dateScale.text.fillColor=s,e.dateScale.dateMarker.text.fillColor=s,e.chart.background=[this._fieldGradient1Color.spectrum("get").toRgbString(),this._fieldGradient2Color.spectrum("get").toRgbString()],e.valueScale.fill.fillColor=this._fieldValueScalePanelColor.spectrum("get").toRgbString(),e.dateScale.fill.fillColor=this._fieldDateScalePanelColor.spectrum("get").toRgbString();var l=this._fieldGridColor.spectrum("get").toHexString();return e.chartPanel.grid.strokeColor=l,e.dateScale.line.strokeColor=l,e},c.prototype._apply=function(e){h.JsUtil.isFunction(this._config.done)&&(null==e&&(e=this._getValues()),this._config.done(e))},c.prototype._highlightNewThemeNameInvalid=function(e){e?(this._fieldNewThemeName.addClass(c.CLASS_INVALID_VALUE),this._btnNewThemeConfirm.addClass(c.CLASS_INVALID_VALUE)):(this._fieldNewThemeName.removeClass(c.CLASS_INVALID_VALUE),this._btnNewThemeConfirm.removeClass(c.CLASS_INVALID_VALUE))},c.prototype._initFields=function(){this._dialogBody=this._dialog.find(".scxThemeDialog-body"),this._dialogTitle=this._dialog.find(e+"headerTitle"),this._btnApply=this._dialog.find(a+"save"),this._fieldLineBarColor=this._dialog.find(o+"lineBarColor"),this._fieldUpBarColor=this._dialog.find(o+"upBarColor"),this._fieldDownBarColor=this._dialog.find(o+"downBarColor"),this._labelUpBarBorderColor=this._dialog.find(t+"upBarBorderColor"),this._fieldUpBarBorderColor=this._dialog.find(o+"upBarBorderColor"),this._fieldUpBarBorderEnabled=this._dialog.find(r+"upBarBorderColor"),this._labelDownBarBorderColor=this._dialog.find(t+"downBarBorderColor"),this._fieldDownBarBorderColor=this._dialog.find(o+"downBarBorderColor"),this._fieldDownBarBorderEnabled=this._dialog.find(r+"downBarBorderColor"),this._fieldWickColor=this._dialog.find(o+"wickColor"),this._fieldTextFont=this._dialog.find(o+"textFont"),this._fieldTextSize=this._dialog.find(o+"textSize"),this._fieldTextColor=this._dialog.find(o+"textColor"),this._fieldGradient1Color=this._dialog.find(o+"gradient1Color"),this._fieldGradient2Color=this._dialog.find(o+"gradient2Color"),this._fieldValueScalePanelColor=this._dialog.find(o+"valueScalePanelColor"),this._fieldDateScalePanelColor=this._dialog.find(o+"dateScalePanelColor"),this._fieldGridColor=this._dialog.find(o+"gridColor"),this._fieldTheme=this._dialog.find(o+"theme"),this._wrapperTheme=this._dialog.find("#scxThemeDialog_newThemeWrapper"),this._btnNewTheme=this._dialog.find(a+"newTheme"),this._btnNewThemeConfirm=this._dialog.find(a+"newThemeConfirm"),this._fieldNewThemeName=this._dialog.find(o+"newThemeName"),this._btnSaveTheme=this._dialog.find(a+"saveTheme")},c.CLASS_INVALID_VALUE="scxInvalidValue",c.CLASS_BTN_PRIMARY="btn-primary",c.CLASS_BTN_DEFAULT="btn-default",c._switcherySettings={color:"rgba(72, 149, 245, 0.2)",secondaryColor:"rgba(16, 17, 20, 1)",jackColor:"rgba(72, 149, 245, 1)",jackSecondaryColor:"rgba(81, 83, 90, 1)",className:"scx_switchery",disabled:!1,disabledOpacity:.5,speed:"0.4s"},c);function c(e){var t=n.call(this,e)||this;return t._initFields(),t._init(),t}i.ThemeDialog=l}(h.UI||(h.UI={}))}(StockChartX=StockChartX||{});__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}();!function(r){!function(e){"use strict";var i,t="#scxCompareInstrument_",n=(i=e.Dialog,__extends(o,i),o.prototype.show=function(e){this.initDialog(e)&&(i.prototype.show.call(this,e),this._setValues())},o.prototype._init=function(){var t=this;this._btnAdd.on("click",function(){t._add()}),this._instrumentSearch=this._dialogInput.scx().instrumentSearch({onChange:function(e){t._handleInstrumentChange(e)}}),this._dialog.find(".scxSpectrum").scx().colorPicker({containerClassName:"scxSpectrumDrawingDialog",localStorageKey:"scxThemeDialog_spectrum",showAlpha:!0})},o.prototype._add=function(){var e,t=this._config.chart;this._getValues(),this._setValues(),this._compareInstrument&&(e=this._compareInstrument.symbol,t.instrumentComparisonHandler.compare({symbol:e},null,this._instrumentTheme))},o.prototype._handleInstrumentChange=function(e){this._compareInstrument=e||null},o.prototype._setValues=function(){var t=this,e=this._config.chart;this._instrumentSearch._config.chart=this._config.chart,this._compareInstrument?this._dialogInput.val(this._compareInstrument.symbol):(this._dialogInput.val(e.instrument.symbol),this._compareInstrument=e.instrument),this._lineColorInput.spectrum("set","red"),this._lineStyleInput.selectpicker({container:"body"}),this._lineStyleInput.selectpicker("val",r.LineStyle.SOLID).selectpicker("refresh"),this._lineWidthInput.scxNumericField(this._numericFieldConfig),r.Localization.localizeText(e,"compareInstrument.selectInstrument").then(function(e){t._dialogInput.attr("title",e)}),e.localize(this._dialog)},o.prototype._getValues=function(){this._instrumentTheme.lineColor=this._lineColorInput.spectrum("get").toRgbString(),this._instrumentTheme.lineWidth=this._lineWidthInput.val(),this._instrumentTheme.lineStyle=this._lineStyleInput.val()},o.prototype._initFields=function(){this._dialogInput=this._dialog.find(t+"symbol"),this._lineColorInput=this._dialog.find(t+"lineColor"),this._lineWidthInput=this._dialog.find(t+"lineWidth"),this._lineStyleInput=this._dialog.find(t+"lineStyle"),this._btnAdd=this._dialog.find(t+"btn_add")},o);function o(e){var t=i.call(this,e)||this;return t._instrumentTheme={},t._numericFieldConfig={showArrows:!1,maxValue:10,minValue:1,value:1},t._initFields(),t._init(),t}e.CompareInstrumentDialog=n}(r.UI||(r.UI={}))}(StockChartX=StockChartX||{}),function(p){!function(a){"use strict";var h="active",s="hover",d="scxLeft",_="scxRight",o="data-scxUnits",u={LEFT:0,RIGHT:1},i={interval:1,periodicity:p.Periodicity.DAY};Object.freeze(u);var l=".scxTimeFramePicker",e=(Object.defineProperty(c.prototype,"chart",{get:function(){return this._config.chart},set:function(e){e||(this._isActive&&this._hideDropDown(),this._unsubscribe()),this._config.chart=e},enumerable:!0,configurable:!0}),c.prototype.set=function(e){this._setValue(e)},c.prototype._init=function(){var i=this;if(this._domObjects=c._getDomObjects(this._rootDomElement),this._btnWrapper=this._rootDomElement.find(".scxToolbarButton-buttonWrapper"),a.HtmlContainer.instance.register("TimeFramePicker",this._domObjects.dropdown.wrapper),this._hasCustomPicker=0<this._domObjects.dropdown.customValueWrapper.length,this._rootDomElement.addClass("activated"),this._rootDomElement.hover(function(){i._btnWrapper.addClass(s)},function(){i._btnWrapper.removeClass(s)}),this._domObjects.dropdown.inputInterval.scxNumericField({showArrows:!1,minValue:1,value:1}).keyup(function(e){13===e.which&&i._getPickerIntervalValue()&&i._hideDropDown()}),!this._domObjects.dropdown.inputPeriodicity.children().length){var e,t=this._selectDistinctPredefinedPeriodicities(),n=[];for(var o in p.Periodicity){p.Periodicity.hasOwnProperty(o)&&0<=t.indexOf(p.Periodicity[o])&&(e=p.TimeFrame.periodicityToString(p.Periodicity[o]),n.push($('<option value="'+p.Periodicity[o]+'">'+e+"</option>")))}this._domObjects.dropdown.inputPeriodicity.empty().append(n)}this._domObjects.dropdown.inputPeriodicity.selectpicker({container:"body"}),this._domObjects.head.dropdownToggler.click(function(e){i._toggleDropDown(),$(e.currentTarget).blur()}),this._domObjects.head.activator.click(function(){i._domObjects.head.dropdownToggler.click()}),$(window).on(["scroll","resize",""].join(l+" "),function(){i._hideDropDown()});var r=$("body");r.on(p.MouseEvent.CLICK+l,function(e){i._isActive&&!$(e.target).parents().hasClass(i._rootDomElement.attr("class"))&&0===$(e.target).parents(".scxTimeFramePickerDropDown").length&&0===$(e.target).parents(".scxTimeFramePicker-CustomValueUnits").length&&i._hideDropDown()}),r.on("touchstart"+l,function(e){i._isActive&&!$(e.target).parents().hasClass(i._rootDomElement.attr("class"))&&0===$(e.target).parents(".scxTimeFramePickerDropDown").length&&0===$(e.target).parents(".scxTimeFramePicker-CustomValueUnits").length&&i._hideDropDown()}),this._domObjects.predefinedItems.click(function(e){i._setPredefinedValue($(e.currentTarget).index())}),this._hasCustomPicker&&(p.Environment.isMobile?(this._hasCustomPicker=!1,this._domObjects.dropdown.customValueWrapper.remove()):(this._domObjects.dropdown.btnPlus.click(function(e){i._domObjects.predefinedItems.removeClass(h),$(e.currentTarget).blur(),i._domObjects.dropdown.inputInterval.scxNumericField("setValue",i._getPickerIntervalValue()+1)}),this._domObjects.dropdown.btnMinus.click(function(e){i._domObjects.predefinedItems.removeClass(h),$(e.currentTarget).blur();var t=i._getPickerIntervalValue();1<t&&i._domObjects.dropdown.inputInterval.scxNumericField("setValue",t-1)}))),$(".scxTimeFramePicker-CustomValueUnits").click(function(){i._domObjects.predefinedItems.removeClass(h)}),this._setValue(this._config.timeFrame)},c.prototype._setValue=function(e){this._domObjects.predefinedItems.removeClass(h),this._last=e,this._setCustomPickerValues(),this._setLabels(),this._hideDropDown()},c.prototype._setPredefinedValue=function(e){var t=this._domObjects.predefinedItems.eq(e);this._activateItem(t),this._last=c._extractDataFromItem(t),this._setCustomPickerValues(),this._setLabels(),this._hideDropDown(),this._fire()},c._extractDataFromItem=function(e){return new p.TimeFrame(e.attr(o),parseInt(e.attr("data-scxValue"),10))},c.prototype._activateItem=function(e){this._domObjects.predefinedItems.removeClass(h),e.addClass(h)},c.prototype._setLabels=function(){this._domObjects.head.labelInterval.text(this._last.interval);var e=this._last.periodicity;this.chart&&(this._domObjects.head.labelPeriodicity.attr("data-i18n","timeFrame.periodicity."+e),this.chart.localize(this._domObjects.head.labelPeriodicity))},c.prototype._setCustomPickerValues=function(){this._hasCustomPicker&&(this._domObjects.dropdown.inputInterval.scxNumericField("setValue",this._last.interval),this._domObjects.dropdown.inputPeriodicity.selectpicker("val",this._last.periodicity).selectpicker("refresh"))},c.prototype._toggleDropDown=function(){this._isActive?this._hideDropDown():this._showDropDown()},c.prototype._showDropDown=function(){this._isActive=!0;var e=this._rootDomElement.addClass(h),t=this._domObjects.dropdown.wrapper,i=this._domObjects.dropdown.container,n=window.innerWidth,o=window.innerHeight-1,r={top:e.offset().top-$(window).scrollTop(),left:e.offset().left-$(window).scrollLeft()};i.css({width:"auto",height:"auto"}),t.css({top:0,left:0,right:"auto"}).show();var a=t.outerWidth(!0),s=t.outerHeight(!0);t.hide();var l=n<r.left+a&&n-r.left<r.left+e.outerWidth(!0)?u.LEFT:u.RIGHT,c={top:r.top+e.outerHeight(!0)-parseInt(e.css("margin-bottom"),10),left:null,right:null};switch(o-s<s&&(o<s&&(s=o/2),s=o-(o-s),a+=20),l){case u.RIGHT:c.left=r.left,c.right="auto",t.removeClass(d).addClass(_),a>n-c.left&&(a=n-c.left-2);break;case u.LEFT:c.left="auto",c.right=n-r.left-e.outerWidth(!0),t.removeClass(_).addClass(d),a>n-c.right&&(a=n-c.right-2,c.left=0)}i.outerWidth(a).outerHeight(s),t.css(c).show()},c.prototype._hideDropDown=function(){this._domObjects.dropdown.wrapper.hide(),this._rootDomElement.removeClass(h),this._btnWrapper.removeClass(s),this._isActive=!1,this._synchronizeWithCustomPicker(),$(".scxTimeFramePicker-CustomValueUnits").removeClass("open")},c.prototype._synchronizeWithCustomPicker=function(){var e,t;this._hasCustomPicker&&(e=this._getPickerIntervalValue(),t=this._domObjects.dropdown.inputPeriodicity.selectpicker("val"),e===this._last.interval&&t===this._last.periodicity||(this._last=new p.TimeFrame(t,e),this._setLabels(),this._fire()))},c.prototype._fire=function(){"function"==typeof this._config.selectionChanged&&this._config.selectionChanged(this._last),this.chart.localize(this._domObjects.dropdown.customValueWrapper)},c.prototype._getPickerIntervalValue=function(){var e=$("<div></div>").text(this._domObjects.dropdown.inputInterval.scxNumericField("getValue")).html();return parseInt(e,10)},c.prototype._selectDistinctPredefinedPeriodicities=function(){var i,n=[];return this._domObjects.predefinedItems.each(function(e,t){i=$(t).attr(o).toLowerCase();try{p.TimeFrame.periodicityToString(i)}catch(e){i=null}null!==i&&n.indexOf(i)<0&&n.push(i)}),n},c._getDomObjects=function(e){return{head:{activator:e.find(".scxToolbarButton-activateBtn"),dropdownToggler:e.find(".scxToolbarButton-toggleDropdownBtn"),labelInterval:e.find(".scxTimeFramePicker-button-value"),labelPeriodicity:e.find(".scxTimeFramePicker-button-units")},dropdown:{wrapper:e.find(".scxTimeFramePickerDropDown"),container:e.find(".scxTimeFramePicker-dropdownContainer"),customValueWrapper:e.find(".scxTimeFramePicker-CustomValueWrapper"),btnPlus:e.find(".scxTimeFramePicker-CustomValuePlus"),btnMinus:e.find(".scxTimeFramePicker-CustomValueMinus"),inputInterval:e.find(".scxTimeFramePicker-CustomValueText"),inputPeriodicity:e.find(".scxTimeFramePicker-CustomValueUnits")},predefinedItems:e.find(".scxToolbarButton-dropdownElement")}},c.prototype._unsubscribe=function(){$("*").off(l)},c);function c(e,t){this._isActive=!1,this._hasCustomPicker=!1,this._last=new p.TimeFrame(p.Periodicity.MINUTE,1),t.timeFrame||(t.timeFrame=t.chart&&t.chart.timeFrame||i),this._rootDomElement=e,this._config=t,this._init()}a.TimeFramePicker=e}(p.UI||(p.UI={}))}(StockChartX=StockChartX||{}),function(h){!function(c){"use strict";var e=".scxToolbar",o="toggleFullWindow",r="toggleFullScreen",t=(Object.defineProperty(i.prototype,"chart",{get:function(){return this._chart},set:function(e){this._chart!==e&&(this._unsubscribeEvents(),this._chart=e,this._subscribeEvents(),this._updateForNewChart(),this._chart&&this._chart.localize())},enumerable:!0,configurable:!0}),i.prototype._init=function(e,t){var i,n,o,r,a,s=this,l=this.chart=t.chart;l.container&&(this._container=$(e).prependTo(t.parent),i=this._container,n=this._controls={},h.Environment.isPhone&&this._container.addClass("scxPhone"),r=(o=this._container.find(".scxToolbar")).parent().parent(),this._toolbarScroll=new c.ToolbarScroll(this,o,r),this._toolbarScroll.resize(),$(window).resize(function(){s._toolbarScroll.resize()}),n.instrument=i.find(".symbolSearch").scx().instrumentSearch({chart:this._chart,onChange:function(e){s._handleInstrumentChange(e)}}),n.timeFrame=i.find(".scxTimeFramePicker").scx().timeFramePicker({selectionChanged:function(e){s._handleTimeFrameChange(e)}}),n.indicators=i.find(".scxToolbarIndicators").scx().toolbarDropDownButton({chart:this.chart,selectionChanged:function(e,t){s._handleIndicatorsClick(e,t)}}),i.find(".scxToolbar-btn-theme").on("click",function(e){$(e.target).removeClass("hover"),s._handleThemeClick()}),n.priceStyle=i.find(".scxToolbarBarStyle").scx().toolbarDropDownButton({chart:this.chart,selectionChanged:function(e,t){s._handlePriceStyleChange(e,t)}}),i.find(".scxToolbar-btn-compareInstrument").on("click",function(e){$(e.target).removeClass("hover"),s._handleCompareInstrumentClick()}),n.crossHair=i.find(".scxToolbarCrossHair").scx().toolbarDropDownButton({chart:this.chart,selectionChanged:function(e,t){s._handleCrossHairChange(e,t)}}),n.drawings=i.find(".scxToolbarDrawings").scx().toolbarDropDownButton({chart:this.chart,selectionChanged:function(e,t){s._handleDrawingClick(e,t)}}),n.zoomIn=i.find(".scxToolbarZoomIn").scx().toolbarDropDownButton({chart:this.chart,selectionChanged:function(e,t){s._handleZoomInClick(e,t)}}),n.hideDrawings=i.find(".scxToolbar-btn-hideDrawings").scx().toolbarDropDownButton({chart:this.chart,selectionChanged:function(e,t){s._handleHideDrawingsClick(t)}}),n.stayInDrawingMode=i.find(".scxToolbar-btn-stayInDrawingMode").scx().toolbarDropDownButton({chart:this.chart,selectionChanged:function(e,t){s._handleDrawingModeClick(t)}}),i.find(".scxToolbarSaveImage").on("click",function(e){$(e.target).removeClass("hover"),s._handleSaveImageClick()}),a=i.find(".scxToolbarViewMode"),!1===t.showViewMode?a.remove():h.Environment.isMobile||h.Environment.isPhone?a.on("click",function(){s._handleViewModeChange("toggleFullWindow",!1)}).removeClass("scxToolbarButtonWithDropdown"):a.scx().toolbarDropDownButton({chart:this.chart,selectionChanged:function(e,t){s._handleViewModeChange(e,t)}}),l&&l.fireValueChanged(h.ChartEvent.TOOLBAR_LOADED,this),this._updateForNewChart())},i.prototype.prependTo=function(e){e&&(this._container.detach(),this._container=this._container.prependTo(e))},i.prototype._subscribeEvents=function(){var t=this,i=this.chart;i&&i.on(h.ChartEvent.INSTRUMENT_CHANGED+e,function(e){t._controls.instrument.set(e.value)}).on(h.ChartEvent.TIME_INTERVAL_CHANGED+e,function(e){t._controls.timeFrame.set(e.value)}).on(h.ChartEvent.PRICE_STYLE_CHANGED+e,function(){var e=t.chart&&t.chart.priceStyle;e&&(e instanceof h.HLBarPriceStyle||e instanceof h.HLCBarPriceStyle||e instanceof h.ColoredHLBarPriceStyle||e instanceof h.ColoredHLCBarPriceStyle||t._controls.priceStyle.selectItem(t.chart.priceStyleKind,!1))}).on(h.ChartEvent.CROSS_HAIR_CHANGED+e,function(){t._controls.crossHair.selectItem(t.chart.crossHairType,!1)}).on(h.ChartEvent.ZOOM_IN_FINISHED+e+" "+h.ChartEvent.ZOOM_IN_CANCELLED+e,function(){t._controls.zoomIn.deactivate()}).on([h.ChartEvent.USER_DRAWING_FINISHED,h.ChartEvent.USER_DRAWING_CANCELLED,""].join(e+" "),function(){var e=t._controls;i.stayInDrawingMode||e.drawings.deactivate()}).on(h.ChartEvent.STATE_LOADED+e,function(){t._controls.priceStyle.selectItem(t.chart.priceStyleKind,!1),t._controls.crossHair.selectItem(t.chart.crossHairType,!1)})},i.prototype._unsubscribeEvents=function(){this._chart&&(this._chart.cancelUserDrawing(),this._chart.cancelZoomIn(),this._chart.off(e))},i.prototype._updateForNewChart=function(){var e=this.chart,t=this._controls;if(t){for(var i in t)t.hasOwnProperty(i)&&t[i]instanceof c.ToolbarDropDownButton&&(t[i].chart=e,"hideDrawings"!==i&&"stayInDrawingMode"!==i&&t[i].deactivate());(t.timeFrame.chart=e)&&(t.instrument.set(e.instrument),t.timeFrame.chart=e,t.timeFrame.set(e.timeFrame),t.priceStyle.selectItem(e.priceStyleKind,!1),t.crossHair.selectItem(e.crossHairType,!1),e.showDrawings?t.hideDrawings.deactivate():t.hideDrawings.activate(),e.stayInDrawingMode?t.stayInDrawingMode.activate():t.stayInDrawingMode.deactivate(),e.windowMode!==h.WindowMode.FULL_WINDOW&&e.windowMode!==h.WindowMode.FULL_SCREEN||e.windowModeHandler.adjustFullWindowSize())}},i.prototype._handleInstrumentChange=function(e){var t,i,n;!e||(t=this.chart)&&(i=t.instrument&&t.instrument.symbol.toUpperCase(),(n=e.symbol.toUpperCase())!==t.instrument.symbol&&(t.fireValueChanged(h.ChartEvent.SYMBOL_ENTERED,e),n!==i&&(t.instrument=e,t.sendBarsRequest())))},i.prototype._handleTimeFrameChange=function(e){var t=this.chart;t&&(t.timeFrame=e,t.sendBarsRequest(),t.fireValueChanged(h.ChartEvent.TIME_FRAME_CHANGED,e))},i.prototype._indicatorsDialog=function(){var o=this;c.ViewLoader.indicatorsDialog(function(e){e.show({chart:o.chart,done:function(e){var t,i=o.chart,n=c.IndicatorsDialog.showSettingsBeforeAdding;i&&(t=h.Indicator.deserialize({className:e,chart:i}),i.addIndicators(t),n&&t.showSettingsDialog(),i.update())}})})},i.prototype._handleThemeClick=function(){var i=this;c.ViewLoader.themeDialog(function(e){e.show({chart:i.chart,theme:i.chart.theme,done:function(e){var t=i.chart;t&&(h.Theme[e.name]=t.theme=e,t.setNeedsUpdate())}})})},i.prototype._handleCompareInstrumentClick=function(){var t=this;c.ViewLoader.compareInstrumentDialog(function(e){e.show({chart:t.chart,done:function(){var e=t.chart;e&&e.setNeedsUpdate()}})})},i.prototype._handlePriceStyleChange=function(e,t){var i=this.chart;i&&t&&e&&(i.priceStyleKind=e,i.setNeedsUpdate())},i.prototype._handleCrossHairChange=function(e,t){var i=this.chart;i&&t&&e&&(i.crossHairType=e)},i.prototype._handleDrawingClick=function(e,t){var i,n=this.chart;if(n)return t&&"deleteAllDrawings"===e?(n.removeDrawings(),void n.setNeedsUpdate(!0)):void(t?t&&e&&(i=h.Drawing.deserialize({className:e}),n.startUserDrawing(i)):n.cancelUserDrawing())},i.prototype._handleZoomInClick=function(e,t){var i=this.chart;i&&(t?e&&t&&i.startZoomIn(e):i.cancelZoomIn())},i.prototype._handleHideDrawingsClick=function(e){var t=this.chart;t&&(t.showDrawings=!e,t.setNeedsUpdate())},i.prototype._handleDrawingModeClick=function(e){var t=this.chart;t&&((t.stayInDrawingMode=e)||t.cancelUserDrawing())},i.prototype._handleIndicatorsClick=function(e,t){var i=this.chart;i&&("indicators"===e&&this._indicatorsDialog(),t&&"deleteAllIndicators"===e&&(i.removeIndicators(),i.setNeedsUpdate(!0)))},i.prototype._handleSaveImageClick=function(){var e=this.chart;e&&e.saveImage()},i.prototype._handleViewModeChange=function(e,t){var i=this.chart;if(i){var n=i.windowMode;switch(e){case o:switch(n){case h.WindowMode.NORMAL:case h.WindowMode.FULL_SCREEN:i.setWindowMode(h.WindowMode.FULL_WINDOW),this._toolbarScroll.resize();break;case h.WindowMode.FULL_WINDOW:i.setWindowMode(h.WindowMode.NORMAL),this._toolbarScroll.resize();break;default:throw new Error("Unknown window mode.")}break;case r:if(t)switch(n){case h.WindowMode.NORMAL:case h.WindowMode.FULL_WINDOW:i.setWindowMode(h.WindowMode.FULL_SCREEN);break;case h.WindowMode.FULL_SCREEN:i.setWindowMode(i.windowModeHandler.prevMode);break;default:throw new Error("Unknown window mode.")}}}},i);function i(t){var i=this;c.HtmlLoader.loadHtml("Toolbar.html",function(e){i._init(e,t)})}c.Toolbar=t}(h.UI||(h.UI={}))}(StockChartX=StockChartX||{}),function(e){!function(e){"use strict";var t="scxContextMenuOpen",n="scxToolbarButton-anotherButtonActivated",u="scxToolbarButton-anotherDropdownActivated",p=".scxToolbar-multiDropdown",o="data-scxValue",f="active",i="activated",r="hover",m="scxLeft",g="scxRight",b={LEFT:0,RIGHT:1};Object.freeze(b);var a=(Object.defineProperty(s.prototype,"chart",{get:function(){return this._config.chart},set:function(e){this._config.chart=e},enumerable:!0,configurable:!0}),s.prototype.selectItem=function(e,t){this._setValue(e,t)},s.prototype.deactivate=function(){this._deactivateButton()},s.prototype.activate=function(){this._activateButton()},s.prototype._init=function(){var i=this;this._btnWrapper=this._rootElement.find(".scxToolbarButton-buttonWrapper"),this._btnActivate=this._rootElement.find(".scxToolbarButton-activateBtn"),this._btn_toggleDropDown=this._rootElement.find(".scxToolbarButton-toggleDropdownBtn"),this._itemsWrapper=this._rootElement.find(".scxToolbarButton-dropdownWrapper"),this._itemsContainer=this._rootElement.find(".scxToolbarButton-dropdownElementsContainer"),this._items=this._rootElement.find(".scxToolbarButton-dropdownElement"),this._multiDropDownElement=this._rootElement.find(".scxToolbarButton-multiDropDownElement"),e.HtmlContainer.instance.register("scxToolbarButton-dropdownWrapper",this._itemsWrapper,!1),this._canToggle=this._rootElement.hasClass("scxToolbarCanToggle"),this._canFireFromHead=this._rootElement.hasClass("scxToolbarCanFireFromHead"),this._rootElement.hasClass("scxToolbarButtonWithDropdown")&&0<this._btn_toggleDropDown.length&&0<this._items.length&&(this._hasChildren=!0),this._btnWrapper.on("click",function(e){var t=$(e.target);t.is(i._btnActivate)?(i._btnWrapper.removeClass(r),i._canToggle?i._toggleButton(e):i._canFireFromHead?i._fireFromHead():!i._hasChildren||i._canToggle||i._canFireFromHead||i._toggleDropDown()):(t.is(i._btn_toggleDropDown)||i._hasChildren)&&i._toggleDropDown()}),this._btnWrapper.hover(function(){i._btnWrapper.addClass(r)},function(){i._btnWrapper.removeClass(r)}),this._multiDropDownElement.hover(function(e){i._showMultiDropDown($(e.target).find(p))}),this._btnActivate.focus(function(e){$(e.currentTarget).blur()}),this._body.on(n,function(e,t){0===$(e.target).parent().find(p).length&&(i._triggerActiveButton(t.button,t.chart),i._hideDropDown())}),this._hasChildren&&(this._itemsWrapper.hide().addClass(this._rootElement.attr("data-type")).appendTo(e.HtmlContainer.instance.componentsContainer),this._body.bind([u,t].join(" "),function(){i._hideDropDown(),i._deactivateButton()}),this._canFireFromHead||this._btnActivate.attr(o,this._items.first().attr(o)),this._btn_toggleDropDown.focus(function(e){$(e.currentTarget).blur()}),this._body.on("click",function(e){i._isActive&&!$(e.target).parents().hasClass(i._rootElement.attr("class"))&&0===$(e.target).parent().find(p).length&&i._hideDropDown()}),this._body.on("touchstart",function(e){i._isActive&&!$(e.target).parents().hasClass(i._rootElement.attr("class"))&&i._hideDropDown()}),this._items.on("click touchstart",function(e){var t=$(e.currentTarget).attr(o);t&&i._setValue(t)}),this._config.selectedItem&&this._setValue(this._config.selectedItem),$(window).on("scroll resize",function(){i._hideDropDown()}))},s.prototype._setValue=function(e,t){this._deactivateButton(t),this._items.removeClass(f),this._canFireFromHead||("deleteAllDrawings"!==e&&this._items.parent().find("["+o+'="'+e+'"]').addClass(f),this._btnActivate.attr(o,e)),this._activateButton(t,e),0===$(this._items.parent().find(p)).length&&this._hideDropDown()},s.prototype._triggerActiveButton=function(e,t){this.chart===t&&-1===$(e).index(".scxToolbar-btn-stayInDrawingMode")&&(this._rootElement.hasClass("scxToolbarButtonManuallySwitchable")||!$(e).is(this._btnActivate)&&this._canToggle&&this._deactivateButton())},s.prototype._activateButton=function(e,t){this._isActivated=!0,this._canToggle&&("deleteAllDrawings"!==t&&this._rootElement.addClass(i),0===this._itemsWrapper.find(p).length&&this._itemsWrapper.addClass(i),this._body.trigger(n,{button:this._btnActivate,chart:this.chart})),this._canFireFromHead?this._config.selectionChanged(t,this._isActivated):!1!==e&&this._config.selectionChanged&&this._config.selectionChanged(this._btnActivate.attr(o),this._isActivated)},s.prototype._deactivateButton=function(e){this._isActivated&&(this._isActivated=!1,this._canToggle&&(this._rootElement.removeClass(i),this._itemsWrapper.removeClass(i)),!1!==e&&this._config.selectionChanged&&!this._canFireFromHead&&this._config.selectionChanged(this._btnActivate.attr(o),this._isActivated))},s.prototype._toggleButton=function(e){this._isActivated?this._deactivateButton():this._activateButton()},s.prototype._fireFromHead=function(){var e;this._isActive?this._hideDropDown():(e=this._btnActivate.attr(o),this._config.selectionChanged(e))},s.prototype._showDropDown=function(){this._body.trigger(u),this._isActive=!0;var e=this._rootElement.addClass(f),t=this._itemsWrapper,i=this._itemsContainer,n=t.find(p),o=window.innerWidth,r=window.innerHeight-1,a={top:e.offset().top-$(window).scrollTop(),left:e.offset().left-$(window).scrollLeft()};i.css({width:"auto",height:"auto"}),t.css({top:0,left:0}).removeClass("visible").show();var s=t.outerWidth(!0)+15,l=t.outerHeight(!0);t.hide().addClass("visible");var c=n.outerWidth()?n.outerWidth():0,h=o<a.left+s+c&&o-a.left-c<a.left+e.outerWidth(!0)?b.LEFT:b.RIGHT,d={top:a.top+e.outerHeight(!0)-parseInt(e.css("margin-bottom"),10),left:null};switch(l>r-d.top&&(l=r-d.top),h){case b.RIGHT:d.left=a.left,t.removeClass(m).addClass(g),t.removeClass(m).addClass(g),n.css("right","inherit"),n.css("left",s),s>o-d.left&&(s=o-d.left);break;case b.LEFT:var _=a.left+e.outerWidth(!0);d.left=_-s-2,t.removeClass(g).addClass(m),n.css("left","inherit"),n.css("right",s),_<s&&(s=_-2,d.left=0)}i.outerWidth(s).outerHeight(l),t.css(d).show()},s.prototype._showMultiDropDown=function(e){var t,i,n;0!==e.length&&(t=e.outerHeight(),i=e.offset().top,(n=window.innerHeight-1)<t+i?e.outerHeight(n-i):e.outerHeight("auto"))},s.prototype._hideDropDown=function(){this._itemsWrapper.hide(),this._rootElement.removeClass(f),this._btnWrapper.removeClass(r),this._isActive=!1},s.prototype._toggleDropDown=function(){this._isActive?this._hideDropDown():this._showDropDown()},s);function s(e,t){this._canToggle=!0,this._hasChildren=!1,this._isActivated=!1,this._isActive=!1,this._config=t,this._rootElement=e,this._body=$("body"),this._init()}e.ToolbarDropDownButton=a}(e.UI||(e.UI={}))}(StockChartX=StockChartX||{}),function(n){!function(s){"use strict";var t={DRAWING_DIALOG:"DrawingSettingsDialog.html",FIBONACCI_DRAWING_DIALOG:"FibonacciDrawingSettingsDialog.html",ICHIMOKU_INDICATOR_DIALOG:"IchimokuIndicatorSettingsDialog.html",INDICATOR_INFO_DIALOG:"IndicatorInfoDialog.html",INDICATORS_DIALOG:"IndicatorsDialog.html",INDICATOR_DIALOG:"IndicatorSettingsDialog.html",PRICE_STYLE_DIALOG:"PriceStyleSettingsDialog.html",DARVAS_BOX_DIALOG:"DarvasBoxSettingsDialog.html",THEME_DIALOG:"ThemeDialog.html",TOOLTIP_VIEW:"TooltipView.html",ORDER_DIALOG:"OrderDialog.html",CCOMPARE_INSTRUMENT_DIALOG:"CompareInstrumentDialog.html"};Object.freeze(t);var e=(i._initView=function(n,o,r){var a=this;s.HtmlLoader.loadHtml(n,function(e){var t=s.HtmlContainer.instance.register(n,e),i=new o(t);a._views.add(n,i),a._invokeOnLoad(r,i)})},i._loadView=function(e,t,i){var n=this._views.get(e);n?this._invokeOnLoad(i,n):this._initView(e,t,i)},i._invokeOnLoad=function(e,t){n.JsUtil.isFunction(e)&&e(t)},i.drawingSettingsDialog=function(e){this._loadView(t.DRAWING_DIALOG,s.DrawingSettingsDialog,e)},i.fibonacciDrawingSettingsDialog=function(e){this._loadView(t.FIBONACCI_DRAWING_DIALOG,s.FibonacciDrawingSettingsDialog,e)},i.indicatorInfoDialog=function(e){this._loadView(t.INDICATOR_INFO_DIALOG,s.IndicatorInfoDialog,e)},i.indicatorsDialog=function(e){this._loadView(t.INDICATORS_DIALOG,s.IndicatorsDialog,e)},i.indicatorSettingsDialog=function(e){this._loadView(t.INDICATOR_DIALOG,s.IndicatorSettingsDialog,e)},i.priceStyleSettingsDialog=function(e){this._loadView(t.PRICE_STYLE_DIALOG,s.PriceStyleSettingsDialog,e)},i.themeDialog=function(e){this._loadView(t.THEME_DIALOG,s.ThemeDialog,e)},i.compareInstrumentDialog=function(e){this._loadView(t.CCOMPARE_INSTRUMENT_DIALOG,s.CompareInstrumentDialog,e)},i.tooltipView=function(e){this._loadView(t.TOOLTIP_VIEW,s.TooltipView,e)},i.orderDialog=function(e){this._loadView(t.ORDER_DIALOG,s.OrderDialog,e)},i._views=new n.Dictionary,i);function i(){}s.ViewLoader=e}(n.UI||(n.UI={}))}(StockChartX=StockChartX||{}),function(e){!function(e){"use strict";var i=jQuery,n="scxWaitingBarContainer",o="scxWaitingBarText",r="scxDotsContainer",a="scxWaitingBarDot",t=(s.prototype.show=function(e){this._isShown||(this._isShown=!0,this._config=i.extend({dotsCount:7},e),this._createDom(),this._container.show())},s.prototype.hide=function(e){(e||this._isShown)&&(this._isShown=!1,this.destroy())},s.prototype._createDom=function(){this._container=i('<div class="'+n+'"></div>').appendTo(this._parentContainer),i('<span class="'+o+'">Loading</span>').appendTo(this._container);for(var e=i('<div class="'+r+'"></div>').appendTo(this._container),t=0;t<this._config.dotsCount;t++)e.append(i('<div class="'+a+'"></div>'))},s.prototype.destroy=function(){this._container&&(this._container.remove(),this._container=null)},s);function s(e){this._isShown=!1,this._parentContainer=e}e.WaitingBar=t}(e.UI||(e.UI={}))}(StockChartX=StockChartX||{});__awaiter=this&&this.__awaiter||function(r,a,s,l){return new(s=s||Promise)(function(e,t){function i(e){try{o(l.next(e))}catch(e){t(e)}}function n(e){try{o(l.throw(e))}catch(e){t(e)}}function o(t){t.done?e(t.value):new s(function(e){e(t.value)}).then(i,n)}o((l=l.apply(r,a||[])).next())})},__generator=this&&this.__generator||function(i,n){var o,r,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,r&&(a=r[2&t[0]?"return":t[0]?"throw":"next"])&&!(a=a.call(r,t[1])).done)return a;switch(r=0,a&&(t=[0,a.value]),t[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,r=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=n.call(i,s)}catch(e){t=[6,e],r=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}};!function(o){!function(e){"use strict";var t=(i.warning=function(t,i,n){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return n||!i?[3,2]:[4,o.Localization.localizeText(i,"notification.kind.error")];case 1:n=e.sent(),e.label=2;case 2:return n||i?[3,4]:[4,o.Localization.localizeText(null,"notification.kind.warning")];case 3:n=e.sent(),e.label=4;case 4:return toastr.warning(t,n,this._options),[2]}})})},i.error=function(t,i,n){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return n||!i?[3,2]:[4,o.Localization.localizeText(i,"notification.kind.error")];case 1:n=e.sent(),e.label=2;case 2:return n||i?[3,4]:[4,o.Localization.localizeText(null,"notification.kind.error")];case 3:n=e.sent(),e.label=4;case 4:return toastr.error(t,n,this._options),[2]}})})},i.success=function(t,i,n){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return n||!t?[3,2]:[4,o.Localization.localizeText(t,"notification.kind.success")];case 1:n=e.sent(),e.label=2;case 2:return n||t?[3,4]:[4,o.Localization.localizeText(null,"notification.kind.success")];case 3:n=e.sent(),e.label=4;case 4:return toastr.success(i,n,this._options),[2]}})})},i.info=function(t,i){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return i?[3,2]:[4,o.Localization.localizeText(null,"notification.kind.info")];case 1:i=e.sent(),e.label=2;case 2:return toastr.info(t,i,this._options),[2]}})})},i._options={closeButton:!0,debug:!1,newestOnTop:!1,progressBar:!1,positionClass:"toast-top-right",preventDuplicates:!1,onclick:null,showDuration:300,hideDuration:1e3,timeOut:5e3,extendedTimeOut:1e3,showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"},i);function i(){}e.Notification=t}(o.UI||(o.UI={}))}(StockChartX=StockChartX||{}),function(d){!function(u){"use strict";u.TooltipPosition={AUTO:"auto",TOP:"top",BOTTOM:"bottom"},u.TooltipContentKind={TEXT:"text",IMAGE:"image",HTML:"html"},Object.freeze(u.TooltipContentKind);var o=jQuery,i="scxTooltip",n="scxArrowBox",r="scxTooltipArrowStyleAfter",a="scxTooltipArrowStyleBefore",s="scxTooltipThemeArrowStyleAfter",l="scxTooltipThemeArrowStyleBefore",c="scxTooltipContent",e=(Object.defineProperty(t.prototype,"UID",{get:function(){return("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._isInDom?{width:this._tooltipElement.outerWidth(),height:this._tooltipElement.outerHeight()}:this._minSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"theme",{get:function(){return this._options.theme},set:function(e){this._options.theme=e,this.applyTheme()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"actualTheme",{get:function(){var e=this.theme;return e||this.defaultTheme},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"defaultTheme",{get:function(){var e=this._parent.chart;return e?d.JsUtil.clone(e.theme.tooltip):null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"visible",{get:function(){return this._visible},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contentKind",{get:function(){return this._options.kind},set:function(e){this._options.kind=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"position",{get:function(){return this._options.position},set:function(e){this._options.position=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this._options.text},set:function(e){this._options.text=e,this._applyText()},enumerable:!0,configurable:!0}),t.prototype.initDomObjects=function(){this._id="tooltip-"+this.UID;var e='<div id="'+this._id+'"><style class="'+r+'"></style><style class="'+a+'"></style><style class="'+s+'"></style><style class="'+l+'"></style><div class="'+c+'"></div></div>',t=this._tooltipElement=o(e);t.addClass(i).addClass(n),this._arrowAfter=t.find("."+r),this._arrowBefore=t.find("."+a),this._arrowMainBefore=t.find("."+l),this._contentElement=t.find("."+c),this._applyText()},t.prototype._applyText=function(){var e=this.text,t=this.actualTheme,i=1;t&&(i=t.border.enabled?t.border.width:0),this._contentElement.empty();try{switch(this.contentKind){case u.TooltipContentKind.TEXT:this._contentElement.text(e).css("white-space","pre-wrap"),this._tooltipElement.css("pointer-events","none");break;case u.TooltipContentKind.IMAGE:var n=this._maxContentWidth-2*i;o('<img src="'+e+'" style="max-width: '+n+'px">').appendTo(this._contentElement),this._tooltipElement.css("pointer-events","none");break;case u.TooltipContentKind.HTML:this._contentElement.css("white-space","normal"),this._tooltipElement.css("width","auto"),this._tooltipElement.css("height","auto"),d.HtmlUtil.removeUnsecureTags(e).appendTo(this._contentElement),this._tooltipElement.css("pointer-events","auto")}}catch(e){}},t.prototype.saveState=function(){return d.JsUtil.clone(this._options)},t.prototype.loadState=function(e){this._options=e||o.extend(!0,{},t.defaults),this._options.kind||(this._options.kind=u.TooltipContentKind.TEXT),this.applyTheme(),this._applyText()},t.prototype.show=function(e){this.text&&(this._visible=!0,this._isInDom||(this._tooltipElement=u.HtmlContainer.instance.register(this._id,this._tooltipElement),this._isInDom=!0),this.moveTo(e),d.HtmlUtil.setVisibility(this._tooltipElement,!0))},t.prototype.hide=function(){this._visible=!1,d.HtmlUtil.setVisibility(this._tooltipElement,!1)},t.prototype._actualPosition=function(e){var t=this.layoutRect;if(!t)return u.TooltipPosition.TOP;var i=this.size.height+15;return!(e.y-i>=t.top)&&e.y+i<=t.top+t.height?u.TooltipPosition.BOTTOM:u.TooltipPosition.TOP},t.prototype._adjustArrow=function(e,t){var i=this.theme,n=i?i.border.strokeColor||i.border.color:"transparent",o=(i?i.fill.enabled:"transparent")&&i?i.fill.color:"transparent",r=t===u.TooltipPosition.BOTTOM,a=r?"bottom: 100%; top: auto;":"top: 100%; bottom: auto;",s=r?"border-top-color: transparent;":"border-bottom-color: transparent;",l=e<5||95<e?"display: none;":"display: block;",c=r?"border-bottom-color: "+o+";":"border-top-color: "+o+";",h=r?"border-bottom-color: "+n+";":"border-top-color: "+n+";",d="#"+this._id+":after {left: "+e+"%; "+c+" "+a+" "+s+" "+l+" }",_="#"+this._id+":before {left: "+e+"%; "+h+" "+a+" "+s+" "+l+" }";this._arrowAfter.text(d),this._arrowBefore.text(_)},t.prototype.applyTheme=function(){if(this._tooltipElement){var e=this.actualTheme;if(e){var t=e.border.enabled?e.border.width:0,i="solid",n=e.border.strokeColor||e.border.color,o=e.fill.enabled?e.fill.color:"transparent",r=e.text.fillColor,a=e.text.fontSize,s=e.text.fontFamily,l=e.text.fontWeight,c=e.text.fontStyle,h=e.text.decoration;switch(e.border.lineStyle){case d.LineStyle.DOT:i="dotted";break;case d.LineStyle.DASH_DOT:case d.LineStyle.DASH:i="dashed"}this._tooltipElement.css({background:o,"border-color":n,"border-width":t,"border-style":i}),this._contentElement.css({color:r,"font-family":s,"font-size":a+"px","font-weight":l,"font-style":c,"text-decoration":h,"word-wrap":"break-word"}),this._applyText(),this._arrowMainBefore.text("#"+this._id+":before { border-width: "+t+" }")}}},t.prototype.moveTo=function(e){var t=this._actualPosition(e),i=this._calculateLocation(t,e),n=(e.x-i.x)/this.size.width*100;this._adjustArrow(n,t),this._tooltipElement.css("left",i.x).css("top",i.y)},t.prototype._calculateLocation=function(e,t){var i,n=this.size,o=t.x-n.width/2,r=n.height+15;switch(e){case u.TooltipPosition.TOP:i=t.y-r;break;case u.TooltipPosition.BOTTOM:i=t.y+30;break;default:throw new Error("Unknown tooltip position: "+e)}var a,s=this.layoutRect;return s&&(o<s.left&&(o=s.left),a=s.left+s.width,o+n.width>a&&(o=a-n.width)),{x:o,y:i}},t.prototype.destroy=function(){this._tooltipElement&&(this._tooltipElement.remove(),this._tooltipElement=null,this._isInDom=!1)},t.defaults={text:"",kind:u.TooltipContentKind.TEXT},t);function t(e){this._maxContentWidth=270,this._minSize={width:280,height:29},this._isInDom=!1,this._options=e.options||o.extend(!0,{},t.defaults),this._parent=e.parent,this.initDomObjects()}u.Tooltip=e}(d.UI||(d.UI={}))}(StockChartX=StockChartX||{}),function(_){!function(e){"use strict";var a=".scxScrollingPanel",s=".sxcCanvas",t=(Object.defineProperty(i.prototype,"chart",{get:function(){return this._chart},set:function(e){this._chart!==e&&(this._unsubscribeEvents(),this._chart=e,this._subscribeEvents())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"outerHeight",{get:function(){return this._scrollbar?this._scrollbar.outerHeight():0},enumerable:!0,configurable:!0}),i.prototype._init=function(e,t){var i,n,o=this,r=this._chart=t.chart;null!=r&&r.container&&(this._scrollbar=$(e).insertAfter(r.rootDiv),this._scrollingPanel=this._scrollbar.find(a),i=this._scrollbar.find(s).get()[0],(n=new _.CanvasRenderer).canvas=i,this._canvas=i,this._renderer=n,this._scrollingPanel.draggable({drag:function(e,t){return o._update(t.position.left)},stop:function(e,t){return o._update(t.position.left)},axis:"x",containment:this._scrollingPanel.parent()}),this._scrollingPanel.resizable({container:r.container,minWidth:this._scrollingPanelMinWidth,direction:"horizontal",start:function(){o._scrollingPanel.draggable({disabled:!0})},resize:function(){o._update(o._scrollingPanel.position().left)},stop:function(){o._scrollingPanel.draggable({disabled:!1})}}),this._subscribeEvents(),r&&r.fireValueChanged(_.ChartEvent.SCROLLBAR_LOADED,this))},i.prototype._subscribeEvents=function(){var t=this,e=this.chart;e&&e.on(_.ChartEvent.WINDOW_MODE_CHANGED,function(e){t.adjustDimensions()})},i.prototype._unsubscribeEvents=function(){this._chart&&this._chart.off(_.ChartEvent.WINDOW_MODE_CHANGED)},i.prototype._drawBackground=function(){var e=this._chart.dataManager.getDataSeries(_.DataSeriesSuffix.CLOSE),t=this._renderer,i=this._scrollbar,n=i.height(),o=i.width(),r=e.length,a=o/r,s=e.minMaxValues().max;t.clearRect(0,0,o,n),t.beginPath(),t.fillTheme(this._chart.theme.scrollingPanelBackgroud.fill),t.moveTo(0,n);for(var l=0;l<=r-1;l++){var c,h,d=e.values[l];null!=d&&(c=n-n*(d/s),h=a*l,t.lineTo(h,c))}t.lineTo(o,n),t.closePath(),t.fill()},i.prototype.adjustDimensions=function(){var e,t,i,n,o,r,a;null!=this._chart&&(t=(e=this._chart.visibleDataRange()).firstVisibleDataRecord,i=e.lastVisibleDataRecord,n=this._chart.recordCount,o=this._scrollbar.width(),r=(i-t)/n*100,this._scrollingPanelWidth=o*r/100,(a=o*(this._chart.firstVisibleRecord/n*100)/100)+this._scrollingPanelMinWidth>=this._scrollbar.width()&&(a=o-this._scrollingPanelMinWidth),a<0&&(a=0),this._scrollingPanel.css({left:a,maxWidth:this._scrollbar.width()}),this._scrollingPanel.width(Math.max(this._scrollingPanelWidth,this._scrollingPanelMinWidth)),this._canvas.width=this._scrollbar.width(),this._drawBackground())},i.prototype._update=function(e){if(null!=this._chart){this._drawBackground();var t=this._scrollbar.width(),i=e/t*100,n=(e+this._scrollingPanel.width())/t*100,o=this._chart.recordCount,r=i*o/100,a=n*o/100;if(a<=r)return!1;this._chart.recordRange(r,a),this.chart.dateScale.requestMoreHistoryIfNeed(),this._chartUpdate()}},i.prototype._chartUpdate=function(){this._chart.setNeedsUpdate(!0)},i.prototype.appendTo=function(e){e&&(this._scrollbar.detach(),this._scrollbar=this._scrollbar.insertAfter(this.chart.rootDiv))},i);function i(t){var i=this;this._scrollingPanelMinWidth=20,this._scrollingPanelWidth=0,e.HtmlLoader.loadHtml("Scrollbar.html",function(e){i._init(e,t)})}e.Scrollbar=t}(_.UI||(_.UI={}))}(StockChartX=StockChartX||{}),function(n){!function(e){"use strict";var t=(Object.defineProperty(i.prototype,"theme",{get:function(){return{strokeColor:this._colorPicker.spectrum("get").toRgbString(),width:this._widthInput.scxNumericField("getValue"),lineStyle:this._lineStyleDropdown.val()}},set:function(e){this._colorPicker.spectrum("set",e.strokeColor),this._widthInput.scxNumericField("setValue",e.width),this._lineStyleDropdown.selectpicker("val",e.lineStyle||n.LineStyle.SOLID),this._lineStyleDropdown.selectpicker("refresh")},enumerable:!0,configurable:!0}),i);function i(e){this._colorPicker=e.colorPicker,this._widthInput=e.widthInput,this._lineStyleDropdown=e.lineStyleDropdown}e.LinePropertiesHandler=t}(n.UI||(n.UI={}))}(StockChartX=StockChartX||{}),function(e){!function(e){"use strict";var t=(Object.defineProperty(i.prototype,"theme",{get:function(){return{fillColor:this._colorPicker.spectrum("get").toRgbString()}},set:function(e){this._colorPicker.spectrum("set",e.fillColor)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isEnabled",{get:function(){return this._switcher.isChecked()},enumerable:!0,configurable:!0}),i.prototype.setState=function(e){this._switcher.setPosition(e),e?(this._colorPicker.spectrum("enable"),this._label.removeClass("disabled"),this._switcher.isChecked()||this._switcher.setPosition(!0)):(this._colorPicker.spectrum("disable"),this._label.addClass("disabled"),this._switcher.isChecked()&&this._switcher.setPosition(!0))},i);function i(e){this._label=e.label,this._colorPicker=e.colorPicker,this._switcher=e.switcher}e.FillPropertiesHandler=t}(e.UI||(e.UI={}))}(StockChartX=StockChartX||{}),function(_){!function(r){"use strict";var e="#scxTooltipView_region_",t="#scxTooltipView_input_",i="#scxTooltipView_label_",n="#scxTooltipView_chk_",o="#scxTooltipView_image_",a=(Object.defineProperty(s.prototype,"container",{set:function(e){e.append(this.tooltipView)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"chart",{set:function(e){this._chart=e},enumerable:!0,configurable:!0}),s.prototype._setBorderState=function(e){this._switchBorderEnabled.setPosition(e),e?(this._labelBorder.removeClass("disabled"),this._inputBorderColor.spectrum("enable"),this._inputBorderStyle.removeAttr("disabled").selectpicker("refresh"),this._inputBorderWidth.scxNumericField("enable"),this._switchBorderEnabled.isChecked()||this._switchBorderEnabled.setPosition(!0)):(this._labelBorder.addClass("disabled"),this._inputBorderColor.spectrum("disable"),this._inputBorderStyle.attr("disabled","disabled").selectpicker("refresh"),this._inputBorderWidth.scxNumericField("disable"),this._switchBorderEnabled.isChecked()&&this._switchBorderEnabled.setPosition(!0)),this._chart&&this._chart.localize(this._borderPanel)},s.prototype.setValues=function(e,t){void 0===t&&(t=!0),t&&(this._tooltip=e);var i=e.theme||e.actualTheme;this._setBorderState(i.border.enabled),this._inputBorderColor.spectrum("set",i.border.strokeColor||i.border.color),this._inputBorderStyle.selectpicker("val",i.border.lineStyle||_.LineStyle.SOLID).selectpicker("refresh"),this._inputBorderWidth.scxNumericField("setValue",i.border.width),this._fillPropertiesHandlerTooltip.theme={fillColor:i.fill.color},this._fillPropertiesHandlerTooltip.setState(i.fill.enabled),this._kindChooser.setKind(e.contentKind),e.contentKind===r.TooltipContentKind.IMAGE?(this._inputText.val(""),this._inputImageUrl.val(e.text),this._inputImagePreview.attr("src",e.text),e.text||this._resetImagePreview(this._inputImagePreview)):(this._inputText.val(e.text),this._inputImageUrl.val(""),this._resetImagePreview(this._inputImagePreview)),this._inputTextColor.spectrum("set",i.text.fillColor),this._inputTextFont.selectpicker("val",i.text.fontFamily).selectpicker("refresh"),this._inputTextSize.selectpicker("val",i.text.fontSize).selectpicker("refresh"),this._styleChooser.setStyle("b","bold"===i.text.fontWeight),this._styleChooser.setStyle("i","italic"===i.text.fontStyle),this._styleChooser.setStyle("u","underline"===i.text.decoration)},s.prototype._init=function(){var o=this;this._switchBorderEnabled=new Switchery(document.querySelector(n+"borderColor"),s._switcherySettings),this._switchBorderEnabled.setPosition(!0),this._inputTextSize.selectpicker({container:"body"}),this._inputBorderStyle.selectpicker({container:"body"}),this._inputBorderWidth.scxNumericField(s._numericFieldConfig),this._switchFillEnabled=new Switchery(document.querySelector(n+"fillColor"),s._switcherySettings),this._switchFillEnabled.setPosition(!0),this._fillPropertiesHandlerTooltip=new r.FillPropertiesHandler({label:this._labelFillColor,colorPicker:this._inputFillColor,switcher:this._switchFillEnabled}),this._kindChooser=new h({buttons:this._inputsKind,panelText:this._regionText,panelTextStyle:this._regionTextStyle,panelImage:this._regionImage}),this._styleChooser=new l(this._inputsTextStyles),this._initImagePreview(this._inputImageUrl,this._inputImagePreview),this._inputTextFont.selectpicker({container:"body"}).change(function(e){o._inputTextFont.next().css({"font-family":e.target.value})}),this.tooltipView.find(".scxSpectrum").scx().colorPicker({containerClassName:"scxTooltipView",localStorageKey:"scxThemeDialog_spectrum",showAlpha:!0}),$("body").on("scxSwitcherChanged",function(e,t){var i=$(t.target),n=t.checked;i.is(o._switchBorderEnabledJQuery)&&o._setBorderState(n),i.is(o._switchFillEnabledJQuery)&&o._fillPropertiesHandlerTooltip.setState(n)})},s.prototype._initImagePreview=function(t,i){var n=null;t.on("keyup",function(){var e=t.val();i.parent().addClass("scxLoading"),i.hide(),n&&clearTimeout(n),n=setTimeout(function(){i.attr("src",e)},1e3)}),i.on("load",function(e){$(e.currentTarget).show(),$(e.currentTarget).parent().removeClass("scxHasBg"),$(e.currentTarget).parent().removeClass("scxLoading")}),i.on("error",function(e){$(e.currentTarget).parent().addClass("scxHasBg"),$(e.currentTarget).parent().removeClass("scxLoading"),$(e.currentTarget).hide()})},s.prototype._resetImagePreview=function(e){e.attr("src","").hide().parent().addClass("scxHasBg").removeClass("scxLoading")},s.prototype.resetToDefaults=function(){var e=_.JsUtil.clone(this._tooltip);e.contentKind=r.Tooltip.defaults.kind,e.text=r.Tooltip.defaults.text,e.theme=e.defaultTheme,this.setValues(e,!1)},s.prototype.apply=function(){var e=this._tooltip,t=$.extend(!0,{},e.actualTheme),i={colorPicker:this._inputBorderColor,widthInput:this._inputBorderWidth,lineStyleDropdown:this._inputBorderStyle},n=new r.LinePropertiesHandler(i);switch(t.border=n.theme,t.border.enabled=this._switchBorderEnabled.isChecked(),t.fill.enabled=this._fillPropertiesHandlerTooltip.isEnabled,t.fill.color=this._fillPropertiesHandlerTooltip.theme.fillColor,e.contentKind=this._kindChooser.getKind(),e.contentKind){case r.TooltipContentKind.IMAGE:e.text=_.JsUtil.filterText(this._inputImageUrl.val());break;case r.TooltipContentKind.TEXT:case r.TooltipContentKind.HTML:e.text=this._inputText.val().trim()}t.text.fillColor=this._inputTextColor.spectrum("get").toRgbString(),t.text.fontFamily=this._inputTextFont.selectpicker("val"),t.text.fontSize=this._inputTextSize.selectpicker("val"),t.text.fontWeight=this._styleChooser.getStyle("b")?"bold":"normal",t.text.fontStyle=this._styleChooser.getStyle("i")?"italic":"normal",t.text.decoration=this._styleChooser.getStyle("u")?"underline":"",e.theme=t},s.prototype._initFields=function(){this._regionImage=this.tooltipView.find(e+"image"),this._regionText=this.tooltipView.find(e+"text"),this._regionTextStyle=this.tooltipView.find(e+"textStyle"),this._labelBorder=this.tooltipView.find(i+"border"),this._inputBorderColor=this.tooltipView.find(t+"borderColor"),this._inputBorderWidth=this.tooltipView.find(t+"borderWidth"),this._inputBorderStyle=this.tooltipView.find(t+"borderStyle"),this._switchBorderEnabledJQuery=this.tooltipView.find(n+"borderColor"),this._labelFillColor=this.tooltipView.find(i+"fillColor"),this._inputFillColor=this.tooltipView.find(t+"fillColor"),this._switchFillEnabledJQuery=this.tooltipView.find(n+"fillColor"),this._inputsKind=this.tooltipView.find(".scxTooltipView_tooltipKind").children(),this._inputText=this.tooltipView.find(t+"tooltipText"),this._inputTextColor=this.tooltipView.find(t+"textColor"),this._inputTextFont=this.tooltipView.find(t+"textFont"),this._inputTextSize=this.tooltipView.find(t+"textSize"),this._inputsTextStyles=this.tooltipView.find(t+"tooltipTextStyles"),this._inputImageUrl=this.tooltipView.find(t+"imageURL"),this._inputImagePreview=this.tooltipView.find(o+"preview"),this._borderPanel=this.tooltipView.find(e+"borderPanel")},s._numericFieldConfig={showArrows:!1,maxValue:10,minValue:1,value:1},s._switcherySettings={color:"rgba(72, 149, 245, 0.2)",secondaryColor:"rgba(16, 17, 20, 1)",jackColor:"rgba(72, 149, 245, 1)",jackSecondaryColor:"rgba(81, 83, 90, 1)",className:"scx_switchery",disabled:!1,disabledOpacity:.5,speed:"0.4s"},s);function s(e){this.tooltipView=e,this._initFields(),this._init()}r.TooltipView=a;var l=(c.prototype.getStyle=function(e){switch(e.toLowerCase()){case"b":return this._checkboxes.eq(0).prop("checked");case"i":return this._checkboxes.eq(1).prop("checked");case"u":return this._checkboxes.eq(2).prop("checked");default:return!1}},c.prototype.setStyle=function(e,t){switch(e.toLowerCase()){case"b":t?this._labels.eq(0).addClass("active"):this._labels.eq(0).removeClass("active"),this._checkboxes.eq(0).prop("checked",t);break;case"i":t?this._labels.eq(1).addClass("active"):this._labels.eq(1).removeClass("active"),this._checkboxes.eq(1).prop("checked",t);break;case"u":t?this._labels.eq(2).addClass("active"):this._labels.eq(2).removeClass("active"),this._checkboxes.eq(2).prop("checked",t)}},c.prototype._init=function(){this._labels=this._selector.find(">label"),this._checkboxes=this._selector.find("input[type=checkbox]"),this._labels.click(function(e){var t=$(e.currentTarget).find("input[type=checkbox]");t.prop("checked",!t.prop("checked")),t.prop("checked")?$(e.currentTarget).addClass("active"):$(e.currentTarget).removeClass("active")}).each(function(e){$(e.currentTarget).find("input[type=checkbox]").prop("checked")?$(e.currentTarget).addClass("active"):$(e.currentTarget).removeClass("active")})},c);function c(e){this._selector=e,this._init()}r.TextStyleChooser=l;var h=(d.prototype.destroy=function(){this._config.buttons.off("click",this._onButtonClicked)},d.prototype.getKind=function(){return this._kind},d.prototype.setKind=function(e,t){if(e===this._kind)return!1;switch(e){case r.TooltipContentKind.TEXT:this._config.panelImage.hide(),this._config.panelTextStyle.show(),this._config.panelText.show();break;case r.TooltipContentKind.HTML:this._config.panelImage.hide(),this._config.panelTextStyle.hide(),this._config.panelText.show();break;case r.TooltipContentKind.IMAGE:this._config.panelText.hide(),this._config.panelImage.show();break;default:return!1}return this._highlightButton(e),this._kind=e,t&&this._config.onChange&&this._config.onChange(e),!0},d.prototype._highlightButton=function(e){this._config.buttons.removeClass("active"),this._config.buttons.filter("["+this.DATA_KIND+'="'+e+'"]').addClass("active")},d.prototype._onButtonClicked=function(e){e.data.setKind($(e.target).data().kind,!0)},d);function d(e){this.DATA_KIND="data-kind",this._config=e,this.setKind(r.TooltipContentKind.TEXT),this._config.buttons.on("click",this,this._onButtonClicked)}}(_.UI||(_.UI={}))}(StockChartX=StockChartX||{}),function(o){!function(e){"use strict";var a,t;(t=a=a||{})[t.LEFT=0]="LEFT",t[t.RIGHT=1]="RIGHT";var i=(n.prototype._scroll=function(e){var t,i,n,o=this,r=this._scrollBox.scrollLeft();switch(e){case a.LEFT:(n=r-(i=this._scrollBox.outerWidth())+35)<=0&&(n=0),this._scrollBox.animate({scrollLeft:n},300);break;case a.RIGHT:i=this._scrollBox.outerWidth(),(t=this._toolbarContainer.outerWidth())-i<=(n=r+i-35)&&(n=t-i),this._scrollBox.animate({scrollLeft:n},300);break;default:throw new Error("Unknown direction")}setTimeout(function(){o.resize()},350)},n.prototype.resize=function(){this._scrollLeft.hide(),this._scrollRight.hide();var e,t=this._toolbar.chart;t&&(this._toolbarContainer.outerWidth()<=t.rootDiv.outerWidth()||(0<this._scrollBox.scrollLeft()&&this._scrollLeft.show(),e=t.rootDiv,t.multiChartRootContainer&&t.windowMode!==o.WindowMode.FULL_SCREEN&&(e=t.multiChartRootContainer),this._scrollBox.scrollLeft()<this._toolbarContainer.outerWidth()-e.outerWidth()&&this._scrollRight.show()))},n);function n(e,t,i){var n=this;this._toolbarContainer=t,this._containerRoot=i,this._toolbar=e,this._scrollBox=this._containerRoot.find(".scxToolbar-scroll-wrapper"),this._scrollLeft=this._containerRoot.find(".scxToolbar-scroll-left"),this._scrollRight=this._containerRoot.find(".scxToolbar-scroll-right"),this._containerRoot.removeClass("scxLicenseFree"),this._scrollLeft.on("click",function(){n._scroll(a.LEFT)}),this._scrollRight.on("click",function(){n._scroll(a.RIGHT)})}e.ToolbarScroll=i}(o.UI||(o.UI={}))}(StockChartX=StockChartX||{});var StockChartX,__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}();!function(l){!function(e){"use strict";var i,t="#scxOrderDialog_input_",n="#scxOrderDialog_select_",o="#scxOrderDialog_btn_",r="#scxOrderDialog_region_",a=(i=e.Dialog,__extends(s,i),s.prototype.show=function(e){this.initDialog(e)&&(e.orderBar.order.action&&(this._modifyOrderMode=!0),this._orderBar=e.orderBar,this._setValues(),i.prototype.show.call(this,e))},s.prototype.hide=function(){this._modifyOrderMode||this._wasApplied||this._config.orderBar.remove(),this._wasApplied=!1,this._modifyOrderMode=!1,i.prototype.hide.call(this)},s.prototype._init=function(){var e=this;this._sellButton.on("click",function(){e._orderBar.order.action=l.OrderAction.SELL,e._save(),e._orderBar.fire(l.OrderBarEvents.ORDER_CREATED)}),this._buyButton.on("click",function(){e._orderBar.order.action=l.OrderAction.BUY,e._save(),e._orderBar.fire(l.OrderBarEvents.ORDER_CREATED)}),this._submitButton.on("click",function(){e._save()}),this._replaceButton.on("click",function(){e._save(),e._orderBar.fire(l.OrderBarEvents.ORDER_UPDATED)}),this._kindSelect.selectpicker({container:"body"}).on("change",function(){e._changeType(e._kindSelect.val())}),this._timeInForceSelect.selectpicker({container:"body"}).on("change",function(){e._changeTimeInForce(e._timeInForceSelect.val())}),this._timeInForceSelect.selectpicker({container:"body"}),this._quantityInput.scxNumericField(s._quantityInputConfig),this._price.scxNumericField(s._priceInputConfig),this._stopPrice.scxNumericField(s._priceInputConfig)},s.prototype._initDatePicker=function(t){t.datetimepicker({widgetPositioning:{vertical:"top"},widgetParent:$(".modal-content",this._dialog),minDate:new Date,locale:this._config.chart.locale}),t.on("dp.change",function(e){null==e.date&&t.data("DateTimePicker").date(e.oldDate.toDate())}).on("dp.hide",function(e){""===t.val()&&t.data("DateTimePicker").date(e.date.toDate())})},s.prototype._setValues=function(){var e=this._orderBar.order,t=l.JsUtil.calculateDigitsOnTickSize(this._config.chart.instrument.tickSize),i=parseFloat(e.price.toFixed(t)),n=parseFloat(e.stopPrice.toFixed(t));this._initDatePicker(this._timeInForceDatePicker),this._price.scxNumericField("setValue",i),this._stopPrice.scxNumericField("setValue",n||0),this._quantityInput.scxNumericField("setValue",e.quantity),this._timeInForceDatePicker.data("DateTimePicker").date(e.date||new Date),this._kindSelect.selectpicker("val",e.kind).prop("disabled",!1).selectpicker("refresh"),this._timeInForceSelect.selectpicker("val",e.timeInForce).prop("disabled",!1).selectpicker("refresh"),this._modifyOrderMode?(this._sellButton.hide(),this._buyButton.hide(),e.state!==l.OrderState.PENDING_SUBMIT||this._orderBar.modifyOrder?(this._submitButton.hide(),this._replaceButton.show()):(this._sellButton.show(),this._buyButton.show(),this._submitButton.hide(),this._replaceButton.hide())):(this._sellButton.show(),this._buyButton.show(),this._submitButton.hide(),this._replaceButton.hide())},s.prototype._save=function(){this._apply(),this.hide()},s.prototype._apply=function(){var e=this._orderBar,t=e.order,i=l.JsUtil.clone(t);t.price=this._price.scxNumericField("getValue"),t.stopPrice=this._stopPrice.scxNumericField("getValue"),t.quantity=this._quantityInput.scxNumericField("getValue"),t.kind=this._kindSelect.selectpicker("val"),t.timeInForce=this._timeInForceSelect.selectpicker("val"),t.date=this._timeInForceDatePicker.data("DateTimePicker").date().toDate(),this._config.orderBar.remove(),this._config.chart.mainPanel.addObjects(e),e.update(),i.price!==t.price&&e.fire(l.OrderBarEvents.ORDER_PRICE_CHANGED,t,i),this._wasApplied=!0},s.prototype._changeType=function(e){switch(e){case l.OrderKind.MARKET:this._priceRow.hide(),this._stopPriceRow.hide();break;case l.OrderKind.STOP:this._stopPriceRow.show(),this._priceRow.hide();break;case l.OrderKind.LIMIT:this._stopPriceRow.hide(),this._priceRow.show();break;case l.OrderKind.STOP_LIMIT:this._stopPriceRow.show(),this._priceRow.show();break;default:throw new Error("Order kind is not valid")}},s.prototype._changeTimeInForce=function(e){e===l.OrderTimeInForce.GOOD_TILL_DATE?this._timeInForceDateRow.show():this._timeInForceDateRow.hide()},s.prototype._initFields=function(){this._submitButton=this._dialog.find(o+"submit"),this._replaceButton=this._dialog.find(o+"replace"),this._sellButton=this._dialog.find(o+"sell"),this._buyButton=this._dialog.find(o+"buy"),this._kindSelect=this._dialog.find(n+"kind"),this._timeInForceSelect=this._dialog.find(n+"timeInForce"),this._timeInForceDatePicker=this._dialog.find(t+"timeInForceDate"),this._price=this._dialog.find(t+"price"),this._stopPrice=this._dialog.find(t+"stopPrice"),this._quantityInput=this._dialog.find(t+"quantity"),this._priceRow=this._dialog.find(r+"price"),this._stopPriceRow=this._dialog.find(r+"stopPrice"),this._timeInForceDateRow=this._dialog.find(r+"timeInForceDate")},s._quantityInputConfig={showArrows:!1,minValue:1,maxValue:1e9,value:1},s._priceInputConfig={showArrows:!1,minValue:1e-5,value:0,maxValue:1e9,priceDecimals:5},s);function s(e){var t=i.call(this,e)||this;return t._modifyOrderMode=!1,t._wasApplied=!1,t._initFields(),t._init(),t}e.OrderDialog=a}(l.UI||(l.UI={}))}(StockChartX=StockChartX||{});