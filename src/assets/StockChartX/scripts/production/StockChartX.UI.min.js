/**
 * StockChartX Web & Mobile
 * @version v2.22.2
 * @link http://www.modulusfe.com/products/web-mobile-stock-chart-library/stockchartx-html5-web-mobile/
 * @license Copyright 2012 to 2017 by Modulus Financial Engineering, Inc., Scottsdale, AZ USA
 * http://www.modulusfe.com
 * 
 * Your license agreement requires the use of the Modulus LicensePing.com licensing mechanism.
 * The mechanism monitors the usage and distribution patterns of our intellectual property.
 * If the usage or distribution patterns indicate that our licensing mechanism has either
 * been removed, altered, tampered with or that our intellectual property may be misused in
 * any form, our legal team may initiate contact with you to investigate the matter further.
 * 
 * Removal or modification of this license mechanism by any means whatsoever (editing the code,
 * removing the LicensePing.com URL reference, etc.) constitutes willful and criminal copyright
 * infringement in addition to giving rise to claims by Modulus Financial Engineering, Inc.
 * against you, as the developer, and your company as a whole for, among others:
 * 
 * (1) Copyright Infringement;
 * (2) False Designation of Origin;
 * (3) Breach of Contract;
 * (4) Misappropriation of Trade Secrets;
 * (5) Interference with Contract; and
 * (6) Interference with Prospective Business Relations.
 * 
 * 17 USC � 506 - Criminal offenses
 * (a) Criminal Infringement.
 * Any person who willfully infringes a copyright shall be punished as provided under section
 * 2319 of title 18, if the infringement was committed for purposes of commercial advantage
 * or private financial gain.
 * 
 * 18 USC � 2319 - Criminal infringement of a copyright
 * (a) Any person who commits an offense under section 506 (a)(1)(A) of title 17 shall be imprisoned
 * not more than 5 years, or fined in the amount set forth in this title (up to $150,000), or both,
 * if the offense consists of the reproduction or distribution, including by electronic means, during
 * any 180-day period, of at least 10 copies, of 1 or more copyrighted works, which have a total retail
 * value of more than $2,500.
 * 
 * For more information, review the license agreement associated with this software and source
 * code at http://www.modulusfe.com/tos or contact us at legal@modulusfe.com.
 */
!function(e){!function(i){"use strict";jQuery.fn.scx=function(){var t=this;return{chartContextMenu:function(e){return new i.ChartContextMenu(t,e)},chartNavigation:function(e){return new i.ChartNavigation({target:t,chart:e})},colorPicker:function(e){return new i.ColorPicker(t,e)},indicatorContextMenu:function(e){return new i.IndicatorContextMenu(t,e)},instrumentSearch:function(e){return new i.InstrumentSearch(t,e)},comparingContextMenu:function(e){return new i.CompareContextMenu(t,e)},numericField:function(e){return t.scxNumericField(e)},timeFramePicker:function(e){return new i.TimeFramePicker(t,e)},toolbar:function(e){return new i.Toolbar({parent:t,chart:e})},scrollbar:function(e){return new i.Scrollbar({parent:t,chart:e})},toolbarDropDownButton:function(e){return new i.ToolbarDropDownButton(t,e)},waitingBar:function(){return new i.WaitingBar(t)},tradingContextMenu:function(e){return new i.TradingContextMenu(t,e)}}}}(e.UI||(e.UI={}))}(StockChartX=StockChartX||{}),function(e){!function(){"use strict";var p=jQuery,f="scxNumericField",m="scxNumericField",g="scxNumericField-wrapper",e="scxNumericField-invalidValue",b="scxNumericField-arrowWrapper",y="scxNumericField-arrowUp",w="scxNumericField-arrowDown",x="scxNumericFieldArrow",t={init:function(u){return this.each(function(){var e,t,i,n,o,r,a,s,l,c,h=p(this),d="";function _(){e.is("[disabled]")||(C(e,S(e)+o,!0),n=setTimeout(_,200))}h.attr("type","text").addClass(m),h.data(f,{target:h,settings:p.extend(!0,{canBeNegative:!1,priceDecimals:0,showArrows:!1,maxValue:null,minValue:null,value:0,onChange:null},u)}),u.showArrows&&(i=h.parent(),t=h.index(),r=h,a=p('<div class="'+g+'">'),s=p('<div class="'+b+" "+y+'"><span class="'+x+'"></span></div>'),l=p('<div class="'+b+" "+w+'"><span class="'+x+'"></span></div>'),c=r.outerHeight(!0),a.height(c),s.height(c-2),l.height(c-2),r.css("padding-right",40),a.append(r).append(s).append(l),s.css("padding-top",Math.floor(c/2-11)),l.css("padding-top",Math.floor(c/2-11)),k(s),k(l),a=(c={wrapper:a,field:r,arrowUp:s,arrowDown:l}).wrapper,r=t,l=(s=i).children().length-1,0<=r&&r<=l?s.children().eq(r).before(a):s.append(a),e=h=c.field,t=c.arrowUp,i=c.arrowDown,p(window).on("mouseup",function(){clearTimeout(n),o=0}),t.on("mousedown",function(){o=1,_()}),i.on("mousedown",function(){o=-1,_()})),h.on("input",function(){var e=p(this),t=S(e,d);d=0===u.priceDecimals&&""===e.val()?null!=u.minValue&&0<u.minValue?u.minValue:0:(u.maxValue&&u.minValue&&(e.val()>u.maxValue||e.val()<u.minValue)&&(d=u.maxValue),isNaN(t)&&(t=null),C(e,null===t?"-":t))}),h.on("blur",function(){var e=p(this),t=e.val(),i=v(e);(!u.priceDecimals||0<=u.priceDecimals)&&""===t||"-"===t?C(e,d=""!==(d=d>i.maxValue||d<i.minValue?i.maxValue:d)&&!isNaN(d)?d:i.value):C(e,t=null!=(t=S(e))&&!isNaN(t)?t:i.minValue,!0)}),d=C(h,u.value)})},show:function(){return this.each(function(){(v(this).showArrows?p(this).parent():p(this)).show()})},hide:function(){return this.each(function(){(v(this).showArrows?p(this).parent():p(this)).hide()})},disable:function(){return this.each(function(){p(this).attr("disabled","disabled")})},enable:function(){return this.each(function(){p(this).removeAttr("disabled")})},isDisabled:function(){var e=p(this).attr("disabled");return void 0!==e&&!1!==e},isEnabled:function(){var e=p(this).attr("disabled");return!(void 0!==e&&!1!==e)},highlightInvalid:function(){return this.each(function(){p(this).addClass(e)})},unhighlightInvalid:function(){return this.each(function(){p(this).removeClass(e)})},setValue:function(e){return this.each(function(){C(p(this),e)})},getValue:function(){return S(p(this))},setBounds:function(t,i){return this.each(function(){var e;null==t&&null==i||(e=v(this),null!=t&&(e.minValue=t),null!=i&&(e.maxValue=i),p(this).trigger("input"),C(p(this),S(p(this)),!0))})},onChange:function(e){return this.each(function(){v(this).onChange=e})}};function n(e){return p(e).data(f)}function v(e){return n(e).settings}function C(e,t,i){return void 0===i&&(i=!1),e.val(t),t.toString()}function S(e,t){var i=n(e).settings,e=function(e,t,i){for(var n=e.length-1;0<=n;n--)!function(e,t,i){void 0===t&&(t=!1);void 0===i&&(i=!1);switch(e){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case",":return 1;case".":return i;case"-":return t;default:return}}(e[n],t,i)&&(e=r(e,n));return e}(e.val(),i.canBeNegative,0<i.priceDecimals);return"-"===e||0===e.replace(/-/gi,"").length?null:(""!==e&&"."!==e||(e="0"),e=0<i.priceDecimals?o(e,t):o(e),parseFloat(e))}function o(e,t){var i,n,o;return void 0===t&&(t=""),-1<e.indexOf("-")&&(e="-"+e.replace(/-/g,"")),t.length&&1<function(e,t){var i=[],n=-1;for(;-1!==(n=e.indexOf(t,n+1));)i.push(n);return i}(e,".").length&&(i=t.indexOf("."),n=t.length-i,o=void 0,o=e.substr(0,i)===t.substr(0,i)?i:e.length-n,e=r(e,o)),e.replace(/,/g,"")}function r(e,t,i){var n=0===(i=void 0===i?"":i).length?t+1:t+i.length;return e.substr(0,t)+i+e.substr(n)}function k(e){e.attr("unselectable","on").css("user-select","none").on("selectstart",function(){return!1})}p.fn.scxNumericField=function(e){return t[e]?t[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?void p.error("Method "+e+" doesn't exist for jQuery.numericField"):t.init.apply(this,arguments)}}(e.UI||(e.UI={}))}(StockChartX=StockChartX||{}),function(i){!function(e){"use strict";var n=jQuery;function t(e,t){var i=this._getInitParams();this._picker=e.spectrum(n.extend(i,t))}t.prototype.getColor=function(){return this._picker.spectrum("get").toRgbString()},t.prototype.setColor=function(e){this._picker.spectrum("set",e)},t.prototype.spectrum=function(e,t){this._picker.spectrum(e,t)},t.prototype._getInitParams=function(){return i.Environment.isPhone?{color:"#000",showInput:!1,showInitial:!0,allowEmpty:!1,showAlpha:!1,disabled:!1,maxSelectionSize:1,showPalette:!0,showSelectionPalette:!1,showPaletteOnly:!0,palette:this._getPalette()}:{color:"#000",showInput:!1,showInitial:!0,allowEmpty:!1,showAlpha:!1,disabled:!1,maxSelectionSize:1,showPalette:!0,showSelectionPalette:!0,showPaletteOnly:!0,togglePaletteOnly:!0,palette:this._getPalette(),cancelText:"Cancel",chooseText:"Choose",togglePaletteMoreText:"More",togglePaletteLessText:"Less"}},t.prototype._getPalette=function(){return i.Environment.isPhone?[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#80c00000","#80b45f06","#80bf9000","#8038761d","#80134f5c","#800b5394","#80351c75","#80741b47"]]:[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]]},e.ColorPicker=t}(i.UI||(i.UI={}))}(StockChartX=StockChartX||{}),function(e){!function(e){"use strict";var a=jQuery,n="scxMenuItemCheckable",o="scxMenuItemChecked",r="disabled",s="scxSubMenu",t="scxMenuItemWithSubMenu",l="scxContextMenuOpen";function c(e,t){var i=this;this._eventSuffix=".scxContentMenu_"+ ++c.Id,this._isShown=!1,this._config=e,t&&(t.on("contextmenu",function(e){return a("body").trigger(l),i.show(e),!1}),e.showOnClick&&t.on("click",function(e){return a("body").trigger(l),i.show(e),!1})),this._subscribeEvents()}Object.defineProperty(c.prototype,"container",{get:function(){return this._config.menuContainer},enumerable:!0,configurable:!0}),c.prototype._subscribeEvents=function(){var t=this;a(document).on(["click","touchstart",""].join(this._eventSuffix+" "),function(e){if(2===e.button)return null;t._isShown&&t.hide()});a(window).on(["scroll","resize",""].join(this._eventSuffix+" "),function(){t._isShown&&t.hide()}),a("body").on(l+this._eventSuffix,function(){t._isShown&&t.hide()})},c.prototype._unsubscribeEvents=function(){a(document).off(this._eventSuffix),a(window).off(this._eventSuffix),a("body").off(this._eventSuffix)},c.prototype.hide=function(){this._isShown=!1,this._config.menuContainer.hide()},c.prototype.show=function(e){var i=this;this._config.onShow&&(a("body").trigger("click").trigger("localize",[this.container]),this._config.onShow()),this._config.menuContainer&&(this._config.menuContainer.data("target",a(e.target)).show().css(this._calculateMenuPosition(this._getLeftLocation(e),this._getTopLocation(e))).off("click").on("click",function(e){if(e.preventDefault(),!a(e.target).parent().attr("data-id"))return!1;if(i.hide(),!i._config.onItemSelected)return!1;var t,e=a(e.target).blur().parent();return e.hasClass(r)||(e.hasClass(n)?((t=e.hasClass(o))?e.removeClass(o):e.addClass(o),i._config.onItemSelected(e,!t)):i._config.onItemSelected(e)),!1}).find("."+t).each(function(){c._getSubMenuTopLocation(a(this))}),this._isShown=!0)},c.prototype._getLeftLocation=function(e){var e=e.pageX||e.originalEvent&&e.originalEvent.pageX,t=a(window).width(),i=this._config.menuContainer.width();return t<e+i&&i<e?e-i:e},c.prototype._getTopLocation=function(e){var e=e.pageY||e.originalEvent&&e.originalEvent.pageY,t=a(window).height(),i=this._config.menuContainer.height();return t<e-a(window).scrollTop()+i&&i<e?e-i:e},c.prototype._calculateMenuPosition=function(e,t){var i=this._config.menuContainer,n=(i.css({width:"auto",height:"auto"}),a(window).height()),o=i.outerHeight(!0),r=a(window).scrollTop();return n<o&&(i.height(n-20),o=n),{position:"absolute",top:t=n/o<2?r+n/2-o/2:t,left:e-a(window).scrollLeft()}},c._getSubMenuTopLocation=function(e){var t=e.parent().offset().top,i=e.offset().top;e.find("."+s).css({top:i-t-5+"px"})},c.prototype.destroy=function(){this._isShown&&this.hide(),this._unsubscribeEvents()},c.Id=0,e.ContextMenu=c}(e.UI||(e.UI={}))}(StockChartX=StockChartX||{});var StockChartX,__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}(),__extends=(!function(a){!function(n){"use strict";var o,i="disabled",e={FORMAT:"format"},e=(Object.freeze(e),o=n.ContextMenu,__extends(r,o),r.prototype._initMenu=function(e){var t=this;e.onShow=function(){t._onShow()}},r.prototype._onShow=function(){var e=this._config,t=(e.menuContainer=r._container).find("[data-id=format]");switch(e.chart.priceStyleKind){case a.BarPriceStyle.className:case a.HLBarPriceStyle.className:case a.HLCBarPriceStyle.className:case a.ColoredHLBarPriceStyle.className:case a.ColoredHLCBarPriceStyle.className:case a.ColoredBarPriceStyle.className:case a.KagiPriceStyle.className:case a.LineBreakPriceStyle.className:case a.PointAndFigurePriceStyle.className:case a.RenkoPriceStyle.className:t.removeClass(i);break;default:t.addClass(i)}},r.prototype.destroy=function(){this._chartContextMenuConfig.chart=null,o.prototype.destroy.call(this)},r.MenuItem=e,r);function r(e,t){var i=o.call(this,t,e)||this;return i._chartContextMenuConfig=t,n.HtmlLoader.loadHtml("ChartContextMenu.html",function(e){r._container||(r._container=n.HtmlContainer.instance.register("ChartContextMenu",e)),i._initMenu(i._chartContextMenuConfig)}),i}n.ChartContextMenu=e}(a.UI||(a.UI={}))}(StockChartX=StockChartX||{}),!function(o){!function(e){"use strict";var t=jQuery,i="active";function n(e){this._config=e,this._activeIndex=0,this._tabs=e.tabsContainer.children().removeClass(i),this._panels=e.panelsContainer.children().removeClass(i),this._config.activeIndex&&o.JsUtil.isNumber(this._config.activeIndex)&&(this._activeIndex=this._config.activeIndex),this._tabs.eq(this._activeIndex).addClass(i),this._panels.eq(this._activeIndex).addClass(i),this._tabs.css("width",100/this._tabs.length+"%"),this._tabs.on("click",this,this._onItemClicked)}n.prototype.activate=function(e,t){e!==this._activeIndex&&(this._tabs.eq(this._activeIndex).removeClass(i),this._panels.eq(this._activeIndex).removeClass(i),this._tabs.eq(e).addClass(i),this._panels.eq(e).addClass(i),this._activeIndex=e),t&&o.JsUtil.isFunction(this._config.onChange)&&this._config.onChange(e)},n.prototype.activeIndex=function(){return this._activeIndex},n.prototype.destroy=function(){this._tabs.off("click",this._onItemClicked)},n.prototype._onItemClicked=function(e){e.data.activate(t(e.target).index(),!0)},e.Tabs=n}(o.UI||(o.UI={}))}(StockChartX=StockChartX||{}),!function(e){!function(t){"use strict";var n=jQuery;function e(e){var t=this;this._isShown=!1,this._dialog=e,this._dialog.attr("tabindex",-1),this._dialog.modal({backdrop:!0,keyboard:!0,show:!1}),this._dialog.on("hidden.bs.modal",function(){t._isShown&&t.hide()}),this._initDialogContentObj(),this._dialogContent.dialog.draggable({handle:".modal-header",containment:"window"}),n(window).on("resize",this,this._onWindowResize),this._dialog.on("hide.bs.modal",function(){t._dialogContent.body.trigger("click")}),this._dialogContent.header.on("mousedown",function(){t._dialogContent.body.trigger("click")})}e.prototype.show=function(e){e.chart.localize(this._dialog),this._isShown=!0,this._dialog.attr("style",""),this._dialog.modal("show"),this.resize(),this._centralize()},e.prototype.hide=function(){this._isShown&&(this._isShown=!1,this._dialog.modal("hide"),n(document.activeElement).blur(),this._config.chart.keyboardEventsEnabled=this._keyboardEnabledState,this._config=null)},e.prototype.resetToDefault=function(){},e.prototype.resize=function(){this._adjustHeight()},e.prototype.destroy=function(){n(window).off("resize",this._onWindowResize)},e.prototype.initDialog=function(e){return!(!e||!e.chart||this._config||this._isShown)&&(this._config=e,this._keyboardEnabledState=e.chart.keyboardEventsEnabled,e.chart.keyboardEventsEnabled=!1,t.HtmlContainer.instance.resetSelf(e.chart),!0)},e.prototype._initDialogContentObj=function(){var e=this._dialog.find("> .modal-dialog"),t=e.find("> .modal-content");this._dialogContent={dialog:e,root:t,header:t.find("> .modal-header"),body:t.find("> .modal-body"),footer:t.find("> .modal-footer")}},e.prototype._onWindowResize=function(e){e=e.data;e._isShown&&e.resize()},e.prototype._adjustHeight=function(){this._dialogContent.body.css("height","auto"),this._dialogContent.dialog.css("height","auto");var e,t=.9*window.innerHeight,i=this._dialogContent.dialog.outerHeight(!0);t<i&&(i=i-this._dialogContent.dialog.height(),e=this._dialogContent.body.outerHeight(!0)-this._dialogContent.body.height(),t=t-this._dialogContent.header.outerHeight(!0)-(this._dialogContent.footer.outerHeight(!0)||0)-e-i,n(this._dialogContent.body).height(t))},e.prototype._centralize=function(){var e=(window.innerWidth-this._dialogContent.dialog.width())/2;this._dialogContent.dialog.css("margin","0"),this._dialogContent.dialog.css("left",e),this._dialogContent.dialog.css("top",20)},t.Dialog=e}(e.UI||(e.UI={}))}(StockChartX=StockChartX||{}),this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}()),__awaiter=(!function(e){!function(i){"use strict";var n,e={CLONE:"clone",DELETE:"delete",SETTINGS:"settings"},e=(Object.freeze(e),n=i.ContextMenu,__extends(o,n),o.MenuItem=e,o);function o(t,e){e=n.call(this,t,e)||this;return i.HtmlLoader.loadHtml("DrawingContextMenu.html",function(e){o._container||(o._container=i.HtmlContainer.instance.register("DrawingContextMenu",e)),t.menuContainer=o._container}),e}i.DrawingContextMenu=e}(e.UI||(e.UI={}))}(StockChartX=StockChartX||{}),this&&this.__awaiter||function(r,a,s,l){return new(s=s||Promise)(function(e,t){function i(e){try{o(l.next(e))}catch(e){t(e)}}function n(e){try{o(l.throw(e))}catch(e){t(e)}}function o(t){t.done?e(t.value):new s(function(e){e(t.value)}).then(i,n)}o((l=l.apply(r,a||[])).next())})}),__generator=this&&this.__generator||function(n,o){var r,a,s,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(i){return function(e){var t=[i,e];if(r)throw new TypeError("Generator is already executing.");for(;l;)try{if(r=1,a&&(s=a[2&t[0]?"return":t[0]?"throw":"next"])&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[0,s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return l.label++,{value:t[1],done:!1};case 5:l.label++,a=t[1],t=[0];continue;case 7:t=l.ops.pop(),l.trys.pop();continue;default:if(!(s=0<(s=l.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){l=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3])){l.label=t[1];break}if(6===t[0]&&l.label<s[1]){l.label=s[1],s=t;break}if(s&&l.label<s[2]){l.label=s[2],l.ops.push(t);break}s[2]&&l.ops.pop(),l.trys.pop();continue}t=o.call(n,l)}catch(e){t=[6,e],a=0}finally{r=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},__extends=(!function(B){!function(e){"use strict";var c="x",h="y",d="date",_="value",u="record",p=jQuery,t="scxCoordinatePanel",l="scxCoordinateTable",f="scxCoordinate-input-container",m="scxCoordinate-type-container",g="scxCoordinate-type-item",b="scxCoordinate-input",y="scxCoordinate-datetimepicker",w="scxCoordinate-point-label",x="active",v="x",C="y",S="record",k="date",P="price",L=[c,u,d],T=[h,_],D={showArrows:!1,canBeNegative:!0,value:0,minValue:-1e8},F={showArrows:!1,canBeNegative:!0,priceDecimals:5,value:0,minValue:-1e9};function i(e){this._inputs=[],this._init(e)}i.prototype._init=function(e){this._container=p('<div class="'+t+'" />').appendTo(e)},i.prototype._fill=function(){return __awaiter(this,void 0,void 0,function(){var t,i,n,o,r,a,s;return __generator(this,function(e){switch(e.label){case 0:return t=this._table=p('<table class="'+l+'" />'),[4,this._drawing.pointsLocalizationKeys()];case 1:if(!(i=e.sent()))return[2];for(n=0;n<i.length;n++)o=p("<tr/>").appendTo(t),s=this._drawing.createPointBehavior,r=p('<span class="'+w+'" data-i18n="'+i[n]+'"/>'),a=this._createCoordinateInput(n,s.x,L),s=this._createCoordinateInput(n,s.y,T),this._inputs.push(a,s),o.append([p("<td/>").append(r),p("<td/>").append(a.container),p("<td/>").append(s.container)]);return this._drawing.chart.localize(this._container.append(t)),[2]}})})},i.prototype._createCoordinateInput=function(n,e,t){var o=this,i=this._getPointCoordinates(n,e),r=p('<div class="'+f+'"/>'),a=p('<input class="'+b+' form-control scxNumericField">').scxNumericField(D),s=this._createTypeChooser(t,e),l={container:r,inputElement:a,type:e},c=this._createDatePicker();return e===d?(c.data("DateTimePicker").date(i),p(a).hide(),c.show()):(e===_&&a.scxNumericField(F),a.scxNumericField("setValue",i)),r.append(s,a,c),s.find("."+g).on(B.MouseEvent.CLICK,function(e){var t,e=p(e.target),i=e.data("type");i!==l.type&&(l.type=i,t=o._getPointCoordinates(n,i),i===d?(c.data("DateTimePicker").date(t),p(a).hide(),c.show()):(i=i===_?F:D,a.scxNumericField(i),a.scxNumericField("setValue",t),p(a).show(),c.hide()),p("."+g,s).removeClass(x),e.addClass(x))}),l},i.prototype._createDatePicker=function(){var t=p('<input class="'+y+' form-control"/>');return p(t).datetimepicker({widgetPositioning:{vertical:"top"},widgetParent:p(".scxDialog.in .modal-content"),locale:this._drawing.chart.locale}),p(t).on("dp.change",function(e){null==e.date&&p(t).data("DateTimePicker").date(e.oldDate.toDate())}).on("dp.hide",function(e){""===p(t).val()&&p(t).data("DateTimePicker").date(e.date.toDate())}).hide(),t},i.prototype._createTypeChooser=function(e,t){for(var i=p('<div class="'+m+'"/>'),n=0,o=e;n<o.length;n++){var r=o[n],a="drawing.all.dialog.coordinates.";switch(r){case c:a+=v;break;case h:a+=C;break;case u:a+=S;break;case d:a+=k;break;case _:a+=P}var s=p('<span class="'+g+'" data-type="'+r+'" data-i18n="'+a+'"></span>');r===t&&s.addClass(x),i.append(s)}return i},i.prototype._getPointCoordinates=function(e,t){var i=this._drawing.projection,n=this._drawing.cartesianPoint(e);switch(t){case c:return n.x;case h:return n.y;case d:return i.dateByX(n.x);case u:return i.recordByX(n.x);case _:return i.valueByY(n.y)}},i.prototype._getCartesianPointByCoordinates=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var i=[],n=this._drawing.projection,o=0,r=e;o<r.length;o++){var a=r[o],s=a.inputElement.scxNumericField("getValue");switch(a.type){case c:case h:i.push(s);break;case u:i.push(n.xByRecord(s));break;case d:var l=p("."+y,a.container).data("DateTimePicker").date().toDate();i.push(n.xByDate(l));break;case _:i.push(n.yByValue(s))}}return{x:i[0],y:i[1]}},i.prototype.setValues=function(e){this._drawing=e,this._reset(),this._fill()},i.prototype._reset=function(){this._table&&this._table.remove(),this._inputs=[]},i.prototype.apply=function(){if(0!==this._inputs.length){for(var e=[],t=0;t<this._inputs.length-1;t+=2){var i=this._inputs[t],n=this._inputs[t+1],i=this._getCartesianPointByCoordinates(i,n);e.push(i)}this._drawing.setChartPointsWithNormalize(e)}},e.CoordinatePanel=i}(B.UI||(B.UI={}))}(StockChartX=StockChartX||{}),this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}()),__awaiter=this&&this.__awaiter||function(r,a,s,l){return new(s=s||Promise)(function(e,t){function i(e){try{o(l.next(e))}catch(e){t(e)}}function n(e){try{o(l.throw(e))}catch(e){t(e)}}function o(t){t.done?e(t.value):new s(function(e){e(t.value)}).then(i,n)}o((l=l.apply(r,a||[])).next())})},__generator=this&&this.__generator||function(n,o){var r,a,s,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(i){return function(e){var t=[i,e];if(r)throw new TypeError("Generator is already executing.");for(;l;)try{if(r=1,a&&(s=a[2&t[0]?"return":t[0]?"throw":"next"])&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[0,s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return l.label++,{value:t[1],done:!1};case 5:l.label++,a=t[1],t=[0];continue;case 7:t=l.ops.pop(),l.trys.pop();continue;default:if(!(s=0<(s=l.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){l=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3])){l.label=t[1];break}if(6===t[0]&&l.label<s[1]){l.label=s[1],s=t;break}if(s&&l.label<s[2]){l.label=s[2],l.ops.push(t);break}s[2]&&l.ops.pop(),l.trys.pop();continue}t=o.call(n,l)}catch(e){t=[6,e],a=0}finally{r=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},__extends=(!function(_){!function(a){"use strict";var o;(h=o=o||{})[h.DRAWING=0]="DRAWING",h[h.TOOLTIP=1]="TOOLTIP",h[h.POINTS=2]="POINTS";var t,e="#scxDrawingDialog_",i="#scxDrawingDialog_input_",n="#scxDrawingDialog_label_",r="#scxDrawingDialog_chk_",s="#scxDrawingDialog_panel_figure_",l="#scxDrawingDialog_panel_",c="#scxDrawingDialog_tab_",h=(t=a.Dialog,__extends(d,t),d.prototype.show=function(e){this.initDialog(e)&&(this._isApplyClicked=!1,this._setDialogTitle(),this._switchView(),this._tabs.activate(0),this._setValues(this._config.drawing),t.prototype.show.call(this,e),(_.Environment.isPhone||_.Environment.isMobile)&&event.preventDefault())},d.prototype.hide=function(){!this._isApplyClicked&&this._config.cancel&&this._config.cancel(),this._config.always&&this._config.always(),t.prototype.hide.call(this)},d.prototype._init=function(){var n=this;this._tabs=new a.Tabs({tabsContainer:this._tabItemsContainer,panelsContainer:this._tabPanelsContainer,onChange:function(e){n.resize()}}),this._input_lineWidth.scxNumericField(d._numericFieldConfig),this._input_horizontalLineWidth.scxNumericField(d._numericFieldConfig),this._input_arcWidth.scxNumericField(d._numericFieldConfig),this._chk_lineEnabled=new Switchery(document.querySelector(r+"lineColor"),d._switcherySettings),this._chk_lineEnabled.setPosition(!0),this._chk_fillEnabled=new Switchery(document.querySelector(r+"fillColor"),d._switcherySettings),this._chk_fillEnabled.setPosition(!0),this._chk_fill2Enabled=new Switchery(document.querySelector(r+"fillColor2"),d._switcherySettings),this._chk_fill2Enabled.setPosition(!0),this._fillPropertiesHandler=new a.FillPropertiesHandler({label:this._label_fillEnabled,colorPicker:this._input_fillColor,switcher:this._chk_fillEnabled}),this._fillPropertiesHandler2=new a.FillPropertiesHandler({label:this._label_fill2Enabled,colorPicker:this._input_fillColor2,switcher:this._chk_fill2Enabled}),this._input_labelFont.selectpicker({container:"body"}).change(function(e){n._input_labelFont.next().css({"font-family":e.target.value})}),this._input_labelSize.selectpicker({container:"body"}),this._input_lineStyle.selectpicker({container:"body"}),this._input_horizontalLineStyle.selectpicker({container:"body"}),this._input_arcStyle.selectpicker({container:"body"}),this._input_textFont.selectpicker({container:"body"}).change(function(e){n._input_textFont.next().css({"font-family":e.target.value})}),this._input_textSize.selectpicker({container:"body"}),this._textStylesChooser=new a.TextStyleChooser(this._inputs_textStyles),this._initImagePreview(this._input_imageUrl,this._input_imagePreview),this._input_magnetTo.selectpicker({container:"body"}),this._input_magnetMode.selectpicker({container:"body"}),this._dialog.find(".scxSpectrum").scx().colorPicker({containerClassName:"scxSpectrumDrawingDialog",localStorageKey:"scxThemeDialog_spectrum",showAlpha:!0}),$("body").on("scxSwitcherChanged",function(e,t){var i=$(t.target),t=t.checked;i.is(n._chk_lineEnabledHTMLObj)?n._setLineState(t):i.is(n._chk_fillEnabledHTMLObj)?n._fillPropertiesHandler.setState(t):i.is(n._chk_fill2EnabledHTMLObj)?n._fillPropertiesHandler2.setState(t):i.is(n._chk_textBackgroundEnabledHTMLObj)?n._setTextBackgroundState(t):i.is(n._chk_textBorderEnabledHTMLObj)&&n._setTextBorderState(t)}),this._dialog.find(e+"btn_resetToDefaults").on("click",function(){n.resetToDefaults()}),this._dialog.find(e+"btn_save").on("click",function(){n._save()}),this._dialog.find(e+"btn_apply").on("click",function(){n._apply()})},d.prototype._initImagePreview=function(t,i){var n=null;t.on("keyup",function(){var e=t.val();i.parent().addClass("scxLoading"),i.hide(),n&&clearTimeout(n),n=setTimeout(function(){i.attr("src",e)},1e3)}),i.on("load",function(e){$(e.currentTarget).show(),$(e.currentTarget).parent().removeClass("scxHasBg"),$(e.currentTarget).parent().removeClass("scxLoading")}),i.on("error",function(e){$(e.currentTarget).parent().addClass("scxHasBg"),$(e.currentTarget).parent().removeClass("scxLoading"),$(e.currentTarget).hide()})},d.prototype._resetImagePreview=function(e){e.attr("src","").hide().parent().addClass("scxHasBg").removeClass("scxLoading")},d.prototype.resetToDefaults=function(){var e=_.JsUtil.clone(this._config.drawing);if(this._tabs.activeIndex()===o.DRAWING){switch(e.theme=e.defaultTheme,e.className){case _.NoteDrawing.className:$.extend(!0,e,_.NoteDrawing.defaults);break;case _.ImageDrawing.className:e.url="";break;case _.TextDrawing.className:case _.BalloonDrawing.className:e.text=""}this._setValues(e,!0)}this._tabs.activeIndex()===o.TOOLTIP&&this._tooltipView&&this._tooltipView.resetToDefaults(),this._tabs.activeIndex()===o.POINTS&&(this._input_magnetMode.selectpicker("val",_.MagnetMode.NONE).selectpicker("refresh"),this._input_magnetTo.selectpicker("val",_.MagnetPoint.BAR).selectpicker("refresh"),this._coordinatePanel.setValues(this._config.drawing)),this._config.chart.localize(this._dialog)},d.prototype._setLineState=function(e){e?(this._input_lineColor.spectrum("enable"),this._label_lineEnabled.removeClass("disabled"),this._input_lineStyle.removeAttr("disabled").selectpicker("refresh"),this._input_lineWidth.scxNumericField("enable"),this._chk_lineEnabled.isChecked()||this._chk_lineEnabled.setPosition(!0)):(this._input_lineColor.spectrum("disable"),this._label_lineEnabled.addClass("disabled"),this._input_lineStyle.attr("disabled","disabled").selectpicker("refresh"),this._input_lineWidth.scxNumericField("disable"),this._chk_lineEnabled.isChecked()&&this._chk_lineEnabled.setPosition(!0)),this._config.chart&&this._config.chart.localize(this._panelFigureLine)},d.prototype._setTextBackgroundState=function(e){e?(this._input_textBackColor.spectrum("enable"),this._label_textBackgroundEnabled.removeClass("disabled")):(this._input_textBackColor.spectrum("disable"),this._label_textBackgroundEnabled.addClass("disabled"))},d.prototype._setTextBorderState=function(e){e?(this._input_textBorderColor.spectrum("enable"),this._label_textBorderEnabled.removeClass("disabled")):(this._input_textBorderColor.spectrum("disable"),this._label_textBorderEnabled.addClass("disabled"))},d.prototype._switchView=function(){switch(this._dialog.find(".scxSpectrum").spectrum("enable"),this._panelFigure.hide(),this._panelImage.hide(),this._panelText.hide(),this._panelFigureLine.hide(),this._panelFigureLineEnabled.hide(),this._panelFigureFill.hide(),this._panelFigureFillEnabled.hide(),this._panelFigureFill2.hide(),this._panelFigureFill2Enabled.hide(),this._panelFigureLabel.hide(),this._panelFigureArc.hide(),this._panelFigureHorizontalLine.hide(),this._config.drawing.className){case _.DotDrawing.className:case _.SquareDrawing.className:case _.DiamondDrawing.className:case _.ArrowUpDrawing.className:case _.ArrowDownDrawing.className:case _.ArrowLeftDrawing.className:case _.ArrowRightDrawing.className:case _.Arrow.className:this._panelFigureFill.show(),this._panelFigure.show();break;case _.NoteDrawing.className:this._panelFigureFill.show(),this._panelFigureFillEnabled.show(),this._panelFigureFill2.show(),this._panelFigureFill2Enabled.show(),this._panelFigureLabel.show(),this._panelFigure.show();break;case _.LineSegmentDrawing.className:case _.HorizontalLineDrawing.className:case _.VerticalLineDrawing.className:case _.TrendChannelDrawing.className:case _.ErrorChannelDrawing.className:case _.TironeLevelsDrawing.className:case _.QuadrantLinesDrawing.className:case _.RaffRegressionDrawing.className:case _.SpeedLinesDrawing.className:case _.GannFanDrawing.className:case _.PolylineDrawing.className:case _.AndrewsPitchforkDrawing.className:case _.CyclicLinesDrawing.className:this._panelFigureLine.show(),this._panelFigure.show();break;case _.RectangleDrawing.className:case _.TriangleDrawing.className:case _.CircleDrawing.className:case _.EllipseDrawing.className:case _.PolygonDrawing.className:this._panelFigureLine.show(),this._panelFigureLineEnabled.show(),this._panelFigureFill.show(),this._panelFigureFillEnabled.show(),this._panelFigure.show();break;case _.TextDrawing.className:this._panelText.show(),this._input_text.show(),this._inputs_textStyles.show();break;case _.ImageDrawing.className:this._panelImage.show();break;case _.BalloonDrawing.className:this._panelFigureLine.show(),this._panelFigureLineEnabled.show(),this._panelFigureFill.show(),this._panelFigureFillEnabled.show(),this._panelFigure.show(),this._input_text.show(),this._inputs_textStyles.show(),this._panelText.show();break;case _.MeasureDrawing.className:this._panelFigureLine.show(),this._panelFigureLineEnabled.show(),this._panelFigureFill.show(),this._panelFigureFillEnabled.show(),this._panelFigure.show(),this._panelText.show(),this._input_text.hide(),this._inputs_textStyles.hide();break;case _.FreeHandDrawing.className:this._panelFigure.show(),this._panelFigureLine.show();break;case _.TrendAngleDrawing.className:this._panelFigure.show(),this._panelFigureLine.show(),this._panelFigureArc.show(),this._panelFigureHorizontalLine.show()}},d.prototype._setDialogTitle=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return[4,_.Localization.localizeText(this._config.chart,"drawing."+this._config.drawing.className+".name")];case 1:return t=e.sent(),[4,_.Localization.localizeText(this._config.chart,"drawing.all.dialog.title",{replace:{drawingName:t}})];case 2:return t=e.sent(),this._title.text(t),[2]}})})},d.prototype._setValues=function(e,t){if(!t||this._tabs.activeIndex()===o.DRAWING){var i=e.theme||e.actualTheme;switch(e.className){case _.DotDrawing.className:case _.SquareDrawing.className:case _.DiamondDrawing.className:case _.ArrowUpDrawing.className:case _.ArrowDownDrawing.className:case _.ArrowLeftDrawing.className:case _.ArrowRightDrawing.className:case _.Arrow.className:this._fillPropertiesHandler.theme=i.fill,this._fillPropertiesHandler.setState(!0);break;case _.NoteDrawing.className:this._fillPropertiesHandler.theme=i.fill,this._fillPropertiesHandler.setState(!1!==i.fill.fillEnabled),this._fillPropertiesHandler2.theme=i.centerPointFill,this._fillPropertiesHandler2.setState(!1!==i.centerPointFill.fillEnabled),this._input_labelText.val(e.label),this._input_labelColor.spectrum("set",i.text.fillColor),this._input_labelFont.selectpicker("val",i.text.fontFamily).selectpicker("refresh"),this._input_labelSize.selectpicker("val",i.text.fontSize).selectpicker("refresh");break;case _.LineSegmentDrawing.className:case _.HorizontalLineDrawing.className:case _.VerticalLineDrawing.className:case _.TrendChannelDrawing.className:case _.ErrorChannelDrawing.className:case _.TironeLevelsDrawing.className:case _.QuadrantLinesDrawing.className:case _.RaffRegressionDrawing.className:case _.SpeedLinesDrawing.className:case _.GannFanDrawing.className:case _.PolylineDrawing.className:case _.AndrewsPitchforkDrawing.className:case _.CyclicLinesDrawing.className:this._setLineState(!0),this._input_lineColor.spectrum("set",i.line.strokeColor),this._input_lineStyle.selectpicker("val",i.line.lineStyle||_.LineStyle.SOLID).selectpicker("refresh"),this._input_lineWidth.scxNumericField("setValue",i.line.width);break;case _.RectangleDrawing.className:case _.TriangleDrawing.className:case _.CircleDrawing.className:case _.EllipseDrawing.className:case _.PolygonDrawing.className:this._setLineState(void 0===i.line.strokeEnabled||i.line.strokeEnabled),this._input_lineColor.spectrum("set",i.line.strokeColor),this._input_lineStyle.selectpicker("val",i.line.lineStyle||_.LineStyle.SOLID).selectpicker("refresh"),this._input_lineWidth.scxNumericField("setValue",i.line.width),this._fillPropertiesHandler.theme=i.fill,this._fillPropertiesHandler.setState(!1!==i.fill.fillEnabled);break;case _.TextDrawing.className:this._input_text.val(e.text),this._input_textColor.spectrum("set",i.text.fillColor),this._input_textFont.selectpicker("val",i.text.fontFamily).selectpicker("refresh"),this._input_textSize.selectpicker("val",i.text.fontSize).selectpicker("refresh"),this._textStylesChooser.setStyle("b","bold"===i.text.fontWeight),this._textStylesChooser.setStyle("i","italic"===i.text.fontStyle),this._textStylesChooser.setStyle("u","underline"===i.text.decoration);break;case _.ImageDrawing.className:var n=e.url;this._input_imageUrl.val(n),this._input_imagePreview.attr("src",n),n||this._resetImagePreview(this._input_imagePreview);break;case _.BalloonDrawing.className:this._setLineState(void 0===i.line.strokeEnabled||i.line.strokeEnabled),this._input_lineColor.spectrum("set",i.line.strokeColor),this._input_lineStyle.selectpicker("val",i.line.lineStyle||_.LineStyle.SOLID).selectpicker("refresh"),this._input_lineWidth.scxNumericField("setValue",i.line.width),this._fillPropertiesHandler.theme=i.fill,this._fillPropertiesHandler.setState(!1!==i.fill.fillEnabled),this._input_text.val(e.text),this._input_textColor.spectrum("set",i.text.fillColor),this._input_textFont.selectpicker("val",i.text.fontFamily).selectpicker("refresh"),this._input_textSize.selectpicker("val",i.text.fontSize).selectpicker("refresh"),this._textStylesChooser.setStyle("b","bold"===i.text.fontWeight),this._textStylesChooser.setStyle("i","italic"===i.text.fontStyle),this._textStylesChooser.setStyle("u","underline"===i.text.decoration);break;case _.MeasureDrawing.className:this._setLineState(void 0===i.line.strokeEnabled||i.line.strokeEnabled),this._input_lineColor.spectrum("set",i.line.strokeColor),this._input_lineStyle.selectpicker("val",i.line.lineStyle||_.LineStyle.SOLID).selectpicker("refresh"),this._input_lineWidth.scxNumericField("setValue",i.line.width),this._fillPropertiesHandler.theme=i.fill,this._fillPropertiesHandler.setState(!1!==i.fill.fillEnabled),this._input_text.val(e.text),this._input_textColor.spectrum("set",i.balloon.text.fillColor),this._input_textFont.selectpicker("val",i.balloon.text.fontFamily).selectpicker("refresh"),this._input_textSize.selectpicker("val",i.balloon.text.fontSize).selectpicker("refresh");break;case _.FreeHandDrawing.className:this._setLineState(!0),this._input_lineColor.spectrum("set",i.line.strokeColor),this._input_lineStyle.selectpicker("val",i.line.lineStyle||_.LineStyle.SOLID).selectpicker("refresh"),this._input_lineWidth.scxNumericField("setValue",i.line.width);break;case _.TrendAngleDrawing.className:this._setLineState(!0),this._input_lineColor.spectrum("set",i.line.strokeColor),this._input_lineStyle.selectpicker("val",i.line.lineStyle||_.LineStyle.SOLID).selectpicker("refresh"),this._input_lineWidth.scxNumericField("setValue",i.line.width),this._input_horizontalLineColor.spectrum("set",i.horizontalLine.strokeColor),this._input_horizontalLineStyle.selectpicker("val",i.horizontalLine.lineStyle||_.LineStyle.DOT).selectpicker("refresh"),this._input_horizontalLineWidth.scxNumericField("setValue",i.horizontalLine.width),this._input_arcColor.spectrum("set",i.arc.strokeColor),this._input_arcStyle.selectpicker("val",i.arc.lineStyle||_.LineStyle.DOT).selectpicker("refresh"),this._input_arcWidth.scxNumericField("setValue",i.arc.width)}}t&&this._tabs.activeIndex()!==o.POINTS||(e.magnetMode||(e.magnetPoint=_.MagnetPoint.BAR,e.magnetMode=_.MagnetMode.NONE),this._input_magnetMode.selectpicker("val",e.magnetMode).selectpicker("refresh"),this._input_magnetTo.selectpicker("val",e.magnetPoint).selectpicker("refresh"),this._coordinatePanel||(this._coordinatePanel=new a.CoordinatePanel(this._panelPoints)),this._coordinatePanel.setValues(this._config.drawing)),t&&this._tabs.activeIndex()!==o.TOOLTIP||this._loadTooltipView(e.tooltip)},d.prototype._save=function(){this._apply(),this._validateInputValue()&&this.hide()},d.prototype._apply=function(){var t=this,e=this._config.drawing;if(e.chart){var i,n,o=$.extend(!0,{},e.actualTheme),r="";switch(this._coordinatePanel.apply(),e.magnetMode?(e.magnetPoint=this._input_magnetTo.val(),e.magnetMode=this._input_magnetMode.val()):(e.magnetPoint=_.MagnetPoint.BAR,e.magnetMode=_.MagnetMode.NONE),i={colorPicker:this._input_lineColor,widthInput:this._input_lineWidth,lineStyleDropdown:this._input_lineStyle},n=new a.LinePropertiesHandler(i),e.className){case _.DotDrawing.className:case _.SquareDrawing.className:case _.DiamondDrawing.className:case _.ArrowUpDrawing.className:case _.ArrowDownDrawing.className:case _.ArrowLeftDrawing.className:case _.ArrowRightDrawing.className:case _.Arrow.className:o.fill.fillColor=this._fillPropertiesHandler.theme.fillColor;break;case _.NoteDrawing.className:o.fill.fillColor=this._fillPropertiesHandler.theme.fillColor,o.fill.fillEnabled=this._fillPropertiesHandler.isEnabled,o.centerPointFill.fillColor=this._fillPropertiesHandler2.theme.fillColor,o.centerPointFill.fillEnabled=this._fillPropertiesHandler2.isEnabled,e.label=this._input_labelText.val(),o.text.fillColor=this._input_labelColor.spectrum("get").toRgbString(),o.text.fontFamily=this._input_labelFont.selectpicker("val"),o.text.fontSize=this._input_labelSize.selectpicker("val");break;case _.LineSegmentDrawing.className:case _.HorizontalLineDrawing.className:case _.VerticalLineDrawing.className:case _.TrendChannelDrawing.className:case _.ErrorChannelDrawing.className:case _.TironeLevelsDrawing.className:case _.QuadrantLinesDrawing.className:case _.RaffRegressionDrawing.className:case _.SpeedLinesDrawing.className:case _.GannFanDrawing.className:case _.PolylineDrawing.className:case _.AndrewsPitchforkDrawing.className:case _.CyclicLinesDrawing.className:o.line=n.theme;break;case _.RectangleDrawing.className:case _.TriangleDrawing.className:case _.CircleDrawing.className:case _.EllipseDrawing.className:case _.PolygonDrawing.className:o.line=n.theme,o.line.strokeEnabled=this._chk_lineEnabled.isChecked(),o.fill.fillEnabled=this._fillPropertiesHandler.isEnabled,o.fill.fillColor=this._fillPropertiesHandler.theme.fillColor;break;case _.ImageDrawing.className:if(!this._validateInputValue())return void _.Localization.localizeText(this._config.chart,"drawing.all.notification.urlIsNotSpecified").then(function(e){a.Notification.warning(e,t._config.chart)});e.url=_.JsUtil.filterText(this._input_imageUrl.val());break;case _.TextDrawing.className:if(!this._validateInputValue())return void _.Localization.localizeText(this._config.chart,"drawing.all.notification.textIsNotSpecified").then(function(e){a.Notification.warning(e,t._config.chart)});r=_.JsUtil.filterText(this._input_text.val()),e.text=r.length?r:e.text,o.text.fillColor=this._input_textColor.spectrum("get").toRgbString(),o.text.fontFamily=this._input_textFont.selectpicker("val"),o.text.fontSize=parseInt(this._input_textSize.selectpicker("val"),10),o.text.fontWeight=this._textStylesChooser.getStyle("b")?"bold":"normal",o.text.fontStyle=this._textStylesChooser.getStyle("i")?"italic":"normal",o.text.decoration=this._textStylesChooser.getStyle("u")?"underline":"";break;case _.BalloonDrawing.className:if(!this._validateInputValue())return void _.Localization.localizeText(this._config.chart,"drawing.all.notification.textIsNotSpecified").then(function(e){a.Notification.warning(e,t._config.chart)});r=_.JsUtil.filterText(this._input_text.val()),e.text=r.length?r:e.text,o.text.fillColor=this._input_textColor.spectrum("get").toRgbString(),o.text.fontFamily=this._input_textFont.selectpicker("val"),o.text.fontSize=parseInt(this._input_textSize.selectpicker("val"),10),o.text.fontWeight=this._textStylesChooser.getStyle("b")?"bold":"normal",o.text.fontStyle=this._textStylesChooser.getStyle("i")?"italic":"normal",o.text.decoration=this._textStylesChooser.getStyle("u")?"underline":"",o.line=n.theme,o.line.strokeEnabled=this._chk_lineEnabled.isChecked(),o.fill.fillEnabled=this._fillPropertiesHandler.isEnabled,o.fill.fillColor=this._fillPropertiesHandler.theme.fillColor;break;case _.MeasureDrawing.className:o.line=n.theme,o.line.strokeEnabled=this._chk_lineEnabled.isChecked(),o.border=n.theme,o.border.strokeEnabled=this._chk_lineEnabled.isChecked(),o.fill.fillEnabled=this._fillPropertiesHandler.isEnabled,o.fill.fillColor=this._fillPropertiesHandler.theme.fillColor,o.balloon.fill.fillEnabled=this._fillPropertiesHandler.isEnabled,o.balloon.fill.fillColor=this._fillPropertiesHandler.theme.fillColor,o.balloon.text.fillColor=this._input_textColor.spectrum("get").toRgbString(),o.balloon.text.fontFamily=this._input_textFont.selectpicker("val"),o.balloon.text.fontSize=parseInt(this._input_textSize.selectpicker("val"),10);break;case _.FreeHandDrawing.className:o.line=n.theme;break;case _.TrendAngleDrawing.className:o.line=n.theme,i={colorPicker:this._input_horizontalLineColor,widthInput:this._input_horizontalLineWidth,lineStyleDropdown:this._input_horizontalLineStyle},n=new a.LinePropertiesHandler(i),o.horizontalLine=n.theme,i={colorPicker:this._input_arcColor,widthInput:this._input_arcWidth,lineStyleDropdown:this._input_arcStyle},n=new a.LinePropertiesHandler(i),o.arc=n.theme}this._config.drawing.theme=o,this._tooltipView&&this._tooltipView.apply(),this._config.drawing.chartPanel.update(),this._isApplyClicked=!0}},d.prototype._validateInputValue=function(){switch(this._config.drawing.className){case _.ImageDrawing.className:if(_.JsUtil.filterText(this._input_imageUrl.val()).length)break;return!1;case _.TextDrawing.className:case _.BalloonDrawing.className:if(_.JsUtil.filterText(this._input_text.val()))break;return!1}return!0},d.prototype._loadTooltipView=function(t){var i=this;a.ViewLoader.tooltipView(function(e){e.container=i._tab_tooltip,e.setValues(t),i._tooltipView=e,i._tooltipView.chart=i._config.chart,i._config.chart.localize(i._dialog)})},d.prototype._initFields=function(){this._title=this._dialog.find(e+"title"),this._tabItemsContainer=this._dialog.find(".scxTabs"),this._tabPanelsContainer=this._dialog.find(".scxTabsContent"),this._tab_tooltip=this._dialog.find(c+"tooltip"),this._panelFigure=this._dialog.find(l+"figure"),this._panelFigureLine=this._dialog.find(s+"linePanel"),this._panelFigureHorizontalLine=this._dialog.find(s+"horizontalLinePanel"),this._panelFigureArc=this._dialog.find(s+"arcPanel"),this._panelFigureLineEnabled=this._dialog.find(s+"lineEnabled"),this._panelFigureFill=this._dialog.find(s+"fillColorPanel"),this._panelFigureFillEnabled=this._dialog.find(s+"fillColorPanel_fillEnabled"),this._panelFigureFill2=this._dialog.find(s+"fillColorPanel2"),this._panelFigureFill2Enabled=this._dialog.find(s+"fillColorPanel2_fillEnabled"),this._panelFigureLabel=this._dialog.find(s+"label"),this._panelPoints=this._dialog.find(l+"points"),this._panelText=this._dialog.find(l+"text"),this._panelImage=this._dialog.find(l+"image"),this._input_lineColor=this._dialog.find(i+"lineColor"),this._input_lineWidth=this._dialog.find(i+"lineWidth"),this._input_lineStyle=this._dialog.find(i+"lineStyle"),this._input_fillColor=this._dialog.find(i+"fillColor"),this._input_fillColor2=this._dialog.find(i+"fillColor2"),this._input_labelText=this._dialog.find(i+"labelText"),this._input_labelColor=this._dialog.find(i+"labelColor"),this._input_labelFont=this._dialog.find(i+"labelFont"),this._input_labelSize=this._dialog.find(i+"labelSize"),this._input_horizontalLineColor=this._dialog.find(i+"horizontalLineColor"),this._input_horizontalLineWidth=this._dialog.find(i+"horizontalLineWidth"),this._input_horizontalLineStyle=this._dialog.find(i+"horizontalLineStyle"),this._input_arcColor=this._dialog.find(i+"arcColor"),this._input_arcWidth=this._dialog.find(i+"arcWidth"),this._input_arcStyle=this._dialog.find(i+"arcStyle"),this._input_text=this._dialog.find(i+"text"),this._input_textColor=this._dialog.find(i+"textColor"),this._input_textFont=this._dialog.find(i+"textFont"),this._input_textSize=this._dialog.find(i+"textSize"),this._input_textColor=this._dialog.find(i+"textColor"),this._inputs_textStyles=this._dialog.find(".scxDrawingDialog_textStyles"),this._textStylesChooser=null,this._input_textBackColor=this._dialog.find(i+"textBackgroundColor"),this._input_textBorderColor=this._dialog.find(i+"textBorderColor"),this._input_imageUrl=this._dialog.find(i+"imageURL"),this._input_imagePreview=this._dialog.find(e+"imagePreview"),this._chk_lineEnabledHTMLObj=this._dialog.find(r+"lineColor"),this._chk_fillEnabledHTMLObj=this._dialog.find(r+"fillColor"),this._chk_fill2EnabledHTMLObj=this._dialog.find(r+"fillColor2"),this._chk_textBackgroundEnabledHTMLObj=this._dialog.find(r+"textBackgroundColor"),this._chk_textBorderEnabledHTMLObj=this._dialog.find(r+"textBorderColor"),this._label_lineEnabled=this._dialog.find(n+"lineColor"),this._label_fillEnabled=this._dialog.find(n+"fillColor"),this._label_fill2Enabled=this._dialog.find(n+"fillColor2"),this._label_textBackgroundEnabled=this._dialog.find(n+"textBackgroundColor"),this._label_textBorderEnabled=this._dialog.find(n+"textBorderColor"),this._input_magnetTo=this._dialog.find(i+"magnetTo"),this._input_magnetMode=this._dialog.find(i+"magnetMode")},d._numericFieldConfig={showArrows:!1,maxValue:10,minValue:1,value:1},d._switcherySettings={color:"rgba(72, 149, 245, 0.2)",secondaryColor:"rgba(16, 17, 20, 1)",jackColor:"rgba(72, 149, 245, 1)",jackSecondaryColor:"rgba(81, 83, 90, 1)",className:"scx_switchery",disabled:!1,disabledOpacity:.5,speed:"0.4s"},d);function d(e){e=t.call(this,e)||this;return e._isApplyClicked=!1,e._initFields(),e._init(),e}a.DrawingSettingsDialog=h}(_.UI||(_.UI={}))}(StockChartX=StockChartX||{}),this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}()),__awaiter=this&&this.__awaiter||function(r,a,s,l){return new(s=s||Promise)(function(e,t){function i(e){try{o(l.next(e))}catch(e){t(e)}}function n(e){try{o(l.throw(e))}catch(e){t(e)}}function o(t){t.done?e(t.value):new s(function(e){e(t.value)}).then(i,n)}o((l=l.apply(r,a||[])).next())})},__generator=this&&this.__generator||function(n,o){var r,a,s,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(i){return function(e){var t=[i,e];if(r)throw new TypeError("Generator is already executing.");for(;l;)try{if(r=1,a&&(s=a[2&t[0]?"return":t[0]?"throw":"next"])&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[0,s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return l.label++,{value:t[1],done:!1};case 5:l.label++,a=t[1],t=[0];continue;case 7:t=l.ops.pop(),l.trys.pop();continue;default:if(!(s=0<(s=l.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){l=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3])){l.label=t[1];break}if(6===t[0]&&l.label<s[1]){l.label=s[1],s=t;break}if(s&&l.label<s[2]){l.label=s[2],l.ops.push(t);break}s[2]&&l.ops.pop(),l.trys.pop();continue}t=o.call(n,l)}catch(e){t=[6,e],a=0}finally{r=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},__extends=(!function(_){!function(l){"use strict";var c;(s=c=c||{})[s.LEVELS=0]="LEVELS",s[s.TOOLTIP=1]="TOOLTIP",s[s.POINTS=2]="POINTS";var t,i="#scxFibonacciDrawingDialog_",h=".scxFibonacciDrawingDialog_input_",e="#scxFibonacciDrawingDialog_tab_",n=".scxFibonacciDrawingDialog_chk_",o=".scxFibonacciDrawingDialog_panel_figure_",r=".scxFibonacciDrawingDialog_panel_",a="scxSpectrumDrawingDialog",s=(t=l.Dialog,__extends(d,t),d.prototype.show=function(e){this.initDialog(e)&&(this._setDialogTitle(),this._setDrawingConfig(this._config.drawing),this._tabs.activate(0),this._setDialogFields(),t.prototype.show.call(this,e))},d.prototype.hide=function(){this._clearDialogFields(),t.prototype.hide.call(this)},d.prototype._init=function(){var o=this,e=(this._tabs=new l.Tabs({tabsContainer:this._tabItemsContainer,panelsContainer:this._tabPanelsContainer,onChange:function(e){o.resize()}}),this._input_magnetTo.selectpicker({container:"body"}),this._input_magnetMode.selectpicker({container:"body"}),$("body").on("scxSwitcherChanged",function(e,t){var i=$(t.target),n=!!t.checked;i.is(o._chk_lineEnabledHTMLObj)&&(t=$(t.target).index(".scxFibonacciDrawingDialog_chk_lineEnable"),o._setLineState(n,t)),i.is(o._chk_trendLineEnabledHTMLObj)&&o._setTrendLineState(n),i.is(o._chk_levelsValueEnabledHTMLObj)&&(o._showLevelValues=n,o._setLevelsState(n)),i.is(o._chk_levelsPriceEnabledHTMLObj)&&(o._setLabelState(o._label_levelPrices,n),o._showLevelPrices=n),i.is(o._chk_levelsPercentEnabledHTMLObj)&&(o._setLabelState(o._label_levelPercents,n),o._showLevelPercents=n),i.is(o._chk_linesReverseEnabledHTMLObj)&&(o._setLabelState(o._label_reverse,n),o._reverse=n),i.is(o._chk_extendLinesLeftEnabledHTMLObj)&&(o._setLabelState(o._label_extendLinesLeft,n),o._setLevelLinesExtension(n,_.FibonacciLevelLineExtension.RIGHT,_.FibonacciLevelLineExtension.LEFT)),i.is(o._chk_extendLinesRightEnabledHTMLObj)&&(o._setLabelState(o._label_extendLinesRight,n),o._setLevelLinesExtension(n,_.FibonacciLevelLineExtension.LEFT,_.FibonacciLevelLineExtension.RIGHT)),i.is(o._chk_extendLinesTopEnabledHTMLObj)&&(o._setLabelState(o._label_extendLinesTop,n),o._setLevelLinesExtension(n,_.FibonacciLevelLineExtension.BOTTOM,_.FibonacciLevelLineExtension.TOP)),i.is(o._chk_extendLinesBottomEnabledHTMLObj)&&(o._setLabelState(o._label_extendLinesBottom,n),o._setLevelLinesExtension(n,_.FibonacciLevelLineExtension.TOP,_.FibonacciLevelLineExtension.BOTTOM)),i.is(o._chk_backgroundEnabledHTMLObj)&&(o._setLabelState(o._label_background,n),o._showLevelBackgrounds=n)}),this._dialog.find(i+"btn_resetToDefaults").on("click",function(){o.resetToDefaults()}),this._dialog.find(i+"btn_save").on("click",function(){o._save()}),this._dialog.find(i+"btn_apply").on("click",function(){o._apply()}),this._dialog.find(r+"addLinePanel").on("click",function(){o._addNewLinePanel()}),this._panelFigureTrendLinePanel.find(".scxFibonacciDrawingDialog_chk_trendLine")),e=(this._chk_trendLineEnabled=new Switchery(e[0],d._switcherySettings),this._dialog.find(n+"extendLinesLeft")),e=(this._chk_extendLinesLeftEnabled=new Switchery(e[0],d._switcherySettings),this._dialog.find(n+"extendLinesRight")),e=(this._chk_extendLinesRightEnabled=new Switchery(e[0],d._switcherySettings),this._dialog.find(n+"extendLinesTop")),e=(this._chk_extendLinesTopEnabled=new Switchery(e[0],d._switcherySettings),this._dialog.find(n+"extendLinesBottom")),e=(this._chk_extendLinesBottomEnabled=new Switchery(e[0],d._switcherySettings),this._dialog.find(n+"linesReverse")),e=(this._chk_linesReverseEnabled=new Switchery(e[0],d._switcherySettings),this._dialog.find(n+"background"));this._chk_backgroundEnabled=new Switchery(e[0],d._switcherySettings)},d.prototype._initFields=function(){this._title=this._dialog.find(i+"title"),this._tabItemsContainer=this._dialog.find(".scxTabs"),this._tabPanelsContainer=this._dialog.find(".scxTabsContent"),this._panelFigure=this._dialog.find(r+"figure"),this._panelFigureLine=this._dialog.find(o+"linePanel"),this._panelFigureTrendLinePanel=this._dialog.find(o+"trendLinePanel"),this._panelFigureLevelParametersPanel=this._dialog.find(o+"levelParametersPanel"),this._panelFigureRetracementsOptionsPanel=this._dialog.find(o+"retracementsOptionsPanel"),this._panelFigureLabelsParametersPanel=this._dialog.find(o+"labelsParametersPanel"),this._tabTooltip=this._dialog.find(e+"tooltip"),this._panelPoints=this._dialog.find(r+"points"),this._input_magnetTo=this._dialog.find(h+"magnetTo"),this._input_magnetMode=this._dialog.find(h+"magnetMode")},d.prototype._setDialogFields=function(e){this._addLinePanel(),this._generateLevelParameters(),this._defineDomObjects(),this._setTrendLineParameters(),this._setRetracementsOptions(),this._setLevelParameters(),this._setLabelsParameters(),this._setBackgroundParameters(),this._setValues(e),this._switchView()},d.prototype._setDrawingConfig=function(e){this._showTrendLine=e.showTrendLine,this._showLevelValues=e.showLevelValues,this._showLevelPrices=e.showLevelPrices,this._showLevelPercents=e.showLevelPercents,this._showLevelBackgrounds=e.showLevelBackgrounds,this._levelLinesExtension=e.levelLinesExtension,this._reverse=e.reverse,this._levelTextHorPosition=e.levelTextHorPosition,this._levelTextVerPosition=e.levelTextVerPosition,this._levels=$.extend(!0,[],e.levels)},d.prototype._setLabelState=function(e,t){t?e.removeClass("disabled"):e.addClass("disabled")},d.prototype._setLevelLinesExtension=function(e,t,i){e?this._levelLinesExtension=this._levelLinesExtension===t?_.FibonacciLevelLineExtension.BOTH:i:this._levelLinesExtension===_.FibonacciLevelLineExtension.BOTH?this._levelLinesExtension=t:this._levelLinesExtension=_.FibonacciLevelLineExtension.NONE},d.prototype._setLineState=function(e,t){var i=this._panelFigureLine.find(h+"lineColor").eq(t),n=this._panelFigureLine.find(h+"lineLevel").eq(t),o=this._panelFigureLine.find(h+"lineWidth").eq(t),r=this._panelFigureLine.find(h+"lineStyle:even").eq(t);e?(i.spectrum("enable"),r.removeAttr("disabled"),r.selectpicker("refresh"),o.scxNumericField("enable"),n.scxNumericField("enable"),this._levels[t].visible=!0):(i.spectrum("disable"),r.attr("disabled","disabled"),r.selectpicker("refresh"),o.scxNumericField("disable"),n.scxNumericField("disable"),this._levels[t].visible=!1),this._config.chart&&this._config.chart.localize(this._panelFigureLine)},d.prototype._setTrendLineState=function(e){e?(this._label_trendLine.removeClass("disabled"),this._input_trendLineColor.spectrum("enable"),this._input_trendLineWidth.scxNumericField("enable"),this._input_trendLineStyle.removeAttr("disabled"),this._input_trendLineStyle.selectpicker("refresh"),this._chk_trendLineEnabled.isChecked()||this._chk_trendLineEnabled.setPosition(!0),this._showTrendLine=!0):(this._label_trendLine.addClass("disabled"),this._input_trendLineColor.spectrum("disable"),this._input_trendLineWidth.scxNumericField("disable"),this._input_trendLineStyle.attr("disabled","disabled"),this._input_trendLineStyle.selectpicker("refresh"),this._chk_trendLineEnabled.isChecked()&&this._chk_trendLineEnabled.setPosition(!0),this._showTrendLine=!1),this._config&&this._config.chart.localize(this._panelFigureTrendLinePanel)},d.prototype._setLevelsState=function(e){e?(this._label_levels.removeClass("disabled"),this._chk_levelsPriceEnabled.isChecked()&&this._label_levelPrices.removeClass("disabled"),this._chk_levelsPercentEnabled.isChecked()&&this._label_levelPercents.removeClass("disabled"),this._chk_levelsPriceEnabled.enable(),this._chk_levelsPercentEnabled.enable()):(this._label_levels.addClass("disabled"),this._label_levelPrices.addClass("disabled"),this._label_levelPercents.addClass("disabled"),this._chk_levelsPriceEnabled.disable(),this._chk_levelsPercentEnabled.disable()),d._switcherySettings.disabled=!1},d.prototype._switchView=function(){switch(this._panelFigureLine.show(),this._panelFigure.show(),this._config.drawing.className){case _.FibonacciArcsDrawing.className:return this._panelFigureRetracementsOptionsPanel.hide(),this._levelsPriceEnabled.hide(),this._labelsHorEnabled.show(),void this._panelFigureTrendLinePanel.show();case _.FibonacciEllipsesDrawing.className:return this._panelFigureRetracementsOptionsPanel.hide(),this._labelsHorEnabled.show(),this._levelsPriceEnabled.hide(),void this._panelFigureTrendLinePanel.show();case _.FibonacciTimeZonesDrawing.className:return this._levelsExtendHorEnabled.hide(),this._levelsExtendVerEnabled.show(),this._levelsReverseEnabled.hide(),this._panelFigureRetracementsOptionsPanel.show(),this._levelsPriceEnabled.hide(),this._levelsPercentEnabled.hide(),void this._panelFigureTrendLinePanel.show();case _.FibonacciRetracementsDrawing.className:return this._levelsExtendHorEnabled.show(),this._levelsExtendVerEnabled.hide(),this._levelsReverseEnabled.show(),this._panelFigureRetracementsOptionsPanel.show(),void this._panelFigureTrendLinePanel.show();case _.FibonacciFanDrawing.className:return this._panelFigureRetracementsOptionsPanel.hide(),this._panelFigureTrendLinePanel.hide(),void this._labelsHorEnabled.hide();case _.FibonacciExtensionsDrawing.className:return this._levelsExtendHorEnabled.show(),this._levelsExtendVerEnabled.hide(),this._levelsReverseEnabled.show(),this._panelFigureRetracementsOptionsPanel.show(),void this._panelFigureTrendLinePanel.show();default:return}},d.prototype._setDialogTitle=function(){return __awaiter(this,void 0,void 0,function(){var t,i;return __generator(this,function(e){switch(e.label){case 0:return t=this._config.drawing.className,[4,_.Localization.localizeText(this._config.chart,"drawing."+t+".name",{defaultValue:t})];case 1:return t=e.sent(),[4,_.Localization.localizeText(this._config.chart,"drawing.all.dialog.title",{replace:{drawingName:t}})];case 2:return i=e.sent(),this._title.text(i),[2]}})})},d.prototype._setValues=function(e){var t=this._config.drawing;if(!e||this._tabs.activeIndex()===c.LEVELS){for(var i=0;i<this._levels.length;i++){var n=this._levels[i],o=t.className===_.FibonacciTimeZonesDrawing.className,o=(this._input_lineLevel[i].value=o?n.value:n.value.toFixed(3),this._dialog.find(h+"lineColor").eq(i)),r=this._dialog.find(h+"lineWidth").eq(i),a=this._dialog.find(h+"lineStyle:even").eq(i),n=n.theme&&n.theme.line||t.actualTheme&&t.actualTheme.line,s={colorPicker:o,widthInput:r,lineStyleDropdown:a};new l.LinePropertiesHandler(s).theme=n}t.className!==_.FibonacciFanDrawing.className&&(s={colorPicker:this._input_trendLineColor,widthInput:this._input_trendLineWidth,lineStyleDropdown:this._input_trendLineStyle},new l.LinePropertiesHandler(s).theme=t.actualTheme.trendLine)}e&&this._tabs.activeIndex()!==c.TOOLTIP||this._loadTooltipView(t.tooltip),e&&this._tabs.activeIndex()!==c.POINTS||(this._input_magnetMode.selectpicker("val",this._config.drawing.magnetMode).selectpicker("refresh"),this._input_magnetTo.selectpicker("val",this._config.drawing.magnetPoint).selectpicker("refresh"),this._coordinatePanel||(this._coordinatePanel=new l.CoordinatePanel(this._panelPoints)),this._coordinatePanel.setValues(this._config.drawing)),this._config.chart.localize(this._dialog)},d.prototype._getValues=function(){for(var e=0;e<this._levels.length;e++){var t=this._levels[e],i=(t.value=parseFloat(this._input_lineLevel[e].value),this._dialog.find(h+"lineColor").eq(e)),n={colorPicker:i,widthInput:this._dialog.find(h+"lineWidth").eq(e),lineStyleDropdown:this._dialog.find(h+"lineStyle:even").eq(e)},o=new l.LinePropertiesHandler(n),i=(t.theme||(t.theme={}),t.theme.line||(t.theme.line={}),t.theme.fill||(t.theme.fill={}),t.theme.text||(t.theme.text=this._config.drawing.actualTheme.text?$.extend(!0,{},this._config.drawing.actualTheme.text):{}),t.theme.line=o.theme,i.spectrum("get").toRgb());t.theme.text.fillColor=tinycolor(i).toRgbString(),i.a=.3,t.theme.fill.fillColor=tinycolor(i).toRgbString()}var r=this._config.drawing.theme=$.extend(!0,{},this._config.drawing.actualTheme);this._config.drawing.className!==_.FibonacciFanDrawing.className&&(n={colorPicker:this._input_trendLineColor,widthInput:this._input_trendLineWidth,lineStyleDropdown:this._input_trendLineStyle},o=new l.LinePropertiesHandler(n),r.trendLine=o.theme),this._levelTextHorPosition=this._input_labelsPosition.val(),this._levelTextVerPosition=this._input_labelsTextPosition.val()},d.prototype.resetToDefaults=function(){var e,t,i=this._config.drawing.defaultTheme;if(this._tabs.activeIndex()===c.LEVELS){switch(this._config.drawing.className){case _.FibonacciArcsDrawing.className:e=_.FibonacciArcsDrawing.defaults;break;case _.FibonacciEllipsesDrawing.className:e=_.FibonacciEllipsesDrawing.defaults;break;case _.FibonacciRetracementsDrawing.className:e=_.FibonacciRetracementsDrawing.defaults;break;case _.FibonacciFanDrawing.className:e=_.FibonacciFanDrawing.defaults;break;case _.FibonacciExtensionsDrawing.className:e=_.FibonacciExtensionsDrawing.defaults;break;case _.FibonacciTimeZonesDrawing.className:e=_.FibonacciTimeZonesDrawing.defaults}t=$.extend(!1,_.FibonacciDrawingBase.defaults,e),this._clearDialogFields(),this._setDrawingConfig(t),this._setDialogFields(!0),this.resize(),this._config.drawing.className!==_.FibonacciFanDrawing.className&&(this._input_trendLineColor.spectrum("set",i.trendLine.strokeColor),this._input_trendLineWidth.scxNumericField("setValue",i.trendLine.width),this._input_trendLineStyle.selectpicker("val",i.trendLine.lineStyle).selectpicker("refresh"))}this._tabs.activeIndex()===c.TOOLTIP&&this._tooltipView.resetToDefaults(),this._tabs.activeIndex()===c.POINTS&&(this._input_magnetMode.selectpicker("val",_.MagnetMode.NONE).selectpicker("refresh"),this._input_trendLineStyle.selectpicker("val",i.trendLine.lineStyle).selectpicker("refresh"),this._input_magnetTo.selectpicker("val",_.MagnetPoint.BAR).selectpicker("refresh"),this._coordinatePanel.setValues(this._config.drawing)),this._config.chart.localize(this._dialog)},d.prototype._apply=function(){var e;this._config.drawing.chart&&(e=this._config.drawing,this._getValues(),this._tooltipView&&this._tooltipView.apply(),e.magnetMode?(e.magnetPoint=this._input_magnetTo.val(),e.magnetMode=this._input_magnetMode.val()):(e.magnetPoint=_.MagnetPoint.BAR,e.magnetMode=_.MagnetMode.NONE),this._coordinatePanel.apply(),e.showTrendLine=this._showTrendLine,e.showLevels=this._showLevelValues,e.showLevelPrices=this._showLevelPrices,e.showLevelPercents=this._showLevelPercents,e.showLevelBackgrounds=this._showLevelBackgrounds,void 0!==e.levelLinesExtension&&(e.levelLinesExtension=this._levelLinesExtension),void 0!==e.reverse&&(e.reverse=this._reverse),e.levelTextHorPosition=this._levelTextHorPosition,e.levelTextVerPosition=this._levelTextVerPosition,e.levels=this._levels,e.chartPanel.update())},d.prototype._save=function(){this._apply(),this.hide()},d.prototype._addNewLinePanel=function(){var e=this._config.drawing.actualTheme;this._getValues(),this._levels.push({value:0,visible:!0,theme:$.extend(!0,{},{line:e.line})}),this._clearLinePanel(),this._addLinePanel(),this._setValues(!0),this.resize()},d.prototype._addLinePanel=function(){var e=this;this._levels.forEach(function(){e._generateLinePanel()}),this._defineDomLevelObjects(),this._setLinePanelsProperties()},d.prototype._deleteLinePanel=function(e){this._getValues();e=$(e.currentTarget).index(".scxFibonacciDrawingDialog_panel_deleteLinePanel");this._levels.splice(e,1),this._panelFigureLine.eq(e).remove(),this._clearLinePanel(),this._addLinePanel(),this._setValues(!0),this.resize()},d.prototype._clearDialogFields=function(){$(".scxDropdown").removeClass("open"),this._clearLinePanel(),this._clearDialogParameters()},d.prototype._clearLinePanel=function(){this._panelFigureLine.remove(),$("body").find(h+"lineColor"+a).remove()},d.prototype._clearDialogParameters=function(){this._panelFigureLevelParameters.remove()},d.prototype._setBackgroundParameters=function(){this._setSwitcheryPosition(this._showLevelBackgrounds,this._chk_backgroundEnabled),this._setLabelState(this._label_background,this._showLevelBackgrounds)},d.prototype._setLabelsParameters=function(){this._input_labelsPosition.selectpicker({container:"body"}),this._input_labelsPosition.selectpicker("val",this._levelTextHorPosition).selectpicker("refresh"),this._input_labelsTextPosition.selectpicker({container:"body"}),this._input_labelsTextPosition.selectpicker("val",this._levelTextVerPosition).selectpicker("refresh")},d.prototype._setRetracementsOptions=function(){switch(this._setSwitcheryPosition(this._reverse,this._chk_linesReverseEnabled),this._setLabelState(this._label_reverse,this._reverse),this._levelLinesExtension){case _.FibonacciLevelLineExtension.NONE:return this._setSwitcheryPosition(!1,this._chk_extendLinesLeftEnabled),this._setSwitcheryPosition(!1,this._chk_extendLinesRightEnabled),this._setSwitcheryPosition(!1,this._chk_extendLinesTopEnabled),this._setSwitcheryPosition(!1,this._chk_extendLinesBottomEnabled),this._setLabelState(this._label_extendLinesLeft,!1),this._setLabelState(this._label_extendLinesRight,!1),this._setLabelState(this._label_extendLinesTop,!1),void this._setLabelState(this._label_extendLinesBottom,!1);case _.FibonacciLevelLineExtension.LEFT:return this._setSwitcheryPosition(!0,this._chk_extendLinesLeftEnabled),void this._setLabelState(this._label_extendLinesLeft,!0);case _.FibonacciLevelLineExtension.RIGHT:return this._setSwitcheryPosition(!0,this._chk_extendLinesRightEnabled),void this._setLabelState(this._label_extendLinesRight,!0);case _.FibonacciLevelLineExtension.TOP:return this._setSwitcheryPosition(!0,this._chk_extendLinesTopEnabled),void this._setLabelState(this._label_extendLinesTop,!0);case _.FibonacciLevelLineExtension.BOTTOM:return this._setSwitcheryPosition(!0,this._chk_extendLinesBottomEnabled),void this._setLabelState(this._label_extendLinesBottom,!0);case _.FibonacciLevelLineExtension.BOTH:return this._setSwitcheryPosition(!0,this._chk_extendLinesLeftEnabled),this._setSwitcheryPosition(!0,this._chk_extendLinesRightEnabled),this._setSwitcheryPosition(!0,this._chk_extendLinesTopEnabled),this._setSwitcheryPosition(!0,this._chk_extendLinesBottomEnabled),this._setLabelState(this._label_extendLinesLeft,!0),this._setLabelState(this._label_extendLinesRight,!0),this._setLabelState(this._label_extendLinesTop,!0),void this._setLabelState(this._label_extendLinesBottom,!0);default:return}},d.prototype._setSwitcheryPosition=function(e,t){e?t.isChecked()||t.setPosition(!0):t.isChecked()&&t.setPosition(!0)},d.prototype._setLevelParameters=function(){var e=this._dialog.find(n+"levelsValue"),e=new Switchery(e[0],d._switcherySettings),t=this._dialog.find(n+"levelsPrice"),t=(this._chk_levelsPriceEnabled=new Switchery(t[0],d._switcherySettings),this._dialog.find(n+"levelsPercent"));this._chk_levelsPercentEnabled=new Switchery(t[0],d._switcherySettings),this._chk_levelsPriceEnabled.setPosition(this._showLevelPrices),this._chk_levelsPercentEnabled.setPosition(this._showLevelPercents),e.setPosition(this._showLevelValues),this._showLevelValues||this._setLevelsState(this._showLevelValues)},d.prototype._setTrendLineParameters=function(){this._input_trendLineWidth.scxNumericField(d._numericFieldConfig),this._setTrendLineState(this._showTrendLine)},d.prototype._setLinePanelsProperties=function(){this._config.drawing.className===_.FibonacciTimeZonesDrawing.className?this._input_lineLevel.scxNumericField(d._numericTimeZoneFieldConfig):this._input_lineLevel.scxNumericField(d._numericDoubleFieldConfig),this._input_lineWidth.scxNumericField(d._numericFieldConfig),this._input_lineStyle.selectpicker({container:"body"}),this._dialog.find("#scxFibonacciDrawingDialog_panel_levels .scxSpectrum").scx().colorPicker({containerClassName:a,localStorageKey:"scxThemeDialog_spectrum",showAlpha:!0});for(var e=Array.prototype.slice.call(this._panelFigureLine.find(".js-switch")),t=0;t<e.length;t++){var i=new Switchery(e[t],d._switcherySettings);void 0===this._levels[t].visible&&(this._levels[t].visible=!0),i.setPosition(this._levels[t].visible),this._setLineState(this._levels[t].visible,t)}},d.prototype._generateLinePanel=function(){$('<tr class="scxFibonacciDrawingDialog_panel_figure_linePanel"><td><span class="scxFibonacciDrawingDialog_panel_figure_lineEnabled"><input class="scxFibonacciDrawingDialog_chk_lineEnable js-switch" type="checkbox"/></span><input class="scxFibonacciDrawingDialog_input_lineLevel form-control" type="text"><input class="scxFibonacciDrawingDialog_input_lineColor scxSpectrum" type="text"><input class="scxFibonacciDrawingDialog_input_lineWidth form-control" type="text"><select class="scxFibonacciDrawingDialog_input_lineStyle scxLineStyleSelector scxDropdown"><option value="solid" data-manuali18="graphics.line.style.solid">&nbsp;</option><option value="dash" data-manuali18="graphics.line.style.dash">&nbsp;</option><option value="dot" data-manuali18="graphics.line.style.dot">&nbsp;</option><option value="dash-dot" data-manuali18="graphics.line.style.dashDot">&nbsp;</option></select><a href="#" aria-hidden="true" class="close scxFibonacciDrawingDialog_panel_deleteLinePanel">&#215;</a></td></tr>').appendTo(this._panelFigure.find("table"))},d.prototype._generateLevelParameters=function(){$('<tr class="scxFibonacciDrawingDialog_panel_figure_levelParameters"><td><span class="scxFibonacciDrawingDialog_panel_figure_lineEnabled"><input class="scxFibonacciDrawingDialog_chk_levelsValue js-switch" type="checkbox"/></span><label class="scxFibonacciDrawingDialog_label_levels" data-i18n="drawing.all.dialog.levels"></label><div class="scxFibonacciDrawingDialog_levelsPrice"><span class="scxFibonacciDrawingDialog_panel_figure_lineEnabled"><input class="scxFibonacciDrawingDialog_chk_levelsPrice js-switch" type="checkbox"/></span><label class="scxFibonacciDrawingDialog_label_prices" data-i18n="drawing.all.dialog.prices"></label> </div><div class="scxFibonacciDrawingDialog_levelsPercent"><span class="scxFibonacciDrawingDialog_panel_figure_lineEnabled"><input class="scxFibonacciDrawingDialog_chk_levelsPercent js-switch" type="checkbox"/></span><label class="scxFibonacciDrawingDialog_label_percents" data-i18n="drawing.all.dialog.percents"></label></div></td></tr>').appendTo(this._panelFigureLevelParametersPanel.find("table"))},d.prototype._defineDomObjects=function(){var e=o,t=h,i=n;this._panelFigureLevelParameters=this._dialog.find(e+"levelParameters"),this._input_trendLineColor=this._panelFigureTrendLinePanel.find(t+"lineColor"),this._input_trendLineWidth=this._panelFigureTrendLinePanel.find(t+"lineWidth"),this._input_trendLineStyle=this._panelFigureTrendLinePanel.find(t+"lineStyle"),this._input_labelsPosition=this._panelFigureLabelsParametersPanel.find(t+"labelsPosition"),this._input_labelsTextPosition=this._panelFigureLabelsParametersPanel.find(t+"labelsTextPosition"),this._chk_trendLineEnabledHTMLObj=this._dialog.find(i+"trendLine"),this._chk_levelsValueEnabledHTMLObj=this._dialog.find(i+"levelsValue"),this._chk_levelsPriceEnabledHTMLObj=this._dialog.find(i+"levelsPrice"),this._chk_levelsPercentEnabledHTMLObj=this._dialog.find(i+"levelsPercent"),this._chk_linesReverseEnabledHTMLObj=this._dialog.find(i+"linesReverse"),this._chk_extendLinesLeftEnabledHTMLObj=this._dialog.find(i+"extendLinesLeft"),this._chk_extendLinesRightEnabledHTMLObj=this._dialog.find(i+"extendLinesRight"),this._chk_extendLinesTopEnabledHTMLObj=this._dialog.find(i+"extendLinesTop"),this._chk_extendLinesBottomEnabledHTMLObj=this._dialog.find(i+"extendLinesBottom"),this._chk_backgroundEnabledHTMLObj=this._dialog.find(i+"background"),this._levelsPriceEnabled=this._dialog.find(".scxFibonacciDrawingDialog_levelsPrice"),this._levelsPercentEnabled=this._dialog.find(".scxFibonacciDrawingDialog_levelsPercent"),this._levelsExtendHorEnabled=this._dialog.find(".scxFibonacciDrawingDialog_extendHor"),this._levelsExtendVerEnabled=this._dialog.find(".scxFibonacciDrawingDialog_extendVer"),this._labelsHorEnabled=this._dialog.find(".scxFibonacciDrawingDialog_labelsPosition"),this._levelsReverseEnabled=this._dialog.find(".scxFibonacciDrawingDialog_reverse"),this._label_trendLine=this._dialog.find(".scxFibonacciDrawingDialog_label_trendLine"),this._label_extendLinesLeft=this._dialog.find(".scxFibonacciDrawingDialog_label_extendLinesLeft"),this._label_extendLinesRight=this._dialog.find(".scxFibonacciDrawingDialog_label_extendLinesRight"),this._label_extendLinesTop=this._dialog.find(".scxFibonacciDrawingDialog_label_extendLinesTop"),this._label_extendLinesBottom=this._dialog.find(".scxFibonacciDrawingDialog_label_extendLinesBottom"),this._label_reverse=this._dialog.find(".scxFibonacciDrawingDialog_label_linesReverse"),this._label_levels=this._dialog.find(".scxFibonacciDrawingDialog_label_levels"),this._label_levelPercents=this._dialog.find(".scxFibonacciDrawingDialog_label_percents"),this._label_levelPrices=this._dialog.find(".scxFibonacciDrawingDialog_label_prices"),this._label_background=this._dialog.find(".scxFibonacciDrawingDialog_label_background")},d.prototype._loadTooltipView=function(t){var i=this;l.ViewLoader.tooltipView(function(e){e.container=i._tabTooltip,e.setValues(t),i._tooltipView=e,i._tooltipView.chart=i._config.chart,i._config.chart.localize(i._dialog)})},d.prototype._defineDomLevelObjects=function(){var t=this;this._panelFigureLine=this._dialog.find(o+"linePanel"),this._input_lineLevel=this._dialog.find(h+"lineLevel"),this._input_lineWidth=this._dialog.find(h+"lineWidth"),this._input_lineStyle=this._dialog.find(h+"lineStyle"),this._chk_lineEnabledHTMLObj=this._dialog.find(n+"lineEnable"),this._dialog.find(r+"deleteLinePanel").on("click",function(e){t._deleteLinePanel(e)})},d._numericFieldConfig={showArrows:!1,maxValue:10,minValue:1,value:1},d._numericDoubleFieldConfig={showArrows:!1,priceDecimals:3,maxValue:500,minValue:0,value:1},d._numericTimeZoneFieldConfig={showArrows:!1,maxValue:1e4,minValue:0,value:1},d._switcherySettings={color:"rgba(72, 149, 245, 0.2)",secondaryColor:"rgba(16, 17, 20, 1)",jackColor:"rgba(72, 149, 245, 1)",jackSecondaryColor:"rgba(81, 83, 90, 1)",className:"scx_switchery",disabled:!1,disabledOpacity:.5,speed:"0.4s"},d);function d(e){e=t.call(this,e)||this;return e._levels=[],e._initFields(),e._init(),e}l.FibonacciDrawingSettingsDialog=s}(_.UI||(_.UI={}))}(StockChartX=StockChartX||{}),!function(n){!function(e){"use strict";var o=jQuery,t="scxComponentsContainer";function i(){this._componentsContainer=o('<div class="'+t+'"></div>').appendTo(o("body")),this._elements=[]}Object.defineProperty(i.prototype,"componentsContainer",{get:function(){return this._componentsContainer},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"elements",{get:function(){return this._elements},enumerable:!0,configurable:!0}),Object.defineProperty(i,"instance",{get:function(){return i._instance=null==i._instance?new i:i._instance},enumerable:!0,configurable:!0}),i.prototype.register=function(e,t,i){void 0===i&&(i=!0);var n=null;return t&&(n=i?o(t).appendTo(this.componentsContainer):o(t),this._elements.push({name:e,element:n})),n},i.prototype.resetSelf=function(e){e&&(e.windowMode===n.WindowMode.FULL_SCREEN?this.reset(e.container):this.reset())},i.prototype.reset=function(e){e=e||o("body"),o.contains(e.get(0),this._componentsContainer.get(0))&&this._componentsContainer.detach(),this._componentsContainer.appendTo(e)},i._instance=null,e.HtmlContainer=i}(n.UI||(n.UI={}))}(StockChartX=StockChartX||{}),!function(r){!function(e){"use strict";var n=jQuery,o=(t.prototype._isLoaded=function(){return!!this._html},t.prototype.setHtml=function(e){this._html=e;for(var t=this._subscribers.length-1;0<=t;t--)this._subscribers[t](e);this._subscribers=[]},t.prototype.subscribe=function(e){this._isLoaded()?e(this._html):this._subscribers.push(e)},t);function t(e){this._subscribers=[],e&&this._subscribers.push(e)}function i(){}i.loadHtml=function(e,t){var i=this._fileName2Html.get(e);i?i.subscribe(t):(this._fileName2Html.add(e,new o(t)),this._loadContent(e))},i._expandPath=function(e){return r.Environment.Path.view+e},i._loadContent=function(t){var i=this;n.get(this._expandPath(t),function(e){i._onContentLoaded(t,e)}).fail(function(){e.Notification.error("Load "+t+" failed.")})},i._onContentLoaded=function(e,t){e=this._fileName2Html.get(e);e&&e.setHtml(t)},i._fileName2Html=new r.Dictionary,e.HtmlLoader=i}(r.UI||(r.UI={}))}(StockChartX=StockChartX||{}),this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}()),__extends=(!function(a){!function(n){"use strict";var o,t="scxIndicatorInfoDialog",e=(o=n.Dialog,__extends(r,o),r.prototype.show=function(e){var t,i=this;this.initDialog(e)&&(this._clear(),this._showWaitingBar(),o.prototype.show.call(this,e),"object"==typeof e.indicator&&e.indicator instanceof a.Indicator?(t=e.indicator.className,this._setTitle(t),n.HtmlLoader.loadHtml("IndicatorsHelp.html",function(e){i._config.chart.localize(i._dialog);e=$(e).find("#scxIndicatorTooltip_"+t).clone().show();e.find("> h1").remove(),e=e.length?e:r._generateHelpDoesntExistContent(),i._insertContent(e)})):(e=r._getIndicatorOwnAbout(e.indicator)||r._generateHelpDoesntExistContent(),this._setTitle("IndicatorHelp"),this._insertContent(e)))},r.prototype._setTitle=function(e){this._title.scxLocalize("indicator."+e+".name",e)},r.prototype._insertContent=function(e){this._hideWaitingBar(),this._helpContainer.append(e),this.resize(),this._config.chart.localize(this._helpContainer)},r.prototype._clear=function(){this._helpContainer.empty()},r._getIndicatorOwnAbout=function(e){e=e.getInfoAbout();return e?$(e):null},r._generateHelpDoesntExistContent=function(){return $('<p class="'+t+'__noInfo" data-i18n="indicator.all.help.dialog.noInfo"></p>')},r.prototype._showWaitingBar=function(){this._waitingBar.show(this._waitingBarConfig)},r.prototype._hideWaitingBar=function(){this._waitingBar.hide()},r);function r(e){e=o.call(this,e)||this;return e._waitingBarConfig={dotsCount:5},e._title=e._dialog.find("."+t+"__title"),e._helpContainer=e._dialog.find("."+t+"__help-content"),e._waitingBar=e._dialogContent.body.scx().waitingBar(),e}n.IndicatorInfoDialog=e}(a.UI||(a.UI={}))}(StockChartX=StockChartX||{}),this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}()),__extends=(!function(e){!function(n){"use strict";var o,r="scxMenuItemChecked",a="disabled",e={ABOUT:"about",SETTINGS:"settings",SHOW_PARAMS:"showParams",SHOW_MARKERS:"showMarkers",SHOW_VALUES:"showTitleValues",VISIBLE:"visible",DELETE:"delete",MERGE_UP:"mergeUp",MERGE_DOWN:"mergeDown",UNMERGE_UP:"unmergeUp",UNMERGE_DOWN:"unmergeDown",LINE_LEVELS:"lineLevels"},e=(Object.freeze(e),o=n.ContextMenu,__extends(s,o),s.prototype._initMenu=function(t){var i=this;t.menuContainer=s._container,t.onShow=function(){var e=t.indicator;i._toggleClass("settings",a,!e.allowSettingsDialog),i._toggleClass("showParams",r,e.showParamsInTitle),i._toggleClass("showMarkers",r,e.showValueMarkers),i._toggleClass("showTitleValues",r,e.showValuesInTitle),i._toggleClass("visible",r,e.visible),i._toggleClass("lineLevels",r,e.showLineLevels),i._toggleClass("lineLevels",a,0===e._lineLevels.length),i._toggleClass("mergeUp",a,!e.canMergeUp),i._toggleClass("mergeDown",a,!e.canMergeDown),i._toggleClass("unmergeUp",a,!e.canUnmergeUp),i._toggleClass("unmergeDown",a,!e.canUnmergeDown)}},s.prototype._toggleClass=function(e,t,i){e=s._container.find("[data-id="+e+"]");i?e.addClass(t):e.removeClass(t)},s._container=null,s.MenuItem=e,s);function s(e,t){var i=o.call(this,t,e)||this;return n.HtmlLoader.loadHtml("IndicatorContextMenu.html",function(e){s._container||(s._container=n.HtmlContainer.instance.register("IndicatorContextMenu",e)),i._initMenu(t)}),i}n.IndicatorContextMenu=e}(e.UI||(e.UI={}))}(StockChartX=StockChartX||{}),this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}()),__extends=(!function(l){!function(n){"use strict";var o,e={NEW_ORDER:"newOrder",BUY:"buy",SELL:"sell",BUY_MARKET:"buyMarket",SELL_MARKET:"sellMarket"},a=(Object.freeze(e),{BUY_ABOVE_MARKET:"trading.contextMenu.buyAboveMarket",SELL_ABOVE_MARKET:"trading.contextMenu.sellAboveMarket",BUY_BELOW_MARKET:"trading.contextMenu.buyBelowMarket",SELL_BELOW_MARKET:"trading.contextMenu.sellBelowMarket",BUY_MARKET:"trading.contextMenu.buyMarket",SELL_MARKET:"trading.contextMenu.sellMarket"}),e=(Object.freeze(a),o=n.ContextMenu,__extends(s,o),s.prototype._initMenu=function(o){var r=this;o.menuContainer=s._container,o.onShow=function(){var e=o.crossHairView.chart,t=l.JsUtil.calculateDigitsOnTickSize(e.instrument.tickSize),t=parseFloat(o.crossHairView.markerValue.toFixed(t)),i=e.instrument.symbol,e=e.barDataSeries().close.lastValue>o.crossHairView.markerValue,n=s.MenuItem;if(t){if(t<=0)throw new Error("Price must be greater than 0");o.crossHairView.tradingPrice=t,(o.crossHairView.isAboveMarket=e)?(r._addText(o.chart,n.BUY,a.BUY_BELOW_MARKET,i,o.quantity,t),r._addText(o.chart,n.SELL,a.SELL_BELOW_MARKET,i,o.quantity,t)):(r._addText(o.chart,n.BUY,a.BUY_ABOVE_MARKET,i,o.quantity,t),r._addText(o.chart,n.SELL,a.SELL_ABOVE_MARKET,i,o.quantity,t)),r._addText(o.chart,n.BUY_MARKET,a.BUY_MARKET,i,o.quantity),r._addText(o.chart,n.SELL_MARKET,a.SELL_MARKET,i,o.quantity)}}},s.prototype._addText=function(e,t,i,n,o,r){var a=s._container.find("[data-id="+t+"]");l.Localization.localizeText(e,i,{replace:{symbol:n,count:o,price:r}}).then(function(e){a.children().text(e)})},s._container=null,s.MenuItem=e,s);function s(e,t){var i=o.call(this,t,e)||this;return n.HtmlLoader.loadHtml("TradingContextMenu.html",function(e){s._container||(s._container=n.HtmlContainer.instance.register("TradingContextMenu",e)),i._initMenu(t)}),i}n.TradingContextMenu=e}(l.UI||(l.UI={}))}(StockChartX=StockChartX||{}),this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}()),__extends=(!function(e){!function(n){"use strict";var o,r="scxMenuItemChecked",a="disabled",e={ABOUT:"about",SETTINGS:"settings",SHOW_MARKERS:"showMarkers",VISIBLE:"visible",DELETE:"delete"},e=(Object.freeze(e),o=n.ContextMenu,__extends(s,o),s.prototype._initMenu=function(t){var i=this;t.menuContainer=s._container,t.onShow=function(){var e=t.instrumentCompare;i._toggleClass(s.MenuItem.SETTINGS,a,!e.allowSettingsDialog),i._toggleClass(s.MenuItem.SHOW_MARKERS,r,e.showValueMarker),i._toggleClass(s.MenuItem.SHOW_MARKERS,a,!e.allowCheckValueMarker),i._toggleClass(s.MenuItem.VISIBLE,r,e.visible),i._toggleClass(s.MenuItem.ABOUT,a,!e.allowAboutDialog)}},s.prototype._toggleClass=function(e,t,i){e=s._container.find("[data-id="+e+"]");i?e.addClass(t):e.removeClass(t)},s._container=null,s.MenuItem=e,s);function s(e,t){var i=o.call(this,t,e)||this;return n.HtmlLoader.loadHtml("ComparingContextMenu.html",function(e){s._container||(s._container=n.HtmlContainer.instance.register("ComparingContextMenu",e)),i._initMenu(t)}),i}n.CompareContextMenu=e}(e.UI||(e.UI={}))}(StockChartX=StockChartX||{}),this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}()),__awaiter=this&&this.__awaiter||function(r,a,s,l){return new(s=s||Promise)(function(e,t){function i(e){try{o(l.next(e))}catch(e){t(e)}}function n(e){try{o(l.throw(e))}catch(e){t(e)}}function o(t){t.done?e(t.value):new s(function(e){e(t.value)}).then(i,n)}o((l=l.apply(r,a||[])).next())})},__generator=this&&this.__generator||function(n,o){var r,a,s,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(i){return function(e){var t=[i,e];if(r)throw new TypeError("Generator is already executing.");for(;l;)try{if(r=1,a&&(s=a[2&t[0]?"return":t[0]?"throw":"next"])&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[0,s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return l.label++,{value:t[1],done:!1};case 5:l.label++,a=t[1],t=[0];continue;case 7:t=l.ops.pop(),l.trys.pop();continue;default:if(!(s=0<(s=l.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){l=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3])){l.label=t[1];break}if(6===t[0]&&l.label<s[1]){l.label=s[1],s=t;break}if(s&&l.label<s[2]){l.label=s[2],l.ops.push(t);break}s[2]&&l.ops.pop(),l.trys.pop();continue}t=o.call(n,l)}catch(e){t=[6,e],a=0}finally{r=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},__extends=(!function(b){!function(i){"use strict";var t,n="scxInvalidValue",o="#scxIndicatorDialog_title",f="#scxIndicatorDialog_container_",m="#scxIndicatorDialog_input_",a="#scxIndicatorDialog_label_",r=".scxIndicatorDialog_switchery_",s={value:1},l={priceDecimals:2,value:1},e=(t=i.Dialog,__extends(g,t),g.prototype.show=function(e){this.initDialog(e)&&(this._indicator=e.indicator,this._setDialogTitle(),this._setViewAndValues(),t.prototype.show.call(this,e))},g.prototype.hide=function(){this._dialog.find(".scxSpectrum").spectrum("hide"),t.prototype.hide.call(this)},g.prototype._init=function(){var t=this,e={containerClassName:"scxSpectrumIndicatorPropertiesDialog",localStorageKey:"scxIndicatorDialog_spectrum",showAlpha:!0};this._input_line1_color=this._dialog.find(m+"line1_color").scx().colorPicker(e),this._input_line2_color=this._dialog.find(m+"line2_color").scx().colorPicker(e),this._input_line3_color=this._dialog.find(m+"line3_color").scx().colorPicker(e),this._input_line4_color=this._dialog.find(m+"line4_color").scx().colorPicker(e),this._input_line5_color=this._dialog.find(m+"line5_color").scx().colorPicker(e),this._input_label1_color=this._dialog.find(m+"label1_color").scx().colorPicker(e),this._input_label2_color=this._dialog.find(m+"label2_color").scx().colorPicker(e),this._input_label3_color=this._dialog.find(m+"label3_color").scx().colorPicker(e),this._input_label4_color=this._dialog.find(m+"label4_color").scx().colorPicker(e),this._input_aboveFill=this._dialog.find(m+"fillAbove").scx().colorPicker(e),this._input_belowFill=this._dialog.find(m+"fillBelow").scx().colorPicker(e),this._dialog.find(".scxComboBox").selectpicker({container:"body"}),this._dialog.find("#scxIndicatorDialog_btn_save").off("click").click(function(){0===t._dialog.find("."+n).length&&t._save()}),this._dialog.find("#scxIndicatorDialog_btn_apply").off("click").click(function(){0===t._dialog.find("."+n).length&&t._apply()}),this._tabs=new i.Tabs({tabsContainer:this._tabItemsContainer,panelsContainer:this._tabPanelsContainer,onChange:function(e){t.resize()}}),this._initSwitchery(),this._groupLines(),this._groupLabels()},g._getMAType=function(e){var t=parseInt(e,10);switch(t){case b.MovingAverageType.exponentialMovingAverage:case b.MovingAverageType.hullMovingAverage:case b.MovingAverageType.simpleMovingAverage:case b.MovingAverageType.triangularMovingAverage:case b.MovingAverageType.TEMA:case b.MovingAverageType.weightedMovingAverage:case b.MovingAverageType.variable:case b.MovingAverageType.wws:case b.MovingAverageType.vidya:return t;default:return b.MovingAverageType.simpleMovingAverage}},g.prototype._getSource=function(e){return this._indicator.chart.findDataSeries(e)?e:e===b.InputSeriesKind.typical?b.DataSeriesSuffix.TYPICAL:e===b.InputSeriesKind.median?b.DataSeriesSuffix.MEDIAN:e===b.InputSeriesKind.weighted?b.DataSeriesSuffix.WEIGHTED:b.DataSeriesSuffix.CLOSE},g._getLineStyle=function(e){switch(e){case b.LineStyle.SOLID:case b.LineStyle.DASH:case b.LineStyle.DOT:case b.LineStyle.DASH_DOT:return e;default:return b.LineStyle.SOLID}},g.prototype.numericValue=function(e){return e.scxNumericField("getValue")},g.prototype.setNumericValue=function(e,t){null!=t&&e.scxNumericField("setValue",t)},g.prototype.updateNumericFromIndicator=function(e,t){this.setNumericValue(e,this._indicator.getParameterValue(t))},g.prototype.updateIndicatorFromNumeric=function(e,t){this._indicator.setParameterValue(e,this.numericValue(t))},g.prototype.updateIndicatorLineStyle=function(e,t){this._indicator.setParameterValue(e,g._getLineStyle(t.val()))},g.prototype._hideFields=function(){var t=this;this._dialogContent.body.find("[id^='scxIndicatorDialog_container_']").hide(),b.Localization.localizeText(this._config.chart,"indicator.all.plot.line").then(function(e){t._label_line1.text(e)})},g.prototype._restoreFields=function(){this._input_line1_width.show(),this._input_line1_style.selectpicker("show"),this._input_line3_width.show(),this._input_line3_style.selectpicker("show")},g.prototype._resetErrors=function(){this._dialog.find("."+n).each(function(e,t){$(t).removeClass(n)})},g.prototype._initSwitchery=function(){var n=this;this._line1_enabled=new Switchery(this._line1_switchery[0],g._switcherySettings),this._line2_enabled=new Switchery(this._line2_switchery[0],g._switcherySettings),this._line3_enabled=new Switchery(this._line3_switchery[0],g._switcherySettings),this._line4_enabled=new Switchery(this._line4_switchery[0],g._switcherySettings),this._line5_enabled=new Switchery(this._line5_switchery[0],g._switcherySettings),this._label1_enabled=new Switchery(this._label1_switchery[0],g._switcherySettings),this._label2_enabled=new Switchery(this._label2_switchery[0],g._switcherySettings),this._label3_enabled=new Switchery(this._label3_switchery[0],g._switcherySettings),this._label4_enabled=new Switchery(this._label4_switchery[0],g._switcherySettings),this._fill_enabled=new Switchery(this._fill_switchery[0],g._switcherySettings),$("body").on("scxSwitcherChanged",function(e,t){var i=$(t.target),t=t.checked;i.is(n._line1_switchery)?n._setLineState(t,n._label_line1,n._input_line1_width,n._input_line1_style,n._dialog.find(m+"line1_color"),n._line1_enabled):i.is(n._line2_switchery)?n._setLineState(t,n._label_line2,n._input_line2_width,n._input_line2_style,n._dialog.find(m+"line2_color"),n._line2_enabled):i.is(n._line3_switchery)?n._setLineState(t,n._label_line3,n._input_line3_width,n._input_line3_style,n._dialog.find(m+"line3_color"),n._line3_enabled):i.is(n._line4_switchery)?n._setLineState(t,n._label_line4,n._input_line4_width,n._input_line4_style,n._dialog.find(m+"line4_color"),n._line4_enabled):i.is(n._line5_switchery)?n._setLineState(t,n._label_line5,n._input_line5_width,n._input_line5_style,n._dialog.find(m+"line5_color"),n._line5_enabled):i.is(n._label1_switchery)?n._setLabelState(t,n._label_label1,n._dialog.find(m+"label1_color"),n._label1_enabled):i.is(n._label2_switchery)?n._setLabelState(t,n._label_label2,n._dialog.find(m+"label2_color"),n._label2_enabled):i.is(n._label3_switchery)?n._setLabelState(t,n._label_label3,n._dialog.find(m+"label3_color"),n._label3_enabled):i.is(n._label4_switchery)?n._setLabelState(t,n._label_label4,n._dialog.find(m+"label4_color"),n._label4_enabled):i.is(n._fill_switchery)&&n._setFillState(t,n._fill_enabled),t?i.addClass("scxCheckboxChecked"):i.removeClass("scxCheckboxChecked")})},g.prototype._setLineState=function(e,t,i,n,o,r){e?(t.removeClass("disabled"),o.spectrum("enable"),n.removeAttr("disabled"),n.selectpicker("refresh"),i.scxNumericField("enable"),r.isChecked()||r.setPosition(!0)):(t.addClass("disabled"),o.spectrum("disable"),n.attr("disabled","disabled"),n.selectpicker("refresh"),i.scxNumericField("disable"),r.isChecked()&&r.setPosition(!0)),this._config.chart&&this._config.chart.localize(this._dialog)},g.prototype._setLabelState=function(e,t,i,n){e?(t.removeClass("disabled"),i.spectrum("enable"),n.isChecked()||n.setPosition(!0)):(t.addClass("disabled"),i.spectrum("disable"),n.isChecked()&&n.setPosition(!0)),this._config.chart&&this._config.chart.localize(this._dialog)},g.prototype._setFillState=function(e,t){var i=this._dialog.find(a+"fillAbove"),n=this._dialog.find(a+"fillBelow"),o=this._dialog.find(m+"fillAbove"),r=this._dialog.find(m+"fillBelow");e?(i.removeClass("disabled"),n.removeClass("disabled"),o.spectrum("enable"),r.spectrum("enable"),t.isChecked()||t.setPosition(!0)):(i.addClass("disabled"),n.addClass("disabled"),r.spectrum("disable"),o.spectrum("disable"),t.isChecked()&&t.setPosition(!0)),this._config.chart&&this._config.chart.localize(this._dialog)},g.prototype._setFieldValueBounds=function(){var e=this._indicator?this._indicator.chart.recordCount:0,e=parseInt((e/2).toString(),10),t=1e4;this._input_periods.scxNumericField("setBounds",1,t),this._input_standardDeviations.scxNumericField("setBounds",0,5),this._input_kPeriods.scxNumericField("setBounds",2,e),this._input_dPeriods.scxNumericField("setBounds",2,e),this._input_roc.scxNumericField("setBounds",0,100),this._input_shortCycle.scxNumericField("setBounds",2,t),this._input_longCycle.scxNumericField("setBounds",2,t),this._input_line1_width.scxNumericField("setBounds",1,20),this._input_line2_width.scxNumericField("setBounds",1,20),this._input_line3_width.scxNumericField("setBounds",1,20),this._input_line4_width.scxNumericField("setBounds",1,20),this._input_line5_width.scxNumericField("setBounds",1,20),this._input_bandPct.scxNumericField("setBounds",0,100),this._input_smooth.scxNumericField("setBounds",1,t),this._input_slow.scxNumericField("setBounds",1,t),this._input_fast.scxNumericField("setBounds",1,t),this._input_maPeriods.scxNumericField("setBounds",1,t),this._input_rocPeriods.scxNumericField("setBounds",1,t),this._input_volumeDivisor.scxNumericField("setBounds",1,1e7),this._input_barCount.scxNumericField("setBounds",1,1e7),this._input_forecast.scxNumericField("setBounds",1,t),this._input_ema1Periods.scxNumericField("setBounds",1,t),this._input_ema2Periods.scxNumericField("setBounds",1,t),this._input_envelopePercentage.scxNumericField("setBounds",0,100),this._input_offsetMultiplier.scxNumericField("setBounds",0,t),this._input_qPeriods.scxNumericField("setBounds",1,t),this._input_volatilityPeriod.scxNumericField("setBounds",1,t),this._input_basePeriods.scxNumericField("setBounds",1,t),this._input_conversionPeriods.scxNumericField("setBounds",1,t),this._input_logginPeriods.scxNumericField("setBounds",1,t),this._input_limitValue.scxNumericField("setBounds",0,t),this._input_r2Scale.scxNumericField("setBounds",0,1),this._input_signalPeriods.scxNumericField("setBounds",1,t),this._input_intermediate.scxNumericField("setBounds",1,t),this._input_lookback.scxNumericField("setBounds",1,t)},g.prototype._setFieldsRestrictions=function(){this._input_shortCycle.scxNumericField("onChange",null),this._input_longCycle.scxNumericField("onChange",null)},g.prototype._setViewAndValues=function(){for(var t=this,e=b.IndicatorParam,_=this._indicator,u=_.linePlots,l=_.labelPlots,p=(_.indicatorHasParameters?this._tabs.activate(0):this._tabs.activate(1),this._restoreFields(),this._hideFields(),this._resetErrors(),this._setFieldValueBounds(),this._setFieldsRestrictions(),this),i=0;i<u.length;i++)!function(e){var t=p._lines[e],i=t.label,n=t.width,o=t.style,r=t.color,a=t.enabled,s=t.widthParamName,l=t.styleParamName,t=t.enabledParamName,c=e+1,e=u[e],h=p._dialog.find(f+"line"+c),c=p._dialog.find(m+"line"+c+"_color"),t=_.getParameterValue(t),d=e.dataSeries[0].name;r.setColor(e.actualTheme.strokeColor||e.actualTheme.fill.fillColor),p.updateNumericFromIndicator(n,s),o.val(_.getParameterValue(l)),h.show(),p._setLineState(t,i,n,o,c,a),b.Localization.localizeText(p._config.chart,"indicator.all.panelTitle."+d).then(function(e){i.text(e)})}(i);for(var c=this,i=0;i<l.length;i++)!function(e){var t=c._labels[e],i=t.label,n=t.color,o=t.enabled,t=t.enabledParamName,r=e+1,e=l[e],a=c._dialog.find(f+"label"+r),r=c._dialog.find(m+"line"+r+"_color"),t=_.getParameterValue(t),s=e.dataSeries[0].name;n.setColor(e.actualTheme.strokeColor||e.actualTheme.fill.fillColor),a.show(),c._setLabelState(t,i,r,o),b.Localization.localizeText(c._config.chart,"indicator.all.panelTitle."+s).then(function(e){i.text(e)})}(i);switch(_.hasParameter(e.SOURCE)&&(this._input_source.val(_.getParameterValue(e.SOURCE)),this._dialog.find(f+"source").show()),_.hasParameter(e.SOURCE2)&&(this._input_source2.val(_.getParameterValue(e.SOURCE2)),this._dialog.find(f+"source2").show()),_.hasParameter(e.PERIODS)&&(this.updateNumericFromIndicator(this._input_periods,e.PERIODS),this._dialog.find(f+"periods").show()),_.hasParameter(e.VOLATILITY_PERIOD)&&(this.updateNumericFromIndicator(this._input_volatilityPeriod,e.VOLATILITY_PERIOD),this._dialog.find(f+"volatilityPeriod").show()),_.hasParameter(e.MA_TYPE)&&(this._input_maType.val(_.getParameterValue(e.MA_TYPE)),this._dialog.find(f+"maType").show()),_.hasParameter(e.STANDARD_DEVIATIONS)&&(this.updateNumericFromIndicator(this._input_standardDeviations,e.STANDARD_DEVIATIONS),this._dialog.find(f+"standardDeviations").show()),_.hasParameter(e.BAND_PCT)&&(this.updateNumericFromIndicator(this._input_bandPct,e.BAND_PCT),this._dialog.find(f+"bandPct").show()),_.hasParameter(e.SMOOTH)&&(this.updateNumericFromIndicator(this._input_smooth,e.SMOOTH),this._dialog.find(f+"smooth").show()),_.hasParameter(e.FAST)&&(this.updateNumericFromIndicator(this._input_fast,e.FAST),this._dialog.find(f+"fast").show()),_.hasParameter(e.SLOW)&&(this.updateNumericFromIndicator(this._input_slow,e.SLOW),this._dialog.find(f+"slow").show()),_.hasParameter(e.MA_PERIOD)&&(this._input_maPeriods.val(_.getParameterValue(e.MA_PERIOD)),this._dialog.find(f+"maPeriods").show()),_.hasParameter(e.RATE_OF_CHANGE)&&(this.updateNumericFromIndicator(this._input_rocPeriods,e.RATE_OF_CHANGE),this._dialog.find(f+"rocPeriods").show()),_.hasParameter(e.VOLUME_DIVISOR)&&(this.updateNumericFromIndicator(this._input_volumeDivisor,e.VOLUME_DIVISOR),this._dialog.find(f+"volumeDivisor").show()),_.hasParameter(e.BAR_COUNT)&&(this.updateNumericFromIndicator(this._input_barCount,e.BAR_COUNT),this._dialog.find(f+"barCount").show()),_.hasParameter(e.FORECAST)&&(this.updateNumericFromIndicator(this._input_forecast,e.FORECAST),this._dialog.find(f+"forecast").show()),_.hasParameter(e.EMA1)&&(this.updateNumericFromIndicator(this._input_ema1Periods,e.EMA1),this._dialog.find(f+"ema1Periods").show()),_.hasParameter(e.EMA2)&&(this.updateNumericFromIndicator(this._input_ema2Periods,e.EMA2),this._dialog.find(f+"ema2Periods").show()),_.hasParameter(e.PCT_K_PERIODS)&&(this.updateNumericFromIndicator(this._input_kPeriods,e.PCT_K_PERIODS),this._dialog.find(f+"kPeriods").show()),_.hasParameter(e.PCT_D_PERIODS)&&(this.updateNumericFromIndicator(this._input_dPeriods,e.PCT_D_PERIODS),this._dialog.find(f+"dPeriods").show()),_.hasParameter(e.ENVELOPE_PERCENTAGE)&&(this.updateNumericFromIndicator(this._input_envelopePercentage,e.ENVELOPE_PERCENTAGE),this._dialog.find(f+"envelopePercentage").show()),_.hasParameter(e.OFFSET_MULTIPLIER)&&(this.updateNumericFromIndicator(this._input_offsetMultiplier,e.OFFSET_MULTIPLIER),this._dialog.find(f+"offsetMultiplier").show()),_.hasParameter(e.Q_PERIODS)&&(this.updateNumericFromIndicator(this._input_qPeriods,e.Q_PERIODS),this._dialog.find(f+"qPeriods").show()),_.hasParameter(e.LOGIN_SPAN2_PERIODS)&&(this.updateNumericFromIndicator(this._input_logginPeriods,e.LOGIN_SPAN2_PERIODS),this._dialog.find(f+"logginPeriods").show()),_.hasParameter(e.BASE_PERIODS)&&(this.updateNumericFromIndicator(this._input_basePeriods,e.BASE_PERIODS),this._dialog.find(f+"basePeriods").show()),_.hasParameter(e.CONVERSION_PERIODS)&&(this.updateNumericFromIndicator(this._input_conversionPeriods,e.CONVERSION_PERIODS),this._dialog.find(f+"conversionPeriods").show()),_.hasParameter(e.LIMIT_VALUE)&&(this.updateNumericFromIndicator(this._input_limitValue,e.LIMIT_VALUE),this._dialog.find(f+"limitValue").show()),_.hasParameter(e.R2_SCALE)&&(this.updateNumericFromIndicator(this._input_r2Scale,e.R2_SCALE),this._dialog.find(f+"r2Scale").show()),_.hasParameter(e.SHORT_CYCLE)&&(this.updateNumericFromIndicator(this._input_shortCycle,e.SHORT_CYCLE),this._dialog.find(f+"shortCycle").show()),_.hasParameter(e.LONG_CYCLE)&&(this.updateNumericFromIndicator(this._input_longCycle,e.LONG_CYCLE),this._dialog.find(f+"longCycle").show()),_.hasParameter(e.SIGNAL_PERIODS)&&(this.updateNumericFromIndicator(this._input_signalPeriods,e.SIGNAL_PERIODS),this._dialog.find(f+"signalPeriods").show()),_.hasParameter(e.INTERMEDIATE)&&(this.updateNumericFromIndicator(this._input_intermediate,e.INTERMEDIATE),this._dialog.find(f+"intermediate").show()),_.hasParameter(e.LOOKBACK)&&(this.updateNumericFromIndicator(this._input_lookback,e.LOOKBACK),this._dialog.find(f+"lookback").show()),_.className){case b.MACD.className:this._input_line3_style.selectpicker("hide"),this._input_line3_width.hide(),this._input_line2_style.selectpicker("show"),this._input_line2_width.show();break;case b.NBarsUp.className:case b.NBarsDown.className:case b.VolumeOscillator.className:case b.BOP.className:this._input_line1_style.selectpicker("hide"),this._input_line1_width.hide();break;case b.VolumeUpDown.className:this._input_line2_style.selectpicker("hide"),this._input_line2_width.hide(),this._input_line1_style.selectpicker("hide"),this._input_line1_width.hide();break;case b.Ichimoku.className:this._fillContainer.show(),this._input_belowFill.setColor(_._fillPlot.actualTheme.belowCross.fillColor),this._input_aboveFill.setColor(_._fillPlot.actualTheme.aboveCross.fillColor);var n=_.getParameterValue(e.FILL_ENABLED);this._setFillState(n,this._fill_enabled),b.Localization.localizeText(this._config.chart,"indicator.Ichimoku.plot.tenkanSen").then(function(e){t._label_line1.text(e)}),b.Localization.localizeText(this._config.chart,"indicator.Ichimoku.plot.kijunSen").then(function(e){t._label_line2.text(e)}),b.Localization.localizeText(this._config.chart,"indicator.Ichimoku.plot.chikouSpan").then(function(e){t._label_line3.text(e)}),b.Localization.localizeText(this._config.chart,"indicator.Ichimoku.plot.senkouSpanA").then(function(e){t._label_line4.text(e)}),b.Localization.localizeText(this._config.chart,"indicator.Ichimoku.plot.senkouSpanB").then(function(e){t._label_line5.text(e)})}[this._input_source,this._input_source2,this._input_maType,this._input_line1_style,this._input_line2_style,this._input_line3_style,this._input_line4_style,this._input_line5_style].forEach(function(e){e.selectpicker("refresh")})},g.prototype._updateIndicatorFromUI=function(){for(var e=b.IndicatorParam,t=this._indicator,i=t.linePlots,n=t.labelPlots,o=0;o<i.length;o++){var r=this._lines[o],a=r.width,s=r.style,l=r.color,c=r.enabled,h=r.widthParamName,d=r.styleParamName,_=r.colorParamName,u=r.enabledParamName;t.setParameterValue(_,l.getColor()),t.setParameterValue(u,c.isChecked()),this.updateIndicatorFromNumeric(h,a),this.updateIndicatorLineStyle(d,s)}for(o=0;o<n.length;o++){var p=this._labels[o],l=p.color,c=p.enabled,_=p.colorParamName,u=p.enabledParamName;t.setParameterValue(_,l.getColor()),t.setParameterValue(u,c.isChecked())}t.className===b.Ichimoku.className&&(t.setParameterValue(e.FILL_ABOVE,this._input_aboveFill.getColor()),t.setParameterValue(e.FILL_BELOW,this._input_belowFill.getColor()),t.setParameterValue(e.FILL_ENABLED,this._fill_enabled.isChecked())),t.hasParameter(e.PERIODS)&&this.updateIndicatorFromNumeric(e.PERIODS,this._input_periods),t.hasParameter(e.VOLATILITY_PERIOD)&&this.updateIndicatorFromNumeric(e.VOLATILITY_PERIOD,this._input_volatilityPeriod),t.hasParameter(e.SOURCE)&&t.setParameterValue(e.SOURCE,this._getSource(this._input_source.val())),t.hasParameter(e.SOURCE2)&&t.setParameterValue(e.SOURCE2,this._getSource(this._input_source2.val())),t.hasParameter(e.MA_TYPE)&&t.setParameterValue(e.MA_TYPE,g._getMAType(this._input_maType.val())),t.hasParameter(e.STANDARD_DEVIATIONS)&&this.updateIndicatorFromNumeric(e.STANDARD_DEVIATIONS,this._input_standardDeviations),t.hasParameter(e.BAND_PCT)&&this.updateIndicatorFromNumeric(e.BAND_PCT,this._input_bandPct),t.hasParameter(e.SMOOTH)&&this.updateIndicatorFromNumeric(e.SMOOTH,this._input_smooth),t.hasParameter(e.FAST)&&this.updateIndicatorFromNumeric(e.FAST,this._input_fast),t.hasParameter(e.SLOW)&&this.updateIndicatorFromNumeric(e.SLOW,this._input_slow),t.hasParameter(e.MA_PERIOD)&&this.updateIndicatorFromNumeric(e.MA_PERIOD,this._input_maPeriods),t.hasParameter(e.RATE_OF_CHANGE)&&this.updateIndicatorFromNumeric(e.RATE_OF_CHANGE,this._input_rocPeriods),t.hasParameter(e.VOLUME_DIVISOR)&&this.updateIndicatorFromNumeric(e.VOLUME_DIVISOR,this._input_volumeDivisor),t.hasParameter(e.BAR_COUNT)&&this.updateIndicatorFromNumeric(e.BAR_COUNT,this._input_barCount),t.hasParameter(e.FORECAST)&&this.updateIndicatorFromNumeric(e.FORECAST,this._input_forecast),t.hasParameter(e.EMA1)&&this.updateIndicatorFromNumeric(e.EMA1,this._input_ema1Periods),t.hasParameter(e.EMA2)&&this.updateIndicatorFromNumeric(e.EMA2,this._input_ema2Periods),t.hasParameter(e.PCT_K_PERIODS)&&this.updateIndicatorFromNumeric(e.PCT_K_PERIODS,this._input_kPeriods),t.hasParameter(e.PCT_D_PERIODS)&&this.updateIndicatorFromNumeric(e.PCT_D_PERIODS,this._input_dPeriods),t.hasParameter(e.ENVELOPE_PERCENTAGE)&&this.updateIndicatorFromNumeric(e.ENVELOPE_PERCENTAGE,this._input_envelopePercentage),t.hasParameter(e.OFFSET_MULTIPLIER)&&this.updateIndicatorFromNumeric(e.OFFSET_MULTIPLIER,this._input_offsetMultiplier),t.hasParameter(e.Q_PERIODS)&&this.updateIndicatorFromNumeric(e.Q_PERIODS,this._input_qPeriods),t.hasParameter(e.LOGIN_SPAN2_PERIODS)&&this.updateIndicatorFromNumeric(e.LOGIN_SPAN2_PERIODS,this._input_logginPeriods),t.hasParameter(e.BASE_PERIODS)&&this.updateIndicatorFromNumeric(e.BASE_PERIODS,this._input_basePeriods),t.hasParameter(e.CONVERSION_PERIODS)&&this.updateIndicatorFromNumeric(e.CONVERSION_PERIODS,this._input_conversionPeriods),t.hasParameter(e.LIMIT_VALUE)&&this.updateIndicatorFromNumeric(e.LIMIT_VALUE,this._input_limitValue),t.hasParameter(e.R2_SCALE)&&this.updateIndicatorFromNumeric(e.R2_SCALE,this._input_r2Scale),t.hasParameter(e.SHORT_CYCLE)&&this.updateIndicatorFromNumeric(e.SHORT_CYCLE,this._input_shortCycle),t.hasParameter(e.LONG_CYCLE)&&this.updateIndicatorFromNumeric(e.LONG_CYCLE,this._input_longCycle),t.hasParameter(e.SIGNAL_PERIODS)&&this.updateIndicatorFromNumeric(e.SIGNAL_PERIODS,this._input_signalPeriods),t.hasParameter(e.INTERMEDIATE)&&this.updateIndicatorFromNumeric(e.INTERMEDIATE,this._input_intermediate),t.hasParameter(e.LOOKBACK)&&this.updateIndicatorFromNumeric(e.LOOKBACK,this._input_lookback)},g.prototype._save=function(){this._restoreFields(),this._apply(),this.hide()},g.prototype._apply=function(){this._updateIndicatorFromUI(),this._config.done()&&this._config.done()},g.prototype._setDialogTitle=function(){this._setTitle(this._indicator.name)},g.prototype._setTitle=function(i){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return[4,b.Localization.localizeText(this._config.chart,"indicator."+i+".name",{defaultValue:i})];case 1:return t=e.sent(),[4,b.Localization.localizeText(this._config.chart,"indicator.all.dialog.title",{replace:{indicatorName:t}})];case 2:return t=e.sent(),this._title.text(t),[2]}})})},g.prototype._initFields=function(){var e=this._dialog;this._title=e.find(o),this._tabItemsContainer=this._dialog.find(".scxTabs"),this._tabPanelsContainer=this._dialog.find(".scxTabsContent"),this._input_source=e.find(m+"source"),this._input_source2=e.find(m+"source2"),this._input_maType=e.find(m+"maType"),this._input_periods=e.find(m+"periods").scxNumericField(s),this._input_standardDeviations=e.find(m+"standardDeviations").scxNumericField(l),this._input_kPeriods=e.find(m+"kPeriods").scxNumericField(s),this._input_dPeriods=e.find(m+"dPeriods").scxNumericField(s),this._input_roc=e.find(m+"rateOfChange").scxNumericField(l),this._input_shortCycle=e.find(m+"shortCycle").scxNumericField(s),this._input_longCycle=e.find(m+"longCycle").scxNumericField(s),this._label_line1=e.find(a+"line1"),this._input_line1_width=e.find(m+"line1_width").scxNumericField(s),this._input_line1_style=e.find(m+"line1_style"),this._label_line2=e.find(a+"line2"),this._input_line2_width=e.find(m+"line2_width").scxNumericField(s),this._input_line2_style=e.find(m+"line2_style"),this._label_line3=e.find(a+"line3"),this._input_line3_width=e.find(m+"line3_width").scxNumericField(s),this._input_line3_style=e.find(m+"line3_style"),this._label_line4=e.find(a+"line4"),this._input_line4_width=e.find(m+"line4_width").scxNumericField(s),this._input_line4_style=e.find(m+"line4_style"),this._label_line5=e.find(a+"line5"),this._input_line5_width=e.find(m+"line5_width").scxNumericField(s),this._input_line5_style=e.find(m+"line5_style"),this._label_label1=e.find(a+"label1"),this._label_label2=e.find(a+"label2"),this._label_label3=e.find(a+"label3"),this._label_label4=e.find(a+"label4"),this._input_bandPct=e.find(m+"bandPct").scxNumericField(l),this._input_smooth=e.find(m+"smooth").scxNumericField(s),this._input_fast=e.find(m+"fast").scxNumericField(s),this._input_slow=e.find(m+"slow").scxNumericField(s),this._input_maPeriods=e.find(m+"maPeriods").scxNumericField(s),this._input_rocPeriods=e.find(m+"rocPeriods").scxNumericField(s),this._input_volatilityPeriod=e.find(m+"volatilityPeriod").scxNumericField(s),this._input_volumeDivisor=e.find(m+"volumeDivisor").scxNumericField(s),this._input_barCount=e.find(m+"barCount").scxNumericField(s),this._input_forecast=e.find(m+"forecast").scxNumericField(s),this._input_ema1Periods=e.find(m+"ema1Periods").scxNumericField(s),this._input_ema2Periods=e.find(m+"ema2Periods").scxNumericField(s),this._input_envelopePercentage=e.find(m+"envelopePercentage").scxNumericField(l),this._input_offsetMultiplier=e.find(m+"offsetMultiplier").scxNumericField(l),this._input_qPeriods=e.find(m+"qPeriods").scxNumericField(s),this._input_basePeriods=e.find(m+"basePeriods").scxNumericField(s),this._input_conversionPeriods=e.find(m+"conversionPeriods").scxNumericField(s),this._input_logginPeriods=e.find(m+"logginPeriods").scxNumericField(s),this._input_limitValue=e.find(m+"limitValue").scxNumericField(l),this._input_r2Scale=e.find(m+"r2Scale").scxNumericField(l),this._input_signalPeriods=e.find(m+"signalPeriods").scxNumericField(s),this._input_intermediate=e.find(m+"intermediate").scxNumericField(s),this._input_lookback=e.find(m+"lookback").scxNumericField(s),this._fillContainer=e.find(f+"fill"),this._line1_switchery=this._dialog.find(r+"line1"),this._line2_switchery=this._dialog.find(r+"line2"),this._line3_switchery=this._dialog.find(r+"line3"),this._line4_switchery=this._dialog.find(r+"line4"),this._line5_switchery=this._dialog.find(r+"line5"),this._label1_switchery=this._dialog.find(r+"label1"),this._label2_switchery=this._dialog.find(r+"label2"),this._label3_switchery=this._dialog.find(r+"label3"),this._label4_switchery=this._dialog.find(r+"label4"),this._fill_switchery=this._dialog.find(r+"fill"),this._input_line3_color=null,this._input_line2_color=null,this._input_line1_color=null},g.prototype._groupLines=function(){this._lines=[{label:this._label_line1,width:this._input_line1_width,style:this._input_line1_style,color:this._input_line1_color,enabled:this._line1_enabled,widthParamName:b.IndicatorParam.LINE_WIDTH,styleParamName:b.IndicatorParam.LINE_STYLE,colorParamName:b.IndicatorParam.LINE_COLOR,enabledParamName:b.IndicatorParam.LINE_ENABLED},{label:this._label_line2,width:this._input_line2_width,style:this._input_line2_style,color:this._input_line2_color,enabled:this._line2_enabled,widthParamName:b.IndicatorParam.LINE2_WIDTH,styleParamName:b.IndicatorParam.LINE2_STYLE,colorParamName:b.IndicatorParam.LINE2_COLOR,enabledParamName:b.IndicatorParam.LINE2_ENABLED},{label:this._label_line3,width:this._input_line3_width,style:this._input_line3_style,color:this._input_line3_color,enabled:this._line3_enabled,widthParamName:b.IndicatorParam.LINE3_WIDTH,styleParamName:b.IndicatorParam.LINE3_STYLE,colorParamName:b.IndicatorParam.LINE3_COLOR,enabledParamName:b.IndicatorParam.LINE3_ENABLED},{label:this._label_line4,width:this._input_line4_width,style:this._input_line4_style,color:this._input_line4_color,enabled:this._line4_enabled,widthParamName:b.IndicatorParam.LINE4_WIDTH,styleParamName:b.IndicatorParam.LINE4_STYLE,colorParamName:b.IndicatorParam.LINE4_COLOR,enabledParamName:b.IndicatorParam.LINE4_ENABLED},{label:this._label_line5,width:this._input_line5_width,style:this._input_line5_style,color:this._input_line5_color,enabled:this._line5_enabled,widthParamName:b.IndicatorParam.LINE5_WIDTH,styleParamName:b.IndicatorParam.LINE5_STYLE,colorParamName:b.IndicatorParam.LINE5_COLOR,enabledParamName:b.IndicatorParam.LINE5_ENABLED}]},g.prototype._groupLabels=function(){this._labels=[{label:this._label_label1,color:this._input_label1_color,enabled:this._label1_enabled,colorParamName:b.IndicatorParam.LABEL_COLOR,enabledParamName:b.IndicatorParam.LABEL_ENABLED},{label:this._label_label2,color:this._input_label2_color,enabled:this._label2_enabled,colorParamName:b.IndicatorParam.LABEL2_COLOR,enabledParamName:b.IndicatorParam.LABEL2_ENABLED},{label:this._label_label3,color:this._input_label3_color,enabled:this._label3_enabled,colorParamName:b.IndicatorParam.LABEL3_COLOR,enabledParamName:b.IndicatorParam.LABEL3_ENABLED},{label:this._label_label4,color:this._input_label4_color,enabled:this._label4_enabled,colorParamName:b.IndicatorParam.LABEL4_COLOR,enabledParamName:b.IndicatorParam.LABEL4_ENABLED}]},g._switcherySettings={color:"rgba(72, 149, 245, 0.2)",secondaryColor:"rgba(16, 17, 20, 1)",jackColor:"rgba(72, 149, 245, 1)",jackSecondaryColor:"rgba(81, 83, 90, 1)",className:"scx_switchery",disabled:!1,disabledOpacity:.5,speed:"0.4s"},g);function g(e){e=t.call(this,e)||this;return e._initFields(),e._init(),e}i.IndicatorSettingsDialog=e}(b.UI||(b.UI={}))}(StockChartX=StockChartX||{}),this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}()),__assign=(!function(a){!function(o){"use strict";var t,r="scxIndicatorItem",i="scxHasTooltip",e=(t=o.Dialog,__extends(n,t),n.prototype.show=function(e){this.initDialog(e)&&(this._inp_search.val(""),this._setDialogTitle(),this._filterIndicators(""),t.prototype.show.call(this,e),a.Environment.isPhone||this._inp_search.focus())},n.prototype.hide=function(){this._dialogContent.body.find("."+i).popover("hide"),t.prototype.hide.call(this)},n.prototype._init=function(){var i,n=this,e=$("body");this._noResultObj.hide(),this._generateObjects(),this._resultContainer.append(this._allIndicators.container.root),this._inp_search.on("keyup",function(e){n._filterIndicators($(e.currentTarget).val())}),this._btnClearInput.on("click",function(){n._inp_search.val().length&&n._clearInput()}),this._resultContainer.on("click","."+r,function(e){var t,i=$(e.currentTarget);i.addClass("active"),setTimeout(function(){i.removeClass("active")},200);try{n._config.done&&(t=i.attr("data-scx_id"),n._config.done(t))}catch(e){a.Localization.localizeText(n._config.chart,"indicator.all.notification.noMoreSpace").then(function(e){o.Notification.warning(e)})}}),this._resultContainer.on("mouseover","."+r,function(e){var t;n._helpEnabled&&(t=$(e.currentTarget),n._tooltipBodyHovered=!1,n._tooltipHoverTimer=setTimeout(function(){n._lastHoveredLi=t,n._lastHoveredLi.popover("show"),n._tooltipHoverTimer=null},500))}),this._resultContainer.on("mouseout","."+r,function(){n._helpEnabled&&(n._tooltipHoverTimer&&(clearTimeout(n._tooltipHoverTimer),n._tooltipHoverTimer=null),setTimeout(function(){n._tooltipBodyHovered||n._lastHoveredLi&&n._lastHoveredLi.popover("hide")},100))}),e.on("mouseover","div.popover",function(){n._helpEnabled&&(n._tooltipBodyHovered=!0)}),e.on("mouseleave","div.popover",function(){n._helpEnabled&&(n._lastHoveredLi&&n._lastHoveredLi.popover("hide"),n._tooltipBodyHovered=!1)}),a.Environment.isMobile?this._helpPanel.remove():(i=new Switchery(document.querySelector("#scxIndicators_chkHelpSwitcher"),{color:"rgba(72, 149, 245, 0.2)",secondaryColor:"rgba(16, 17, 20, 1)",jackColor:"rgba(72, 149, 245, 1)",jackSecondaryColor:"rgba(81, 83, 90, 1)",className:"scx_switchery",disabled:!1,disabledOpacity:.5,speed:"0.4s"}),e.on("scxSwitcherChanged",function(e,t){$(t.target).is(n._tooltipSwitcher)&&(!1===n._helpDownloaded?(n._tooltipLabel.hide(),n._tooltipDownloading.show(),i.disable(),o.HtmlLoader.loadHtml("IndicatorsHelp.html",function(e){n._helpDownloaded=!0,n._tooltipDownloading.hide(),n._tooltipLabel.show(),i.enable(),n._tooltipHTMLObj=$(e),n._helpEnabled=!0,n._switchHelpTooltips()})):(n._helpEnabled=t.checked,n._switchHelpTooltips()))}))},n.prototype._generateObjects=function(){var o=this,r=a.Indicator.allIndicators(),e=this._resultContainer,t=function(){for(var e=[],t=0,i=r;t<i.length;t++){var n=i[t];e.push(o._generateIndicatorItem(n))}return e}();e.append(t),this._sortItems(e),this._applyColumns(e),this._allIndicators={indicators:t,container:e}},n.prototype._filterIndicators=function(e){e=e.toString().trim().toLowerCase();for(var t,i=0,n=0,o=this._allIndicators.indicators;n<o.length;n++)o[n].detach();(t=this._allIndicators.container).empty();for(var r=0,a=0,s=this._allIndicators.indicators;a<s.length;a++){var l=s[a];0<=l.text().toLowerCase().indexOf(e)&&(r++,i++,t.append(l))}r?(this._sortItems(t),this._applyColumns(t),t.show()):t.hide(),i?this._noResultObj.hide():this._noResultObj.show()},n.prototype._sortItems=function(e){var t=e.children().detach();t.sort(function(e,t){return $(e).text()<$(t).text()?-1:1}),e.append(t)},n.prototype._applyColumns=function(e){e.autocolumnlist({columns:3,classname:"scxIndicatorColumn"})},n.prototype._switchHelpTooltips=function(){for(var e=0,t=this._allIndicators.indicators;e<t.length;e++){var i=t[e];this._helpEnabled?this._enableItemHelpTooltip(i):this._disableItemHelpTooltip(i)}},n.prototype._enableItemHelpTooltip=function(e){var t;this._helpEnabled&&((t=(t=this._tooltipHTMLObj.find("#scxIndicatorTooltip_"+e.attr("data-scx_id")).clone()).length?t:$('<p style="margin-bottom: 0;" data-i18n="indicator.all.help.dialog.noInfo"></p>')).css({display:"block"}).addClass("scxIndicators_tooltipWrapper"),this._config.chart.localize(t),e.addClass(i).popover({trigger:"manual",placement:"auto left",delay:{show:500,hide:100},container:o.HtmlContainer.instance.componentsContainer,viewport:{selector:"body",padding:0},html:!0,content:function(){return $("<div></div>").append(t).html()}}))},n.prototype._disableItemHelpTooltip=function(e){e.removeClass(i).popover("destroy")},n.prototype._generateIndicatorItem=function(e){return $('<li class="scxIndicatorItem" data-scx_id=""></li>').attr("data-scx_id",e).scxLocalize("indicator."+e+".name")},n.prototype._clearInput=function(){this._inp_search.val(""),this._filterIndicators(""),this._inp_search.focus()},n.prototype._setDialogTitle=function(){this._title.scxLocalize("indicator.all.title")},n.prototype._initFields=function(){this._inp_search=this._dialog.find("#scxIndicators_inp_search"),this._title=this._dialog.find("#scxIndicatorsDialog_title"),this._resultContainer=this._dialog.find("#scxIndicatorsResult"),this._noResultObj=this._dialog.find(".scxNoResult"),this._tooltipSwitcher=this._dialog.find("#scxIndicators_chkHelpSwitcher"),this._tooltipDownloading=this._dialog.find(".scxLabel_downloading"),this._tooltipLabel=this._dialog.find('label[for="scxIndicators_chkHelpSwitcher"]'),this._btnClearInput=this._dialog.find("#scxIndicators_btn_clearInput"),this._helpPanel=this._dialog.find(".scxIndicators_helpControlPanel")},n.showSettingsBeforeAdding=!1,n);function n(e){e=t.call(this,e)||this;return e._helpDownloaded=!1,e._helpEnabled=!1,e._tooltipHoverTimer=null,e._tooltipBodyHovered=!1,e._lastHoveredLi=null,e._tooltipHTMLObj=null,e._initFields(),e._init(),e}o.IndicatorsDialog=e}(a.UI||(a.UI={}))}(StockChartX=StockChartX||{}),this&&this.__assign||Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}),__awaiter=this&&this.__awaiter||function(r,a,s,l){return new(s=s||Promise)(function(e,t){function i(e){try{o(l.next(e))}catch(e){t(e)}}function n(e){try{o(l.throw(e))}catch(e){t(e)}}function o(t){t.done?e(t.value):new s(function(e){e(t.value)}).then(i,n)}o((l=l.apply(r,a||[])).next())})},__generator=this&&this.__generator||function(n,o){var r,a,s,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(i){return function(e){var t=[i,e];if(r)throw new TypeError("Generator is already executing.");for(;l;)try{if(r=1,a&&(s=a[2&t[0]?"return":t[0]?"throw":"next"])&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[0,s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return l.label++,{value:t[1],done:!1};case 5:l.label++,a=t[1],t=[0];continue;case 7:t=l.ops.pop(),l.trys.pop();continue;default:if(!(s=0<(s=l.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){l=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3])){l.label=t[1];break}if(6===t[0]&&l.label<s[1]){l.label=s[1],s=t;break}if(s&&l.label<s[2]){l.label=s[2],l.ops.push(t);break}s[2]&&l.ops.pop(),l.trys.pop();continue}t=o.call(n,l)}catch(e){t=[6,e],a=0}finally{r=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},__extends=(!function(u){!function(e){"use strict";var i="scxToolbarLoadableInputLoading",s="data-scxinstrument",l="active",c=13,h=27,d=40,_=38;function t(e,t){this._instruments=[],this._repositoryParams={skip:0,take:10},this._inputField=e,this._config=t,this._value=t.value||"",this._config.onChange=u.JsUtil.isFunction(t.onChange)?t.onChange:null,this._isDropDownVisible=!1,this._resultsCount=0,this._currentText="",this._resultsDropDown=$('<div class="scxInstrumentSearchResults"></div>'),this._noResults=$('<div class="scxInstrumentSearchNoResults"></div>'),null!==t.instruments&&Array.isArray(t.instruments)&&0<t.instruments.length&&(this._config.instruments=t.instruments),this._init()}t.prototype._init=function(){var t=this;this._inputField.addClass("scxInstrumentSearchInputField"),this._inputField.attr("type","text"),this._inputField.wrap('<div class="scxToolbarLoadableInput"></div>'),this._inputContainer=this._inputField.parent(),this._config.value?(this._inputField.val(this._value),this._currentText=this._value):this._inputField.val(""),e.HtmlContainer.instance.register("searchResult",this._resultsDropDown),this._setupInputListeners(),this._inputField.on(u.MouseEvent.CLICK,function(){t._inputField.select()}),$(window).scroll(function(){t._hideDropDown()}),$(window).resize(function(){t._hideDropDown()}),this._resultsDropDown.on(u.MouseEvent.CLICK,".scxInstrumentSearchItem",function(e){t._setValue($(e.currentTarget).attr(s),!0),t._hideDropDown()}),this._resultsDropDown.on(u.MouseEvent.OVER,".scxInstrumentSearchItem",function(e){$(e.currentTarget).parent().children().removeClass(l),$(e.currentTarget).addClass(l)}),this._resultsDropDown.on("scroll",function(a){return __awaiter(t,void 0,void 0,function(){var t,i,n,o,r;return __generator(this,function(e){switch(e.label){case 0:return(a.stopPropagation(),n=a.target,t=n.clientHeight,i=n.scrollTop,n=n.scrollHeight,t+i<n)?[2]:(this._repositoryParams.skip+=this._repositoryParams.take,o=this._generateSearchResults,r=[this._getInputValue().toUpperCase()],[4,this._search(this._getInputValue())]);case 1:return o.apply(this,r.concat([e.sent(),!1])),[2]}})})}),$(document).on(u.MouseEvent.CLICK,function(e){e=$(e.currentTarget);t._isDropDownVisible&&!e.is(t._inputField)&&0===e.parents(".scxInstrumentSearchResults").length&&(t._inputField.val(t._value),t._hideDropDown())}),$("body").bind("scxContextMenuOpen",function(e){t._inputField.val(t._value),t._hideDropDown()})},t.prototype.set=function(e){this._setValue(e?e.symbol:"")},t.prototype.getBySymbol=function(){throw new Error("getBySymbol is deprecated!")},t.prototype._setupInputListeners=function(){var e=this;this._inputField.on("input",function(){return __awaiter(e,void 0,void 0,function(){var t,i;return __generator(this,function(e){switch(e.label){case 0:return this._isDropDownVisible||$("body").trigger("click"),(t=this._getInputValue())===this._currentText?[3,2]:[4,this._search(t)];case 1:i=e.sent(),this._currentText=t,this._resultsCount=i.length,this._showDropDown(),this._generateSearchResults(t.toUpperCase(),i),e.label=2;case 2:return[2]}})})}),this._inputField.focus(function(e){$(e.currentTarget).addClass(l)}),this._inputField.blur(function(e){$(e.currentTarget).removeClass(l)}),this._inputField.keyup(function(a){return __awaiter(e,void 0,void 0,function(){var t,i,n,o,r;return __generator(this,function(e){switch(e.label){case 0:switch(t=a.which){case h:this._inputField.val(this._value),this._hideDropDown(),this._inputField.blur();break;case c:i=this._getInputValue(),this._isDropDownVisible&&0<(n=this._resultsDropDown.find(" > ."+l)).length&&(i=n.attr(s)),this._setValue(i,!0),this._hideDropDown(),this._inputField.blur()}return this._isDropDownVisible||t!==d&&t!==_?[3,2]:(this._showDropDown(),o=this._generateSearchResults,r=[this._getInputValue().toUpperCase()],[4,this._search(this._getInputValue())]);case 1:o.apply(this,r.concat([e.sent()])),e.label=2;case 2:if(0<this._resultsCount)switch(t){case d:this._highlightDropDownItem(!1);break;case _:this._highlightDropDownItem(!0)}return[2]}})})})},t.prototype._getInputValue=function(){return $("<div></div>").text(this._inputField.val()).html()},t.prototype._highlightDropDownItem=function(e){var t=this._resultsDropDown,i=t.find(" > ."+l),n=this._resultsDropDown.children(),e=(0===i.length?(e?n.last():n.first()).addClass(l):(i.removeClass(l),(e?i.is(n.first())?n.last():i.prev():i.is(n.last())?n.first():i.next()).addClass(l)),(i=t.find(" > ."+l)).outerHeight()*i.index()),n=e+i.outerHeight();e<t.scrollTop()?t.scrollTop(e):n>t.scrollTop()+t.outerHeight()&&t.scrollTop(n-t.height())},t.prototype._setValue=function(e,t){this._value=this._currentText=e,this._inputField.val(e),t&&this._config.onChange&&this._config.onChange(this._getInstrumentBySymbol(e))},t.prototype._hideDropDown=function(){this._isDropDownVisible=!1,this._resultsDropDown.empty().hide(),this._currentText=this._inputField.val(),this._repositoryParams.skip=0},t.prototype._showDropDown=function(){var e,t,i,n,o,r=this,a=(this._resultsDropDown.width("41.6651em"),$(window)),s=a.width(),l=this._resultsDropDown.outerWidth(!0);s<l&&this._resultsDropDown.outerWidth(s),this._isDropDownVisible||(this._isDropDownVisible=!0,e=this._inputField.outerHeight(),t=a.scrollTop(),i=a.scrollLeft(),o=(n=this._inputField.offset()).left,0<i&&(o-=i),0<t&&(e-=t),this._resultsDropDown.css({top:n.top+e+2,left:o,maxHeight:a.height()-n.top-e-10}),s<l&&this._resultsDropDown.width(s),this._resultsDropDown.show(),u.Localization.localizeText(this._config.chart,"instrument.noResults").then(function(e){r._noResults.text(e)}))},t.prototype._generateSearchResults=function(e,t,i){if(void 0===i&&(i=!0),this._noResults.detach(),i?(this._instruments=t,this._resultsDropDown.empty()):this._instruments.concat(t),0===t.length)this._noResults.appendTo(this._resultsDropDown);else{for(var n="",o=0,r=t;o<r.length;o++){var a=r[o];n+=this._generateListElement(e,a.symbol,a.company,a.exchange)}0<n.length&&this._resultsDropDown.append($(n))}},t.prototype._generateListElement=function(e,t,i,n){return'<div class="scxInstrumentSearchItem" '+s+'="'+t+'"><div class="scxInstrumentSearchItem_SymbolContainer"><span class="scxInstrumentSearchItem_Symbol">'+this._highlightHTMLText(e,t)+'</span></div><div class="scxInstrumentSearchItem_NameContainer"><span class="scxInstrumentSearchItem_Name">'+this._highlightHTMLText(e,i)+'</span></div><div class="scxInstrumentSearchItem_ExchangeContainer"><span class="scxInstrumentSearchItem_Exchange">'+n+"</span></div></div>"},t.prototype._highlightHTMLText=function(e,t){if(""===e)return t;var i=this._searchTextPositions(e,t),n="",o=0;if(1===e.length&&1<i.length)for(var r=i.length-1;0<r;r--)i[r].pos-1===i[r-1].pos&&(i[r-1].len+=1,i.splice(r,1));for(var a=0,s=i;a<s.length;a++){var l=s[a];n+=t.substr(o,l.pos-o)+'<span class="scxHighlightedText">'+t.substr(l.pos,l.len)+"</span>",o=l.pos+l.len}return o<t.length&&(n+=t.substr(o,t.length-o)),n},t.prototype._searchTextPositions=function(e,t){var i,n=0,o=[],r=e.length;for(e=e.toLowerCase(),t=t.toLowerCase();-1<(i=t.indexOf(e,n));)o.push({pos:i,len:r}),n=i+1;return o},t.prototype._search=function(e){var t=this;return e=e.toLowerCase()||"",this._inputContainer.addClass(i),this._getInstruments(__assign({},this._repositoryParams,{search:e})).then(function(e){return t._inputContainer.removeClass(i),e})},t.prototype._getInstrumentBySymbol=function(t){return this._instruments.find(function(e){return e.symbol===t})||null},t.prototype._getInstruments=function(e){return this._config.chart.instrumentsRepository.getItems(e)},e.InstrumentSearch=t}(u.UI||(u.UI={}))}(StockChartX=StockChartX||{}),!function(r){!function(e){"use strict";var o=jQuery;function t(t){var i=this;this._visible=!0,e.HtmlLoader.loadHtml("Navigation.html",function(e){i._init(e,t)})}Object.defineProperty(t.prototype,"visible",{get:function(){return this._visible},set:function(e){this._visible=e,this._updateVisibility()},enumerable:!0,configurable:!0}),t.prototype._init=function(e,t){var i=this,e=o(e).appendTo(t.target),n=(this.container=e.find(".scxNavigation"),this.chart=t.chart);this.container.find(".scxNavigation-btn-scrollLeft").on("click",function(){n.scrollOnPixels(n.size.width/5),n.setNeedsUpdate(!0)}),this.container.find(".scxNavigation-btn-scrollRight").on("click",function(){n.scrollOnPixels(-n.size.width/5),n.setNeedsUpdate(!0)}),this.container.find(".scxNavigation-btn-zoomIn").on("click",function(){n.zoomOnPixels(n.size.width/5),n.setNeedsUpdate(!0)}),this.container.find(".scxNavigation-btn-zoomOut").on("click",function(){n.zoomOnPixels(-n.size.width/5),n.setNeedsUpdate(!0)}),this.container.find(".scxNavigation-btn-reload").on("click",function(){n.reload()}),this.container.find(".scxNavigation-btn-scrollToFirst").on("click",function(){var e=i.chart.lastVisibleRecord-n.firstVisibleRecord;1<e&&(n.firstVisibleRecord=0,n.lastVisibleRecord=Math.min(e,n.recordCount-1),n.setNeedsUpdate(!0))}),this.container.find(".scxNavigation-btn-scrollToLast").on("click",function(){var e,t,i=n.recordCount;0<i&&(e=n.firstVisibleRecord,t=n.lastVisibleRecord,n.lastVisibleRecord=i-1,n.firstVisibleRecord=Math.max(i-(t-e+1),0),n.setNeedsUpdate(!0))}),e.mouseover(function(){r.HtmlUtil.setVisibility(i.container,i._visible)}),e.mouseout(function(){r.HtmlUtil.setVisibility(i.container,!1)}),this._updateVisibility(),this.chart.pixelsPrice&&this.chart.setPixelsPrice(this.chart.pixelsPrice)},t.prototype._updateVisibility=function(){this.container&&r.HtmlUtil.setVisibility(this.container,!1)},t.prototype.draw=function(){this.dateScaleContainer||(this.dateScaleContainer=this.chart&&this.chart.rootDiv.find(".scxBottomDateScale")),this.dateScaleContainer},t.prototype.destroy=function(){this.chart=null},e.ChartNavigation=t}(r.UI||(r.UI={}))}(StockChartX=StockChartX||{}),this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}()),__awaiter=this&&this.__awaiter||function(r,a,s,l){return new(s=s||Promise)(function(e,t){function i(e){try{o(l.next(e))}catch(e){t(e)}}function n(e){try{o(l.throw(e))}catch(e){t(e)}}function o(t){t.done?e(t.value):new s(function(e){e(t.value)}).then(i,n)}o((l=l.apply(r,a||[])).next())})},__generator=this&&this.__generator||function(n,o){var r,a,s,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(i){return function(e){var t=[i,e];if(r)throw new TypeError("Generator is already executing.");for(;l;)try{if(r=1,a&&(s=a[2&t[0]?"return":t[0]?"throw":"next"])&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[0,s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return l.label++,{value:t[1],done:!1};case 5:l.label++,a=t[1],t=[0];continue;case 7:t=l.ops.pop(),l.trys.pop();continue;default:if(!(s=0<(s=l.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){l=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3])){l.label=t[1];break}if(6===t[0]&&l.label<s[1]){l.label=s[1],s=t;break}if(s&&l.label<s[2]){l.label=s[2],l.ops.push(t);break}s[2]&&l.ops.pop(),l.trys.pop();continue}t=o.call(n,l)}catch(e){t=[6,e],a=0}finally{r=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},__extends=(!function(c){!function(e){"use strict";var t,i="#scxPriceStyleDialog_",n=".scxPriceStyleDialog_input_",o=".scxPriceStyleDialog_panel_ntb_",r={showArrows:!0,maxValue:100,minValue:1,value:1},a={showArrows:!0,maxValue:100,minValue:.01,priceDecimals:5,value:1},s=(t=e.Dialog,__extends(l,t),l.prototype.show=function(e){this.initDialog(e)&&(this._priceStyleKind=e.priceStyle.chart.priceStyleKind,this._setDialogTitle(),this._setValues(this._priceStyleKind),this._switchView(this._priceStyleKind),t.prototype.show.call(this,e))},l.prototype._init=function(){var e=this;this._input_ATRlength.scxNumericField(r),this._input_boxSize.scxNumericField(a),this._input_pointsCount.scxNumericField(r),this._input_reversalAmount.scxNumericField(r),this._input_reversalDoubleAmount.scxNumericField(a),this._input_numberOfLine.scxNumericField(r),this._input_source.selectpicker({container:"body"}),this._input_boxSizeKind.selectpicker({container:"body"}),this._input_barStyle.selectpicker({container:"body"}),this._input_coloredBarStyle.selectpicker({container:"body"}),this._input_source.on("change",function(){e._source=e._input_source.val(),e._switchPriceStyleMethod()}),this._input_boxSizeKind.on("change",function(){e._boxSizeKind=e._input_boxSizeKind.val(),e._switchPriceStyleMethod()}),this._input_barStyle.on("change",function(){e._barsStyle=e._input_barStyle.val()}),this._input_coloredBarStyle.on("change",function(){e._coloredBarsStyle=e._input_coloredBarStyle.val()}),this._dialog.find(i+"btn_save").on("click",function(){e._apply()})},l.prototype._switchView=function(e){switch(this._panelFigureInputsPanel.show(),e){case c.PointAndFigurePriceStyle.className:return this._switchPriceStyleMethod(),this._panelFigureNumberOfLine.hide(),this._panelFigureSource.show(),this._panelFigureBoxCalculationMethods.show(),this._panelFigureReversalAmount.show(),this._panelFigureReversalDoubleAmount.hide(),this._panelFigureBarStyle.hide(),void this._panelFigureColoredBarStyle.hide();case c.RenkoPriceStyle.className:case c.KagiPriceStyle.className:return this._switchPriceStyleMethod(),this._panelFigureNumberOfLine.hide(),this._panelFigureSource.hide(),this._panelFigureBoxCalculationMethods.show(),this._panelFigureReversalAmount.hide(),this._panelFigureReversalDoubleAmount.hide(),this._panelFigureBarStyle.hide(),void this._panelFigureColoredBarStyle.hide();case c.LineBreakPriceStyle.className:return this._panelFigureNumberOfLine.show(),this._panelFigureSource.hide(),this._panelFigureBoxCalculationMethods.hide(),this._panelFigureReversalAmount.hide(),this._panelFigureBoxSize.hide(),this._panelFigurePointsCount.hide(),this._panelFigureATRLength.hide(),this._panelFigureReversalDoubleAmount.hide(),this._panelFigureBarStyle.hide(),void this._panelFigureColoredBarStyle.hide();case c.BarPriceStyle.className:case c.HLBarPriceStyle.className:case c.HLCBarPriceStyle.className:return this._panelFigureBarStyle.show(),this._panelFigureNumberOfLine.hide(),this._panelFigureSource.hide(),this._panelFigureBoxCalculationMethods.hide(),this._panelFigureReversalAmount.hide(),this._panelFigureBoxSize.hide(),this._panelFigurePointsCount.hide(),this._panelFigureATRLength.hide(),this._panelFigureReversalDoubleAmount.hide(),void this._panelFigureColoredBarStyle.hide();case c.ColoredBarPriceStyle.className:case c.ColoredHLBarPriceStyle.className:case c.ColoredHLCBarPriceStyle.className:return this._panelFigureColoredBarStyle.show(),this._panelFigureBarStyle.hide(),this._panelFigureNumberOfLine.hide(),this._panelFigureSource.hide(),this._panelFigureBoxCalculationMethods.hide(),this._panelFigureReversalAmount.hide(),this._panelFigureBoxSize.hide(),this._panelFigurePointsCount.hide(),this._panelFigureATRLength.hide(),void this._panelFigureReversalDoubleAmount.hide();default:return}},l.prototype._switchPriceStyleMethod=function(){switch(this._boxSizeKind){case c.PointAndFigureBoxSizeKind.ATR:this._panelFigureBoxSize.hide(),this._panelFigurePointsCount.hide(),this._panelFigureATRLength.show();break;case c.PointAndFigureBoxSizeKind.FIXED:this._panelFigureBoxSize.show(),this._panelFigurePointsCount.hide(),this._panelFigureATRLength.hide();break;case c.PointAndFigureBoxSizeKind.POINTS:this._panelFigureBoxSize.hide(),this._panelFigurePointsCount.show(),this._panelFigureATRLength.hide()}},l.prototype._setValues=function(e){switch(e){case c.PointAndFigurePriceStyle.className:var t=this._config.priceStyle;switch(this._source=t.source,this._input_source.selectpicker("val",this._source||c.PointAndFigureSource.CLOSE).selectpicker("refresh"),this._boxSizeKind=t.boxSize.kind,this._input_boxSizeKind.selectpicker("val",this._boxSizeKind||c.PointAndFigureBoxSizeKind.ATR).selectpicker("refresh"),this._boxSizeKind){case c.PointAndFigureBoxSizeKind.ATR:this._input_ATRlength.scxNumericField("setValue",t.boxSize.value||1);break;case c.PointAndFigureBoxSizeKind.FIXED:this._input_boxSize.scxNumericField("setValue",t.boxSize.value||1);break;case c.PointAndFigureBoxSizeKind.POINTS:this._input_pointsCount.scxNumericField("setValue",t.boxSize.value||1)}return void this._input_reversalAmount.scxNumericField("setValue",t.reversal||1);case c.RenkoPriceStyle.className:var i=this._config.priceStyle;switch(this._boxSizeKind=i.boxSize.kind,this._input_boxSizeKind.selectpicker("val",this._boxSizeKind||c.RenkoBoxSizeKind.ATR).selectpicker("refresh"),this._boxSizeKind){case c.PointAndFigureBoxSizeKind.ATR:this._input_ATRlength.scxNumericField("setValue",i.boxSize.value||1);break;case c.PointAndFigureBoxSizeKind.FIXED:this._input_boxSize.scxNumericField("setValue",i.boxSize.value||1);break;case c.PointAndFigureBoxSizeKind.POINTS:this._input_pointsCount.scxNumericField("setValue",i.boxSize.value||1)}return;case c.KagiPriceStyle.className:var n=this._config.priceStyle;switch(this._boxSizeKind=n.reversal.kind,this._input_boxSizeKind.selectpicker("val",this._boxSizeKind||c.KagiReversalKind.ATR).selectpicker("refresh"),this._boxSizeKind){case c.PointAndFigureBoxSizeKind.ATR:this._input_reversalAmount.scxNumericField("setValue",n.reversal.value||1);break;case c.PointAndFigureBoxSizeKind.FIXED:case c.PointAndFigureBoxSizeKind.POINTS:this._input_reversalDoubleAmount.scxNumericField("setValue",n.reversal.value||1)}return;case c.LineBreakPriceStyle.className:var o=this._config.priceStyle;return void this._input_numberOfLine.scxNumericField("setValue",o.lines||1);case c.BarPriceStyle.className:case c.HLBarPriceStyle.className:case c.HLCBarPriceStyle.className:return void this._setBarStyle(e);case c.ColoredBarPriceStyle.className:case c.ColoredHLBarPriceStyle.className:case c.ColoredHLCBarPriceStyle.className:return void this._setBarStyle(e,!0);default:return void this.hide()}},l.prototype._setBarStyle=function(e,t){t?(this._coloredBarsStyle=e,this._input_coloredBarStyle.selectpicker("val",e).selectpicker("refresh")):(this._barsStyle=e,this._input_barStyle.selectpicker("val",e).selectpicker("refresh"))},l.prototype._getValues=function(){var e=this._config.chart,t={value:c.PointAndFigurePriceStyle.defaults.boxSize.value,kind:this._input_boxSizeKind.val()};switch(this._priceStyleKind){case c.PointAndFigurePriceStyle.className:var i=this._config.priceStyle;switch(i.source=this._input_source.val(),t.kind=this._input_boxSizeKind.val(),i.boxSize.kind){case c.PointAndFigureBoxSizeKind.ATR:t.value=this._input_ATRlength.scxNumericField("getValue");break;case c.PointAndFigureBoxSizeKind.FIXED:t.value=this._input_boxSize.scxNumericField("getValue");break;case c.PointAndFigureBoxSizeKind.POINTS:t.value=this._input_pointsCount.scxNumericField("getValue")}i.boxSize=t,i.reversal=this._input_reversalAmount.scxNumericField("getValue");break;case c.RenkoPriceStyle.className:i=this._config.priceStyle;switch(t.kind=this._input_boxSizeKind.val(),i.boxSize.kind){case c.PointAndFigureBoxSizeKind.ATR:t.value=this._input_ATRlength.scxNumericField("getValue");break;case c.PointAndFigureBoxSizeKind.FIXED:t.value=this._input_boxSize.scxNumericField("getValue");break;case c.PointAndFigureBoxSizeKind.POINTS:t.value=this._input_pointsCount.scxNumericField("getValue")}i.boxSize=t;break;case c.KagiPriceStyle.className:var i=this._config.priceStyle,n={kind:this._input_boxSizeKind.val(),value:c.KagiPriceStyle.defaults.reversal.value};switch(i.reversal.kind){case c.PointAndFigureBoxSizeKind.ATR:n.value=this._input_reversalAmount.scxNumericField("getValue");break;case c.PointAndFigureBoxSizeKind.FIXED:case c.PointAndFigureBoxSizeKind.POINTS:n.value=this._input_reversalDoubleAmount.scxNumericField("getValue")}i.reversal=n;break;case c.LineBreakPriceStyle.className:this._config.priceStyle.lines=this._input_numberOfLine.scxNumericField("getValue");break;case c.BarPriceStyle.className:case c.HLBarPriceStyle.className:case c.HLCBarPriceStyle.className:e.priceStyleKind=this._barsStyle,e.update();break;case c.ColoredBarPriceStyle.className:case c.ColoredHLBarPriceStyle.className:case c.ColoredHLCBarPriceStyle.className:e.priceStyleKind=this._coloredBarsStyle,e.update();break;default:throw new Error("Unknown price style: "+this._priceStyleKind)}},l.prototype._apply=function(){this._getValues();var e=this._config.chart.priceStyleKind;e!==c.BarPriceStyle.className&&e!==c.HLBarPriceStyle.className&&e!==c.HLCBarPriceStyle.className&&e!==c.ColoredBarPriceStyle.className&&e!==c.ColoredHLBarPriceStyle.className&&e!==c.ColoredHLCBarPriceStyle.className&&this._config.priceStyle.apply(),this._config.chart.dateScale.setNeedsAutoScale(),this._config.chart.setNeedsUpdate(!0),this.hide()},l.prototype._setDialogTitle=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return[4,c.Localization.localizeText(this._config.chart,"priceStyle.all.dialog.kind."+this._priceStyleKind)];case 1:return t=e.sent(),[4,c.Localization.localizeText(this._config.chart,"priceStyle.all.dialog.title",{replace:{priceStyleName:t}})];case 2:return t=e.sent(),this._title.text(t),[2]}})})},l.prototype._initFields=function(){var e=this._dialog;this._title=e.find(i+"title"),this._panelFigureInputsPanel=e.find(o+"inputsPanel"),this._input_source=e.find(n+"source"),this._input_boxSizeKind=e.find(n+"boxSizeKind"),this._input_ATRlength=e.find(n+"ATRLength"),this._input_boxSize=e.find(n+"boxSize"),this._input_pointsCount=e.find(n+"pointsCount"),this._input_reversalAmount=e.find(n+"reversalAmount"),this._input_reversalDoubleAmount=e.find(n+"reversalDoubleAmount"),this._input_numberOfLine=e.find(n+"numberOfLine"),this._panelFigureSource=e.find(o+"source"),this._panelFigureBoxCalculationMethods=e.find(o+"boxSizeKind"),this._panelFigureATRLength=e.find(o+"ATRLength"),this._panelFigureBoxSize=e.find(o+"boxSize"),this._panelFigurePointsCount=e.find(o+"pointsCount"),this._panelFigureReversalAmount=e.find(o+"reversalAmount"),this._panelFigureReversalDoubleAmount=e.find(o+"reversalDoubleAmount"),this._panelFigureNumberOfLine=e.find(o+"numberOfLine"),this._panelFigureBarStyle=e.find(o+"barStyle"),this._input_barStyle=e.find(n+"barStyle"),this._panelFigureColoredBarStyle=e.find(o+"coloredBarStyle"),this._input_coloredBarStyle=e.find(n+"coloredBarStyle")},l);function l(e){e=t.call(this,e)||this;return e._initFields(),e._init(),e}e.PriceStyleSettingsDialog=s}(c.UI||(c.UI={}))}(StockChartX=StockChartX||{}),this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}()),__awaiter=this&&this.__awaiter||function(r,a,s,l){return new(s=s||Promise)(function(e,t){function i(e){try{o(l.next(e))}catch(e){t(e)}}function n(e){try{o(l.throw(e))}catch(e){t(e)}}function o(t){t.done?e(t.value):new s(function(e){e(t.value)}).then(i,n)}o((l=l.apply(r,a||[])).next())})},__generator=this&&this.__generator||function(n,o){var r,a,s,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(i){return function(e){var t=[i,e];if(r)throw new TypeError("Generator is already executing.");for(;l;)try{if(r=1,a&&(s=a[2&t[0]?"return":t[0]?"throw":"next"])&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[0,s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return l.label++,{value:t[1],done:!1};case 5:l.label++,a=t[1],t=[0];continue;case 7:t=l.ops.pop(),l.trys.pop();continue;default:if(!(s=0<(s=l.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){l=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3])){l.label=t[1];break}if(6===t[0]&&l.label<s[1]){l.label=s[1],s=t;break}if(s&&l.label<s[2]){l.label=s[2],l.ops.push(t);break}s[2]&&l.ops.pop(),l.trys.pop();continue}t=o.call(n,l)}catch(e){t=[6,e],a=0}finally{r=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},__extends=(!function(h){!function(i){"use strict";var t,e="#scxThemeDialog_",n="#scxThemeDialog_label_",o="#scxThemeDialog_chk_",r="#scxThemeDialog_input_",a="#scxThemeDialog_btn_",s="theme.name.",l=(t=i.Dialog,__extends(c,t),c.prototype.show=function(e){this.initDialog(e)&&(this._setValues(),this._hideNewThemeForm(),t.prototype.show.call(this,e),this._chart=e.chart)},c.prototype._init=function(){var n=this;this._fieldTextFont.selectpicker({container:"body"}).change(function(e){n._fieldTextFont.next().css({"font-family":e.target.value})}),this._fieldTextSize.selectpicker({container:"body"}),this._fieldTheme.selectpicker({container:"body"}).change(function(e){e=$(e.currentTarget).val();e&&n._config.theme.name!==e&&(n._setTitle(e),n._config.theme=h.Theme[e],n._setValues())}),this._btnNewTheme.on("click",function(){var e,t=n._dialogBody.scrollTop();n._showNewThemeForm(),n.resize(),n._dialogBody[0].scrollHeight>$(window).height()&&(e=n._wrapperTheme.position().top+n._wrapperTheme.outerHeight(!0)-n._dialogBody.height(),n._dialogBody.scrollTop(t=t<e?e:t))}),this._fieldNewThemeName.keyup(function(e){13===e.which&&n._addNewTheme()}),this._fieldNewThemeName.on("input",function(e){n._highlightNewThemeNameInvalid(!1),n._switchNewThemeConfirmButton($(e.currentTarget).val().length)}),this._btnNewThemeConfirm.on("click",function(){n._addNewTheme()}),this._dialog.find(".scxSpectrum").scx().colorPicker({localStorageKey:"scxThemeDialog_spectrum"}),this._chkUpBarBorderEnabled=new Switchery(document.querySelector(o+"upBarBorderColor"),c._switcherySettings),this._chkDownBarBorderEnabled=new Switchery(document.querySelector(o+"downBarBorderColor"),c._switcherySettings),this._chkUpBarBorderEnabled.setPosition(!1),this._chkDownBarBorderEnabled.setPosition(!1),$("body").on("scxSwitcherChanged",function(e,t){var i=$(t.target),t=t.checked;i.is(n._fieldUpBarBorderEnabled)?n._setUpBarBorderState(t):i.is(n._fieldDownBarBorderEnabled)&&n._setDownBarBorderState(t)}),this._btnSaveTheme.on("click",function(){var e=n._getValues();n._saveTheme(e),n._apply(e)}),this._btnApply.on("click",function(){n._apply()})},c.prototype._saveTheme=function(e){var t=this;(e=null==e?this._getValues():e).name=this._config.theme.name,this._config.theme=e,h.Theme[this._config.theme.name]=this._config.theme,h.Localization.localizeText(this._chart,"theme.notification.msg.success").then(function(e){i.Notification.success(t._chart,e,null)})},c.prototype._addNewTheme=function(){var e=(e=h.JsUtil.filterText(this._fieldNewThemeName.val())).replace(/\/|;|$|'|"|/gi,"");void 0===h.Theme[e]?(""!==e&&(this._setTitle(e),this._fieldTheme.append(c._generateThemeSelectorItem(e)),this._config.theme=this._getValues(),this._config.theme.name=e,h.Theme[e]=this._config.theme,this._fieldTheme.selectpicker("val",e).selectpicker("refresh")),this._hideNewThemeForm()):this._highlightNewThemeNameInvalid(!0)},c.prototype._showNewThemeForm=function(){this._btnNewTheme.hide(),this._wrapperTheme.show(),h.Environment.isMobile||this._fieldNewThemeName.focus()},c.prototype._hideNewThemeForm=function(){this._fieldNewThemeName.val(""),this._wrapperTheme.hide(),this._btnNewTheme.show()},c.prototype._switchNewThemeConfirmButton=function(e){e?this._btnNewThemeConfirm.scxLocalize("dialog.button.ok").removeClass(c.CLASS_BTN_DEFAULT).addClass(c.CLASS_BTN_PRIMARY):this._btnNewThemeConfirm.scxLocalize("dialog.button.cancel").removeClass(c.CLASS_BTN_PRIMARY).addClass(c.CLASS_BTN_DEFAULT),this._config.chart.localize(this._btnNewThemeConfirm)},c.prototype._setTitle=function(n){return __awaiter(this,void 0,void 0,function(){var t,i;return __generator(this,function(e){switch(e.label){case 0:return t=this._config.chart,[4,h.Localization.localizeText(t,s+n,{defaultValue:n})];case 1:return i=e.sent(),[4,h.Localization.localizeText(t,"theme.dialog.title",{replace:{themeName:i}})];case 2:return i=e.sent(),this._dialogTitle.text(i),[2]}})})},c._generateThemeSelectorItem=function(e){return e=h.JsUtil.filterText(e),$('<option title="'+e+'" value="'+e+'" data-i18n="'+(s+e)+'">'+e+"</option>")},c.prototype._setUpBarBorderState=function(e){e?(this._fieldUpBarBorderColor.spectrum("enable"),this._labelUpBarBorderColor.removeClass("disabled"),this._chkUpBarBorderEnabled.isChecked()||this._chkUpBarBorderEnabled.setPosition(!0)):(this._fieldUpBarBorderColor.spectrum("disable"),this._labelUpBarBorderColor.addClass("disabled"),this._chkUpBarBorderEnabled.isChecked()&&this._chkUpBarBorderEnabled.setPosition(!0))},c.prototype._setDownBarBorderState=function(e){e?(this._fieldDownBarBorderColor.spectrum("enable"),this._labelDownBarBorderColor.removeClass("disabled"),this._chkDownBarBorderEnabled.isChecked()||this._chkDownBarBorderEnabled.setPosition(!0)):(this._fieldDownBarBorderColor.spectrum("disable"),this._labelDownBarBorderColor.addClass("disabled"),this._chkDownBarBorderEnabled.isChecked()&&this._chkDownBarBorderEnabled.setPosition(!0))},c.prototype._setValues=function(){var e,t=this._config.theme,i=(this._setTitle(t.name),this._fieldLineBarColor.spectrum("set",t.plot.line.simple.strokeColor),this._fieldUpBarColor.spectrum("set",t.plot.bar.candle.upCandle.fill.fillColor),this._fieldDownBarColor.spectrum("set",t.plot.bar.candle.downCandle.fill.fillColor),this._fieldUpBarBorderColor.spectrum("set",t.plot.bar.candle.upCandle.border.strokeColor),this._setUpBarBorderState(t.plot.bar.candle.upCandle.border.strokeEnabled),this._fieldDownBarBorderColor.spectrum("set",t.plot.bar.candle.downCandle.border.strokeColor),this._setDownBarBorderState(t.plot.bar.candle.downCandle.border.strokeEnabled),this._fieldWickColor.spectrum("set",t.plot.bar.candle.upCandle.wick.strokeColor),this._fieldTextFont.selectpicker("val",t.valueScale.text.fontFamily).selectpicker("refresh"),this._fieldTextSize.selectpicker("val",t.valueScale.text.fontSize).selectpicker("refresh"),this._fieldTextColor.spectrum("set",t.valueScale.text.fillColor),t.chart.background),n=(Array.isArray(i)?(this._fieldGradient1Color.spectrum("set",i[0]),this._fieldGradient2Color.spectrum("set",i[1]||i[0])):(this._fieldGradient1Color.spectrum("set",i),this._fieldGradient2Color.spectrum("set",i)),this._fieldValueScalePanelColor.spectrum("set",t.valueScale.fill.fillColor),this._fieldDateScalePanelColor.spectrum("set",t.dateScale.fill.fillColor),this._fieldGridColor.spectrum("set",t.chartPanel.grid.strokeColor),[]);for(e in h.Theme)h.Theme.hasOwnProperty(e)&&n.push(c._generateThemeSelectorItem(h.Theme[e].name));this._fieldTheme.empty().append(n),this._fieldTheme.selectpicker("val",this._config.theme.name),this._fieldTheme.selectpicker("refresh"),this._config.chart.localize()},c.prototype._getValues=function(){var e=$.extend(!0,{},this._config.theme),t=this._fieldLineBarColor.spectrum("get").toRgbString(),t=(e.plot.line.simple.strokeColor=t,e.plot.line.mountain.line.strokeColor=t,e.plot.bar.OHLC.strokeColor=t,e.plot.bar.HLC.strokeColor=t,e.plot.bar.HL.strokeColor=t,this._fieldUpBarColor.spectrum("get").toRgbString()),t=(e.plot.bar.candle.upCandle.fill.fillColor=t,e.plot.bar.coloredOHLC.upBar.strokeColor=t,e.plot.bar.coloredHLC.upBar.strokeColor=t,e.plot.bar.coloredHL.upBar.strokeColor=t,e.plot.bar.candle.upCandle.fill.fillColor=t,e.plot.bar.hollowCandle.upCandle.fill.fillColor=t,e.plot.bar.hollowCandle.upHollowCandle.border.strokeColor=t,e.plot.bar.hollowCandle.upHollowCandle.wick.strokeColor=t,e.plot.bar.heikinAshi.upCandle.fill.fillColor=t,e.plot.bar.renko.upCandle.fill.fillColor=t,e.plot.bar.lineBreak.upCandle.fill.fillColor=t,e.plot.bar.pointAndFigure.upCandle.border.strokeColor=t,e.plot.bar.kagi.upCandle.border.strokeColor=t,e.plot.bar.candleVolume.upCandle.border.strokeColor=t,e.plot.bar.candleVolume.upCandle.fill.fillColor=t,e.plot.bar.equiVolume.upCandle.border.strokeColor=t,e.plot.bar.equiVolume.upCandle.fill.fillColor=t,e.plot.bar.equiVolumeShadow.upCandle.border.strokeColor=t,e.plot.bar.equiVolumeShadow.upCandle.fill.fillColor=t,this._fieldDownBarColor.spectrum("get").toRgbString()),t=(e.plot.bar.candle.downCandle.fill.fillColor=t,e.plot.bar.coloredOHLC.downBar.strokeColor=t,e.plot.bar.coloredHLC.downBar.strokeColor=t,e.plot.bar.coloredHL.downBar.strokeColor=t,e.plot.bar.candle.downCandle.fill.fillColor=t,e.plot.bar.hollowCandle.downCandle.fill.fillColor=t,e.plot.bar.hollowCandle.downHollowCandle.border.strokeColor=t,e.plot.bar.hollowCandle.downHollowCandle.wick.strokeColor=t,e.plot.bar.heikinAshi.downCandle.fill.fillColor=t,e.plot.bar.renko.downCandle.fill.fillColor=t,e.plot.bar.lineBreak.downCandle.fill.fillColor=t,e.plot.bar.pointAndFigure.downCandle.border.strokeColor=t,e.plot.bar.kagi.downCandle.border.strokeColor=t,e.plot.bar.candleVolume.downCandle.border.strokeColor=t,e.plot.bar.candleVolume.downCandle.fill.fillColor=t,e.plot.bar.equiVolume.downCandle.border.strokeColor=t,e.plot.bar.equiVolume.downCandle.fill.fillColor=t,e.plot.bar.equiVolumeShadow.downCandle.border.strokeColor=t,e.plot.bar.equiVolumeShadow.downCandle.fill.fillColor=t,e.plot.bar.candle.upCandle.border.strokeColor=this._fieldUpBarBorderColor.spectrum("get").toRgbString(),e.plot.bar.candle.upCandle.border.strokeEnabled=this._chkUpBarBorderEnabled.isChecked(),e.plot.bar.equiVolume.upCandle.border.strokeColor=this._fieldUpBarBorderColor.spectrum("get").toRgbString(),e.plot.bar.equiVolume.upCandle.border.strokeEnabled=this._chkUpBarBorderEnabled.isChecked(),e.plot.bar.candle.downCandle.border.strokeColor=this._fieldDownBarBorderColor.spectrum("get").toRgbString(),e.plot.bar.candle.downCandle.border.strokeEnabled=this._chkDownBarBorderEnabled.isChecked(),e.plot.bar.equiVolume.downCandle.border.strokeColor=this._fieldDownBarBorderColor.spectrum("get").toRgbString(),e.plot.bar.equiVolume.downCandle.border.strokeEnabled=this._chkDownBarBorderEnabled.isChecked(),e.plot.bar.candleVolume.upCandle.border.strokeColor=this._fieldUpBarBorderColor.spectrum("get").toRgbString(),e.plot.bar.candleVolume.upCandle.border.strokeEnabled=this._chkUpBarBorderEnabled.isChecked(),e.plot.bar.candleVolume.downCandle.border.strokeColor=this._fieldDownBarBorderColor.spectrum("get").toRgbString(),e.plot.bar.candleVolume.downCandle.border.strokeEnabled=this._chkDownBarBorderEnabled.isChecked(),this._fieldWickColor.spectrum("get").toRgbString()),t=(e.plot.bar.candle.upCandle.wick.strokeColor=t,e.plot.bar.candle.downCandle.wick.strokeColor=t,e.plot.bar.hollowCandle.upCandle.wick.strokeColor=t,e.plot.bar.hollowCandle.downCandle.wick.strokeColor=t,e.plot.bar.heikinAshi.upCandle.wick.strokeColor=t,e.plot.bar.heikinAshi.downCandle.wick.strokeColor=t,e.plot.bar.candleVolume.downCandle.wick.strokeColor=t,e.plot.bar.candleVolume.upCandle.wick.strokeColor=t,this._fieldTextFont.selectpicker("val")),t=(t&&(e.chartPanel.title.fontFamily=t,e.valueScale.text.fontFamily=t,e.valueScale.valueMarker.text.fontFamily=t,e.dateScale.text.fontFamily=t,e.dateScale.dateMarker.text.fontFamily=t,e.orderBar.buy.market.pendingSubmit.kind.text.fontFamily=t,e.orderBar.buy.market.pendingCancel.kind.text.fontFamily=t,e.orderBar.buy.market.pendingReplace.kind.text.fontFamily=t,e.orderBar.buy.market.submitted.kind.text.fontFamily=t,e.orderBar.buy.market.accepted.kind.text.fontFamily=t,e.orderBar.buy.market.pendingSubmit.quantity.text.fontFamily=t,e.orderBar.buy.market.pendingCancel.quantity.text.fontFamily=t,e.orderBar.buy.market.pendingReplace.quantity.text.fontFamily=t,e.orderBar.buy.market.submitted.quantity.text.fontFamily=t,e.orderBar.buy.market.accepted.quantity.text.fontFamily=t,e.orderBar.buy.market.pendingSubmit.price.text.fontFamily=t,e.orderBar.buy.market.pendingCancel.price.text.fontFamily=t,e.orderBar.buy.market.pendingReplace.price.text.fontFamily=t,e.orderBar.buy.market.submitted.price.text.fontFamily=t,e.orderBar.buy.market.accepted.price.text.fontFamily=t,e.orderBar.buy.stop.pendingSubmit.kind.text.fontFamily=t,e.orderBar.buy.stop.pendingCancel.kind.text.fontFamily=t,e.orderBar.buy.stop.pendingReplace.kind.text.fontFamily=t,e.orderBar.buy.stop.submitted.kind.text.fontFamily=t,e.orderBar.buy.stop.accepted.kind.text.fontFamily=t,e.orderBar.buy.stop.pendingSubmit.quantity.text.fontFamily=t,e.orderBar.buy.stop.pendingCancel.quantity.text.fontFamily=t,e.orderBar.buy.stop.pendingReplace.quantity.text.fontFamily=t,e.orderBar.buy.stop.submitted.quantity.text.fontFamily=t,e.orderBar.buy.stop.accepted.quantity.text.fontFamily=t,e.orderBar.buy.stop.pendingSubmit.price.text.fontFamily=t,e.orderBar.buy.stop.pendingCancel.price.text.fontFamily=t,e.orderBar.buy.stop.pendingReplace.price.text.fontFamily=t,e.orderBar.buy.stop.submitted.price.text.fontFamily=t,e.orderBar.buy.stop.accepted.price.text.fontFamily=t,e.orderBar.buy.limit.pendingSubmit.kind.text.fontFamily=t,e.orderBar.buy.limit.pendingCancel.kind.text.fontFamily=t,e.orderBar.buy.limit.pendingReplace.kind.text.fontFamily=t,e.orderBar.buy.limit.submitted.kind.text.fontFamily=t,e.orderBar.buy.limit.accepted.kind.text.fontFamily=t,e.orderBar.buy.limit.pendingSubmit.quantity.text.fontFamily=t,e.orderBar.buy.limit.pendingCancel.quantity.text.fontFamily=t,e.orderBar.buy.limit.pendingReplace.quantity.text.fontFamily=t,e.orderBar.buy.limit.submitted.quantity.text.fontFamily=t,e.orderBar.buy.limit.accepted.quantity.text.fontFamily=t,e.orderBar.buy.limit.pendingSubmit.price.text.fontFamily=t,e.orderBar.buy.limit.pendingCancel.price.text.fontFamily=t,e.orderBar.buy.limit.pendingReplace.price.text.fontFamily=t,e.orderBar.buy.limit.submitted.price.text.fontFamily=t,e.orderBar.buy.limit.accepted.price.text.fontFamily=t,e.orderBar.buy.stopLimit.pendingSubmit.kind.text.fontFamily=t,e.orderBar.buy.stopLimit.pendingCancel.kind.text.fontFamily=t,e.orderBar.buy.stopLimit.pendingReplace.kind.text.fontFamily=t,e.orderBar.buy.stopLimit.submitted.kind.text.fontFamily=t,e.orderBar.buy.stopLimit.accepted.kind.text.fontFamily=t,e.orderBar.buy.stopLimit.pendingSubmit.quantity.text.fontFamily=t,e.orderBar.buy.stopLimit.pendingCancel.quantity.text.fontFamily=t,e.orderBar.buy.stopLimit.pendingReplace.quantity.text.fontFamily=t,e.orderBar.buy.stopLimit.submitted.quantity.text.fontFamily=t,e.orderBar.buy.stopLimit.accepted.quantity.text.fontFamily=t,e.orderBar.buy.stopLimit.pendingSubmit.price.text.fontFamily=t,e.orderBar.buy.stopLimit.pendingCancel.price.text.fontFamily=t,e.orderBar.buy.stopLimit.pendingReplace.price.text.fontFamily=t,e.orderBar.buy.stopLimit.submitted.price.text.fontFamily=t,e.orderBar.buy.stopLimit.accepted.price.text.fontFamily=t,e.orderBar.sell.market.pendingSubmit.kind.text.fontFamily=t,e.orderBar.sell.market.pendingCancel.kind.text.fontFamily=t,e.orderBar.sell.market.pendingReplace.kind.text.fontFamily=t,e.orderBar.sell.market.submitted.kind.text.fontFamily=t,e.orderBar.sell.market.accepted.kind.text.fontFamily=t,e.orderBar.sell.market.pendingSubmit.quantity.text.fontFamily=t,e.orderBar.sell.market.pendingCancel.quantity.text.fontFamily=t,e.orderBar.sell.market.pendingReplace.quantity.text.fontFamily=t,e.orderBar.sell.market.submitted.quantity.text.fontFamily=t,e.orderBar.sell.market.accepted.quantity.text.fontFamily=t,e.orderBar.sell.market.pendingSubmit.price.text.fontFamily=t,e.orderBar.sell.market.pendingCancel.price.text.fontFamily=t,e.orderBar.sell.market.pendingReplace.price.text.fontFamily=t,e.orderBar.sell.market.submitted.price.text.fontFamily=t,e.orderBar.sell.market.accepted.price.text.fontFamily=t,e.orderBar.sell.stop.pendingSubmit.kind.text.fontFamily=t,e.orderBar.sell.stop.pendingCancel.kind.text.fontFamily=t,e.orderBar.sell.stop.pendingReplace.kind.text.fontFamily=t,e.orderBar.sell.stop.submitted.kind.text.fontFamily=t,e.orderBar.sell.stop.accepted.kind.text.fontFamily=t,e.orderBar.sell.stop.pendingSubmit.quantity.text.fontFamily=t,e.orderBar.sell.stop.pendingCancel.quantity.text.fontFamily=t,e.orderBar.sell.stop.pendingReplace.quantity.text.fontFamily=t,e.orderBar.sell.stop.submitted.quantity.text.fontFamily=t,e.orderBar.sell.stop.accepted.quantity.text.fontFamily=t,e.orderBar.sell.stop.pendingSubmit.price.text.fontFamily=t,e.orderBar.sell.stop.pendingCancel.price.text.fontFamily=t,e.orderBar.sell.stop.pendingReplace.price.text.fontFamily=t,e.orderBar.sell.stop.submitted.price.text.fontFamily=t,e.orderBar.sell.stop.accepted.price.text.fontFamily=t,e.orderBar.sell.limit.pendingSubmit.kind.text.fontFamily=t,e.orderBar.sell.limit.pendingCancel.kind.text.fontFamily=t,e.orderBar.sell.limit.pendingReplace.kind.text.fontFamily=t,e.orderBar.sell.limit.submitted.kind.text.fontFamily=t,e.orderBar.sell.limit.accepted.kind.text.fontFamily=t,e.orderBar.sell.limit.pendingSubmit.quantity.text.fontFamily=t,e.orderBar.sell.limit.pendingCancel.quantity.text.fontFamily=t,e.orderBar.sell.limit.pendingReplace.quantity.text.fontFamily=t,e.orderBar.sell.limit.submitted.quantity.text.fontFamily=t,e.orderBar.sell.limit.accepted.quantity.text.fontFamily=t,e.orderBar.sell.limit.pendingSubmit.price.text.fontFamily=t,e.orderBar.sell.limit.pendingCancel.price.text.fontFamily=t,e.orderBar.sell.limit.pendingReplace.price.text.fontFamily=t,e.orderBar.sell.limit.submitted.price.text.fontFamily=t,e.orderBar.sell.limit.accepted.price.text.fontFamily=t,e.orderBar.sell.stopLimit.pendingSubmit.kind.text.fontFamily=t,e.orderBar.sell.stopLimit.pendingCancel.kind.text.fontFamily=t,e.orderBar.sell.stopLimit.pendingReplace.kind.text.fontFamily=t,e.orderBar.sell.stopLimit.submitted.kind.text.fontFamily=t,e.orderBar.sell.stopLimit.accepted.kind.text.fontFamily=t,e.orderBar.sell.stopLimit.pendingSubmit.quantity.text.fontFamily=t,e.orderBar.sell.stopLimit.pendingCancel.quantity.text.fontFamily=t,e.orderBar.sell.stopLimit.pendingReplace.quantity.text.fontFamily=t,e.orderBar.sell.stopLimit.submitted.quantity.text.fontFamily=t,e.orderBar.sell.stopLimit.accepted.quantity.text.fontFamily=t,e.orderBar.sell.stopLimit.pendingSubmit.price.text.fontFamily=t,e.orderBar.sell.stopLimit.pendingCancel.price.text.fontFamily=t,e.orderBar.sell.stopLimit.pendingReplace.price.text.fontFamily=t,e.orderBar.sell.stopLimit.submitted.price.text.fontFamily=t,e.orderBar.sell.stopLimit.accepted.price.text.fontFamily=t,e.positionBar.short.kind.text.fontFamily=t,e.positionBar.short.kind.text.fontFamily=t,e.positionBar.short.kind.text.fontFamily=t,e.positionBar.short.kind.text.fontFamily=t,e.positionBar.short.kind.text.fontFamily=t,e.positionBar.short.quantity.text.fontFamily=t,e.positionBar.short.quantity.text.fontFamily=t,e.positionBar.short.quantity.text.fontFamily=t,e.positionBar.short.quantity.text.fontFamily=t,e.positionBar.short.quantity.text.fontFamily=t,e.positionBar.short.price.text.fontFamily=t,e.positionBar.short.price.text.fontFamily=t,e.positionBar.short.price.text.fontFamily=t,e.positionBar.short.price.text.fontFamily=t,e.positionBar.short.price.text.fontFamily=t,e.positionBar.long.kind.text.fontFamily=t,e.positionBar.long.kind.text.fontFamily=t,e.positionBar.long.kind.text.fontFamily=t,e.positionBar.long.kind.text.fontFamily=t,e.positionBar.long.kind.text.fontFamily=t,e.positionBar.long.quantity.text.fontFamily=t,e.positionBar.long.quantity.text.fontFamily=t,e.positionBar.long.quantity.text.fontFamily=t,e.positionBar.long.quantity.text.fontFamily=t,e.positionBar.long.quantity.text.fontFamily=t,e.positionBar.long.price.text.fontFamily=t,e.positionBar.long.price.text.fontFamily=t,e.positionBar.long.price.text.fontFamily=t,e.positionBar.long.price.text.fontFamily=t,e.positionBar.long.price.text.fontFamily=t),parseInt(this._fieldTextSize.selectpicker("val"),10)),t=(e.chartPanel.title.fontSize=t,e.valueScale.text.fontSize=t,e.valueScale.valueMarker.text.fontSize=t,e.dateScale.text.fontSize=t,e.dateScale.dateMarker.text.fontSize=t,e.orderBar.buy.market.pendingSubmit.kind.text.fontSize=t,e.orderBar.buy.market.pendingCancel.kind.text.fontSize=t,e.orderBar.buy.market.pendingReplace.kind.text.fontSize=t,e.orderBar.buy.market.submitted.kind.text.fontSize=t,e.orderBar.buy.market.accepted.kind.text.fontSize=t,e.orderBar.buy.market.pendingSubmit.quantity.text.fontSize=t,e.orderBar.buy.market.pendingCancel.quantity.text.fontSize=t,e.orderBar.buy.market.pendingReplace.quantity.text.fontSize=t,e.orderBar.buy.market.submitted.quantity.text.fontSize=t,e.orderBar.buy.market.accepted.quantity.text.fontSize=t,e.orderBar.buy.market.pendingSubmit.price.text.fontSize=t,e.orderBar.buy.market.pendingCancel.price.text.fontSize=t,e.orderBar.buy.market.pendingReplace.price.text.fontSize=t,e.orderBar.buy.market.submitted.price.text.fontSize=t,e.orderBar.buy.market.accepted.price.text.fontSize=t,e.orderBar.buy.stop.pendingSubmit.kind.text.fontSize=t,e.orderBar.buy.stop.pendingCancel.kind.text.fontSize=t,e.orderBar.buy.stop.pendingReplace.kind.text.fontSize=t,e.orderBar.buy.stop.submitted.kind.text.fontSize=t,e.orderBar.buy.stop.accepted.kind.text.fontSize=t,e.orderBar.buy.stop.pendingSubmit.quantity.text.fontSize=t,e.orderBar.buy.stop.pendingCancel.quantity.text.fontSize=t,e.orderBar.buy.stop.pendingReplace.quantity.text.fontSize=t,e.orderBar.buy.stop.submitted.quantity.text.fontSize=t,e.orderBar.buy.stop.accepted.quantity.text.fontSize=t,e.orderBar.buy.stop.pendingSubmit.price.text.fontSize=t,e.orderBar.buy.stop.pendingCancel.price.text.fontSize=t,e.orderBar.buy.stop.pendingReplace.price.text.fontSize=t,e.orderBar.buy.stop.submitted.price.text.fontSize=t,e.orderBar.buy.stop.accepted.price.text.fontSize=t,e.orderBar.buy.limit.pendingSubmit.kind.text.fontSize=t,e.orderBar.buy.limit.pendingCancel.kind.text.fontSize=t,e.orderBar.buy.limit.pendingReplace.kind.text.fontSize=t,e.orderBar.buy.limit.submitted.kind.text.fontSize=t,e.orderBar.buy.limit.accepted.kind.text.fontSize=t,e.orderBar.buy.limit.pendingSubmit.quantity.text.fontSize=t,e.orderBar.buy.limit.pendingCancel.quantity.text.fontSize=t,e.orderBar.buy.limit.pendingReplace.quantity.text.fontSize=t,e.orderBar.buy.limit.submitted.quantity.text.fontSize=t,e.orderBar.buy.limit.accepted.quantity.text.fontSize=t,e.orderBar.buy.limit.pendingSubmit.price.text.fontSize=t,e.orderBar.buy.limit.pendingCancel.price.text.fontSize=t,e.orderBar.buy.limit.pendingReplace.price.text.fontSize=t,e.orderBar.buy.limit.submitted.price.text.fontSize=t,e.orderBar.buy.limit.accepted.price.text.fontSize=t,e.orderBar.buy.stopLimit.pendingSubmit.kind.text.fontSize=t,e.orderBar.buy.stopLimit.pendingCancel.kind.text.fontSize=t,e.orderBar.buy.stopLimit.pendingReplace.kind.text.fontSize=t,e.orderBar.buy.stopLimit.submitted.kind.text.fontSize=t,e.orderBar.buy.stopLimit.accepted.kind.text.fontSize=t,e.orderBar.buy.stopLimit.pendingSubmit.quantity.text.fontSize=t,e.orderBar.buy.stopLimit.pendingCancel.quantity.text.fontSize=t,e.orderBar.buy.stopLimit.pendingReplace.quantity.text.fontSize=t,e.orderBar.buy.stopLimit.submitted.quantity.text.fontSize=t,e.orderBar.buy.stopLimit.accepted.quantity.text.fontSize=t,e.orderBar.buy.stopLimit.pendingSubmit.price.text.fontSize=t,e.orderBar.buy.stopLimit.pendingCancel.price.text.fontSize=t,e.orderBar.buy.stopLimit.pendingReplace.price.text.fontSize=t,e.orderBar.buy.stopLimit.submitted.price.text.fontSize=t,e.orderBar.buy.stopLimit.accepted.price.text.fontSize=t,e.orderBar.sell.market.pendingSubmit.kind.text.fontSize=t,e.orderBar.sell.market.pendingCancel.kind.text.fontSize=t,e.orderBar.sell.market.pendingReplace.kind.text.fontSize=t,e.orderBar.sell.market.submitted.kind.text.fontSize=t,e.orderBar.sell.market.accepted.kind.text.fontSize=t,e.orderBar.sell.market.pendingSubmit.quantity.text.fontSize=t,e.orderBar.sell.market.pendingCancel.quantity.text.fontSize=t,e.orderBar.sell.market.pendingReplace.quantity.text.fontSize=t,e.orderBar.sell.market.submitted.quantity.text.fontSize=t,e.orderBar.sell.market.accepted.quantity.text.fontSize=t,e.orderBar.sell.market.pendingSubmit.price.text.fontSize=t,e.orderBar.sell.market.pendingCancel.price.text.fontSize=t,e.orderBar.sell.market.pendingReplace.price.text.fontSize=t,e.orderBar.sell.market.submitted.price.text.fontSize=t,e.orderBar.sell.market.accepted.price.text.fontSize=t,e.orderBar.sell.stop.pendingSubmit.kind.text.fontSize=t,e.orderBar.sell.stop.pendingCancel.kind.text.fontSize=t,e.orderBar.sell.stop.pendingReplace.kind.text.fontSize=t,e.orderBar.sell.stop.submitted.kind.text.fontSize=t,e.orderBar.sell.stop.accepted.kind.text.fontSize=t,e.orderBar.sell.stop.pendingSubmit.quantity.text.fontSize=t,e.orderBar.sell.stop.pendingCancel.quantity.text.fontSize=t,e.orderBar.sell.stop.pendingReplace.quantity.text.fontSize=t,e.orderBar.sell.stop.submitted.quantity.text.fontSize=t,e.orderBar.sell.stop.accepted.quantity.text.fontSize=t,e.orderBar.sell.stop.pendingSubmit.price.text.fontSize=t,e.orderBar.sell.stop.pendingCancel.price.text.fontSize=t,e.orderBar.sell.stop.pendingReplace.price.text.fontSize=t,e.orderBar.sell.stop.submitted.price.text.fontSize=t,e.orderBar.sell.stop.accepted.price.text.fontSize=t,e.orderBar.sell.limit.pendingSubmit.kind.text.fontSize=t,e.orderBar.sell.limit.pendingCancel.kind.text.fontSize=t,e.orderBar.sell.limit.pendingReplace.kind.text.fontSize=t,e.orderBar.sell.limit.submitted.kind.text.fontSize=t,e.orderBar.sell.limit.accepted.kind.text.fontSize=t,e.orderBar.sell.limit.pendingSubmit.quantity.text.fontSize=t,e.orderBar.sell.limit.pendingCancel.quantity.text.fontSize=t,e.orderBar.sell.limit.pendingReplace.quantity.text.fontSize=t,e.orderBar.sell.limit.submitted.quantity.text.fontSize=t,e.orderBar.sell.limit.accepted.quantity.text.fontSize=t,e.orderBar.sell.limit.pendingSubmit.price.text.fontSize=t,e.orderBar.sell.limit.pendingCancel.price.text.fontSize=t,e.orderBar.sell.limit.pendingReplace.price.text.fontSize=t,e.orderBar.sell.limit.submitted.price.text.fontSize=t,e.orderBar.sell.limit.accepted.price.text.fontSize=t,e.orderBar.sell.stopLimit.pendingSubmit.kind.text.fontSize=t,e.orderBar.sell.stopLimit.pendingCancel.kind.text.fontSize=t,e.orderBar.sell.stopLimit.pendingReplace.kind.text.fontSize=t,e.orderBar.sell.stopLimit.submitted.kind.text.fontSize=t,e.orderBar.sell.stopLimit.accepted.kind.text.fontSize=t,e.orderBar.sell.stopLimit.pendingSubmit.quantity.text.fontSize=t,e.orderBar.sell.stopLimit.pendingCancel.quantity.text.fontSize=t,e.orderBar.sell.stopLimit.pendingReplace.quantity.text.fontSize=t,e.orderBar.sell.stopLimit.submitted.quantity.text.fontSize=t,e.orderBar.sell.stopLimit.accepted.quantity.text.fontSize=t,e.orderBar.sell.stopLimit.pendingSubmit.price.text.fontSize=t,e.orderBar.sell.stopLimit.pendingCancel.price.text.fontSize=t,e.orderBar.sell.stopLimit.pendingReplace.price.text.fontSize=t,e.orderBar.sell.stopLimit.submitted.price.text.fontSize=t,e.orderBar.sell.stopLimit.accepted.price.text.fontSize=t,e.positionBar.short.kind.text.fontSize=t,e.positionBar.short.kind.text.fontSize=t,e.positionBar.short.kind.text.fontSize=t,e.positionBar.short.kind.text.fontSize=t,e.positionBar.short.kind.text.fontSize=t,e.positionBar.short.quantity.text.fontSize=t,e.positionBar.short.quantity.text.fontSize=t,e.positionBar.short.quantity.text.fontSize=t,e.positionBar.short.quantity.text.fontSize=t,e.positionBar.short.quantity.text.fontSize=t,e.positionBar.short.price.text.fontSize=t,e.positionBar.short.price.text.fontSize=t,e.positionBar.short.price.text.fontSize=t,e.positionBar.short.price.text.fontSize=t,e.positionBar.short.price.text.fontSize=t,e.positionBar.long.kind.text.fontSize=t,e.positionBar.long.kind.text.fontSize=t,e.positionBar.long.kind.text.fontSize=t,e.positionBar.long.kind.text.fontSize=t,e.positionBar.long.kind.text.fontSize=t,e.positionBar.long.quantity.text.fontSize=t,e.positionBar.long.quantity.text.fontSize=t,e.positionBar.long.quantity.text.fontSize=t,e.positionBar.long.quantity.text.fontSize=t,e.positionBar.long.quantity.text.fontSize=t,e.positionBar.long.price.text.fontSize=t,e.positionBar.long.price.text.fontSize=t,e.positionBar.long.price.text.fontSize=t,e.positionBar.long.price.text.fontSize=t,e.positionBar.long.price.text.fontSize=t,this._fieldTextColor.spectrum("get").toHexString()),t=(e.chartPanel.title.fillColor=t,e.valueScale.text.fillColor=t,e.valueScale.valueMarker.text.fillColor=t,e.dateScale.text.fillColor=t,e.dateScale.dateMarker.text.fillColor=t,e.chart.background=[this._fieldGradient1Color.spectrum("get").toRgbString(),this._fieldGradient2Color.spectrum("get").toRgbString()],e.valueScale.fill.fillColor=this._fieldValueScalePanelColor.spectrum("get").toRgbString(),e.dateScale.fill.fillColor=this._fieldDateScalePanelColor.spectrum("get").toRgbString(),this._fieldGridColor.spectrum("get").toHexString());return e.chartPanel.grid.strokeColor=t,e.dateScale.line.strokeColor=t,e},c.prototype._apply=function(e){h.JsUtil.isFunction(this._config.done)&&(null==e&&(e=this._getValues()),this._config.done(e))},c.prototype._highlightNewThemeNameInvalid=function(e){e?(this._fieldNewThemeName.addClass(c.CLASS_INVALID_VALUE),this._btnNewThemeConfirm.addClass(c.CLASS_INVALID_VALUE)):(this._fieldNewThemeName.removeClass(c.CLASS_INVALID_VALUE),this._btnNewThemeConfirm.removeClass(c.CLASS_INVALID_VALUE))},c.prototype._initFields=function(){this._dialogBody=this._dialog.find(".scxThemeDialog-body"),this._dialogTitle=this._dialog.find(e+"headerTitle"),this._btnApply=this._dialog.find(a+"save"),this._fieldLineBarColor=this._dialog.find(r+"lineBarColor"),this._fieldUpBarColor=this._dialog.find(r+"upBarColor"),this._fieldDownBarColor=this._dialog.find(r+"downBarColor"),this._labelUpBarBorderColor=this._dialog.find(n+"upBarBorderColor"),this._fieldUpBarBorderColor=this._dialog.find(r+"upBarBorderColor"),this._fieldUpBarBorderEnabled=this._dialog.find(o+"upBarBorderColor"),this._labelDownBarBorderColor=this._dialog.find(n+"downBarBorderColor"),this._fieldDownBarBorderColor=this._dialog.find(r+"downBarBorderColor"),this._fieldDownBarBorderEnabled=this._dialog.find(o+"downBarBorderColor"),this._fieldWickColor=this._dialog.find(r+"wickColor"),this._fieldTextFont=this._dialog.find(r+"textFont"),this._fieldTextSize=this._dialog.find(r+"textSize"),this._fieldTextColor=this._dialog.find(r+"textColor"),this._fieldGradient1Color=this._dialog.find(r+"gradient1Color"),this._fieldGradient2Color=this._dialog.find(r+"gradient2Color"),this._fieldValueScalePanelColor=this._dialog.find(r+"valueScalePanelColor"),this._fieldDateScalePanelColor=this._dialog.find(r+"dateScalePanelColor"),this._fieldGridColor=this._dialog.find(r+"gridColor"),this._fieldTheme=this._dialog.find(r+"theme"),this._wrapperTheme=this._dialog.find("#scxThemeDialog_newThemeWrapper"),this._btnNewTheme=this._dialog.find(a+"newTheme"),this._btnNewThemeConfirm=this._dialog.find(a+"newThemeConfirm"),this._fieldNewThemeName=this._dialog.find(r+"newThemeName"),this._btnSaveTheme=this._dialog.find(a+"saveTheme")},c.CLASS_INVALID_VALUE="scxInvalidValue",c.CLASS_BTN_PRIMARY="btn-primary",c.CLASS_BTN_DEFAULT="btn-default",c._switcherySettings={color:"rgba(72, 149, 245, 0.2)",secondaryColor:"rgba(16, 17, 20, 1)",jackColor:"rgba(72, 149, 245, 1)",jackSecondaryColor:"rgba(81, 83, 90, 1)",className:"scx_switchery",disabled:!1,disabledOpacity:.5,speed:"0.4s"},c);function c(e){e=t.call(this,e)||this;return e._initFields(),e._init(),e}i.ThemeDialog=l}(h.UI||(h.UI={}))}(StockChartX=StockChartX||{}),this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}()),__awaiter=(!function(r){!function(e){"use strict";var t,i="#scxCompareInstrument_",n=(t=e.Dialog,__extends(o,t),o.prototype.show=function(e){this.initDialog(e)&&(t.prototype.show.call(this,e),this._setValues())},o.prototype._init=function(){var t=this;this._btnAdd.on("click",function(){t._add()}),this._instrumentSearch=this._dialogInput.scx().instrumentSearch({onChange:function(e){t._handleInstrumentChange(e)}}),this._dialog.find(".scxSpectrum").scx().colorPicker({containerClassName:"scxSpectrumDrawingDialog",localStorageKey:"scxThemeDialog_spectrum",showAlpha:!0})},o.prototype._add=function(){var e,t=this._config.chart;this._getValues(),this._setValues(),this._compareInstrument&&(e=this._compareInstrument.symbol,t.instrumentComparisonHandler.compare({symbol:e},null,this._instrumentTheme))},o.prototype._handleInstrumentChange=function(e){this._compareInstrument=e||null},o.prototype._setValues=function(){var t=this,e=this._config.chart;this._instrumentSearch._config.chart=this._config.chart,this._compareInstrument?this._dialogInput.val(this._compareInstrument.symbol):(this._dialogInput.val(e.instrument.symbol),this._compareInstrument=e.instrument),this._lineColorInput.spectrum("set","red"),this._lineStyleInput.selectpicker({container:"body"}),this._lineStyleInput.selectpicker("val",r.LineStyle.SOLID).selectpicker("refresh"),this._lineWidthInput.scxNumericField(this._numericFieldConfig),r.Localization.localizeText(e,"compareInstrument.selectInstrument").then(function(e){t._dialogInput.attr("title",e)}),e.localize(this._dialog)},o.prototype._getValues=function(){this._instrumentTheme.lineColor=this._lineColorInput.spectrum("get").toRgbString(),this._instrumentTheme.lineWidth=this._lineWidthInput.val(),this._instrumentTheme.lineStyle=this._lineStyleInput.val()},o.prototype._initFields=function(){this._dialogInput=this._dialog.find(i+"symbol"),this._lineColorInput=this._dialog.find(i+"lineColor"),this._lineWidthInput=this._dialog.find(i+"lineWidth"),this._lineStyleInput=this._dialog.find(i+"lineStyle"),this._btnAdd=this._dialog.find(i+"btn_add")},o);function o(e){e=t.call(this,e)||this;return e._instrumentTheme={},e._numericFieldConfig={showArrows:!1,maxValue:10,minValue:1,value:1},e._initFields(),e._init(),e}e.CompareInstrumentDialog=n}(r.UI||(r.UI={}))}(StockChartX=StockChartX||{}),!function(p){!function(a){"use strict";var h="active",s="hover",d="scxLeft",_="scxRight",o="data-scxUnits",u={LEFT:0,RIGHT:1},i={interval:1,periodicity:p.Periodicity.DAY},l=(Object.freeze(u),".scxTimeFramePicker");function c(e,t){this._isActive=!1,this._hasCustomPicker=!1,this._last=new p.TimeFrame(p.Periodicity.MINUTE,1),t.timeFrame||(t.timeFrame=t.chart&&t.chart.timeFrame||i),this._rootDomElement=e,this._config=t,this._init()}Object.defineProperty(c.prototype,"chart",{get:function(){return this._config.chart},set:function(e){e||(this._isActive&&this._hideDropDown(),this._unsubscribe()),this._config.chart=e},enumerable:!0,configurable:!0}),c.prototype.set=function(e){this._setValue(e)},c.prototype._init=function(){var t=this;if(this._domObjects=c._getDomObjects(this._rootDomElement),this._btnWrapper=this._rootDomElement.find(".scxToolbarButton-buttonWrapper"),a.HtmlContainer.instance.register("TimeFramePicker",this._domObjects.dropdown.wrapper),this._hasCustomPicker=0<this._domObjects.dropdown.customValueWrapper.length,this._rootDomElement.addClass("activated"),this._rootDomElement.hover(function(){t._btnWrapper.addClass(s)},function(){t._btnWrapper.removeClass(s)}),this._domObjects.dropdown.inputInterval.scxNumericField({showArrows:!1,minValue:1,value:1}).keyup(function(e){13===e.which&&t._getPickerIntervalValue()&&t._hideDropDown()}),!this._domObjects.dropdown.inputPeriodicity.children().length){var e,i,n=this._selectDistinctPredefinedPeriodicities(),o=[];for(e in p.Periodicity)p.Periodicity.hasOwnProperty(e)&&0<=n.indexOf(p.Periodicity[e])&&(i=p.TimeFrame.periodicityToString(p.Periodicity[e]),o.push($('<option value="'+p.Periodicity[e]+'">'+i+"</option>")));this._domObjects.dropdown.inputPeriodicity.empty().append(o)}this._domObjects.dropdown.inputPeriodicity.selectpicker({container:"body"}),this._domObjects.head.dropdownToggler.click(function(e){t._toggleDropDown(),$(e.currentTarget).blur()}),this._domObjects.head.activator.click(function(){t._domObjects.head.dropdownToggler.click()}),$(window).on(["scroll","resize",""].join(l+" "),function(){t._hideDropDown()});var r=$("body");r.on(p.MouseEvent.CLICK+l,function(e){t._isActive&&!$(e.target).parents().hasClass(t._rootDomElement.attr("class"))&&0===$(e.target).parents(".scxTimeFramePickerDropDown").length&&0===$(e.target).parents(".scxTimeFramePicker-CustomValueUnits").length&&t._hideDropDown()}),r.on("touchstart"+l,function(e){t._isActive&&!$(e.target).parents().hasClass(t._rootDomElement.attr("class"))&&0===$(e.target).parents(".scxTimeFramePickerDropDown").length&&0===$(e.target).parents(".scxTimeFramePicker-CustomValueUnits").length&&t._hideDropDown()}),this._domObjects.predefinedItems.click(function(e){t._setPredefinedValue($(e.currentTarget).index())}),this._hasCustomPicker&&(p.Environment.isMobile?(this._hasCustomPicker=!1,this._domObjects.dropdown.customValueWrapper.remove()):(this._domObjects.dropdown.btnPlus.click(function(e){t._domObjects.predefinedItems.removeClass(h),$(e.currentTarget).blur(),t._domObjects.dropdown.inputInterval.scxNumericField("setValue",t._getPickerIntervalValue()+1)}),this._domObjects.dropdown.btnMinus.click(function(e){t._domObjects.predefinedItems.removeClass(h),$(e.currentTarget).blur();e=t._getPickerIntervalValue();1<e&&t._domObjects.dropdown.inputInterval.scxNumericField("setValue",e-1)}))),$(".scxTimeFramePicker-CustomValueUnits").click(function(){t._domObjects.predefinedItems.removeClass(h)}),this._setValue(this._config.timeFrame)},c.prototype._setValue=function(e){this._domObjects.predefinedItems.removeClass(h),this._last=e,this._setCustomPickerValues(),this._setLabels(),this._hideDropDown()},c.prototype._setPredefinedValue=function(e){e=this._domObjects.predefinedItems.eq(e);this._activateItem(e),this._last=c._extractDataFromItem(e),this._setCustomPickerValues(),this._setLabels(),this._hideDropDown(),this._fire()},c._extractDataFromItem=function(e){return new p.TimeFrame(e.attr(o),parseInt(e.attr("data-scxValue"),10))},c.prototype._activateItem=function(e){this._domObjects.predefinedItems.removeClass(h),e.addClass(h)},c.prototype._setLabels=function(){this._domObjects.head.labelInterval.text(this._last.interval);var e=this._last.periodicity;this.chart&&(this._domObjects.head.labelPeriodicity.attr("data-i18n","timeFrame.periodicity."+e),this.chart.localize(this._domObjects.head.labelPeriodicity))},c.prototype._setCustomPickerValues=function(){this._hasCustomPicker&&(this._domObjects.dropdown.inputInterval.scxNumericField("setValue",this._last.interval),this._domObjects.dropdown.inputPeriodicity.selectpicker("val",this._last.periodicity).selectpicker("refresh"))},c.prototype._toggleDropDown=function(){this._isActive?this._hideDropDown():this._showDropDown()},c.prototype._showDropDown=function(){this._isActive=!0;var e=this._rootDomElement.addClass(h),t=this._domObjects.dropdown.wrapper,i=this._domObjects.dropdown.container,n=window.innerWidth,o=window.innerHeight-1,r={top:e.offset().top-$(window).scrollTop(),left:e.offset().left-$(window).scrollLeft()},a=(i.css({width:"auto",height:"auto"}),t.css({top:0,left:0,right:"auto"}).show(),t.outerWidth(!0)),s=t.outerHeight(!0);t.hide();var l=n<r.left+a&&n-r.left<r.left+e.outerWidth(!0)?u.LEFT:u.RIGHT,c={top:r.top+e.outerHeight(!0)-parseInt(e.css("margin-bottom"),10),left:null,right:null};switch(o-s<s&&(s=o-(o-(s=o<s?o/2:s)),a+=20),l){case u.RIGHT:c.left=r.left,c.right="auto",t.removeClass(d).addClass(_),a>n-c.left&&(a=n-c.left-2);break;case u.LEFT:c.left="auto",c.right=n-r.left-e.outerWidth(!0),t.removeClass(_).addClass(d),a>n-c.right&&(a=n-c.right-2,c.left=0)}i.outerWidth(a).outerHeight(s),t.css(c).show()},c.prototype._hideDropDown=function(){this._domObjects.dropdown.wrapper.hide(),this._rootDomElement.removeClass(h),this._btnWrapper.removeClass(s),this._isActive=!1,this._synchronizeWithCustomPicker(),$(".scxTimeFramePicker-CustomValueUnits").removeClass("open")},c.prototype._synchronizeWithCustomPicker=function(){var e,t;this._hasCustomPicker&&(e=this._getPickerIntervalValue(),t=this._domObjects.dropdown.inputPeriodicity.selectpicker("val"),e===this._last.interval&&t===this._last.periodicity||(this._last=new p.TimeFrame(t,e),this._setLabels(),this._fire()))},c.prototype._fire=function(){"function"==typeof this._config.selectionChanged&&this._config.selectionChanged(this._last),this.chart.localize(this._domObjects.dropdown.customValueWrapper)},c.prototype._getPickerIntervalValue=function(){var e=$("<div></div>").text(this._domObjects.dropdown.inputInterval.scxNumericField("getValue")).html();return parseInt(e,10)},c.prototype._selectDistinctPredefinedPeriodicities=function(){var i,n=[];return this._domObjects.predefinedItems.each(function(e,t){i=$(t).attr(o).toLowerCase();try{p.TimeFrame.periodicityToString(i)}catch(e){i=null}null!==i&&n.indexOf(i)<0&&n.push(i)}),n},c._getDomObjects=function(e){return{head:{activator:e.find(".scxToolbarButton-activateBtn"),dropdownToggler:e.find(".scxToolbarButton-toggleDropdownBtn"),labelInterval:e.find(".scxTimeFramePicker-button-value"),labelPeriodicity:e.find(".scxTimeFramePicker-button-units")},dropdown:{wrapper:e.find(".scxTimeFramePickerDropDown"),container:e.find(".scxTimeFramePicker-dropdownContainer"),customValueWrapper:e.find(".scxTimeFramePicker-CustomValueWrapper"),btnPlus:e.find(".scxTimeFramePicker-CustomValuePlus"),btnMinus:e.find(".scxTimeFramePicker-CustomValueMinus"),inputInterval:e.find(".scxTimeFramePicker-CustomValueText"),inputPeriodicity:e.find(".scxTimeFramePicker-CustomValueUnits")},predefinedItems:e.find(".scxToolbarButton-dropdownElement")}},c.prototype._unsubscribe=function(){$("*").off(l)},a.TimeFramePicker=c}(p.UI||(p.UI={}))}(StockChartX=StockChartX||{}),!function(l){!function(s){"use strict";var e=".scxToolbar",o="toggleFullWindow",r="toggleFullScreen";function t(t){var i=this;s.HtmlLoader.loadHtml("Toolbar.html",function(e){i._init(e,t)})}Object.defineProperty(t.prototype,"chart",{get:function(){return this._chart},set:function(e){this._chart!==e&&(this._unsubscribeEvents(),this._chart=e,this._subscribeEvents(),this._updateForNewChart(),this._chart&&this._chart.localize())},enumerable:!0,configurable:!0}),t.prototype._init=function(e,t){var i,n,o,r=this,a=this.chart=t.chart;a.container&&(this._container=$(e).prependTo(t.parent),e=this._container,i=this._controls={},l.Environment.isPhone&&this._container.addClass("scxPhone"),n=(o=this._container.find(".scxToolbar")).parent().parent(),this._toolbarScroll=new s.ToolbarScroll(this,o,n),this._toolbarScroll.resize(),$(window).resize(function(){r._toolbarScroll.resize()}),i.instrument=e.find(".symbolSearch").scx().instrumentSearch({chart:this._chart,onChange:function(e){r._handleInstrumentChange(e)}}),i.timeFrame=e.find(".scxTimeFramePicker").scx().timeFramePicker({selectionChanged:function(e){r._handleTimeFrameChange(e)}}),i.indicators=e.find(".scxToolbarIndicators").scx().toolbarDropDownButton({chart:this.chart,selectionChanged:function(e,t){r._handleIndicatorsClick(e,t)}}),e.find(".scxToolbar-btn-theme").on("click",function(e){$(e.target).removeClass("hover"),r._handleThemeClick()}),i.priceStyle=e.find(".scxToolbarBarStyle").scx().toolbarDropDownButton({chart:this.chart,selectionChanged:function(e,t){r._handlePriceStyleChange(e,t)}}),e.find(".scxToolbar-btn-compareInstrument").on("click",function(e){$(e.target).removeClass("hover"),r._handleCompareInstrumentClick()}),i.crossHair=e.find(".scxToolbarCrossHair").scx().toolbarDropDownButton({chart:this.chart,selectionChanged:function(e,t){r._handleCrossHairChange(e,t)}}),i.drawings=e.find(".scxToolbarDrawings").scx().toolbarDropDownButton({chart:this.chart,selectionChanged:function(e,t){r._handleDrawingClick(e,t)}}),i.zoomIn=e.find(".scxToolbarZoomIn").scx().toolbarDropDownButton({chart:this.chart,selectionChanged:function(e,t){r._handleZoomInClick(e,t)}}),i.hideDrawings=e.find(".scxToolbar-btn-hideDrawings").scx().toolbarDropDownButton({chart:this.chart,selectionChanged:function(e,t){r._handleHideDrawingsClick(t)}}),i.stayInDrawingMode=e.find(".scxToolbar-btn-stayInDrawingMode").scx().toolbarDropDownButton({chart:this.chart,selectionChanged:function(e,t){r._handleDrawingModeClick(t)}}),e.find(".scxToolbarSaveImage").on("click",function(e){$(e.target).removeClass("hover"),r._handleSaveImageClick()}),o=e.find(".scxToolbarViewMode"),!1===t.showViewMode?o.remove():l.Environment.isMobile||l.Environment.isPhone?o.on("click",function(){r._handleViewModeChange("toggleFullWindow",!1)}).removeClass("scxToolbarButtonWithDropdown"):o.scx().toolbarDropDownButton({chart:this.chart,selectionChanged:function(e,t){r._handleViewModeChange(e,t)}}),a&&a.fireValueChanged(l.ChartEvent.TOOLBAR_LOADED,this),this._updateForNewChart())},t.prototype.prependTo=function(e){e&&(this._container.detach(),this._container=this._container.prependTo(e))},t.prototype._subscribeEvents=function(){var t=this,i=this.chart;i&&i.on(l.ChartEvent.INSTRUMENT_CHANGED+e,function(e){t._controls.instrument.set(e.value)}).on(l.ChartEvent.TIME_INTERVAL_CHANGED+e,function(e){t._controls.timeFrame.set(e.value)}).on(l.ChartEvent.PRICE_STYLE_CHANGED+e,function(){var e=t.chart&&t.chart.priceStyle;!e||e instanceof l.HLBarPriceStyle||e instanceof l.HLCBarPriceStyle||e instanceof l.ColoredHLBarPriceStyle||e instanceof l.ColoredHLCBarPriceStyle||t._controls.priceStyle.selectItem(t.chart.priceStyleKind,!1)}).on(l.ChartEvent.CROSS_HAIR_CHANGED+e,function(){t._controls.crossHair.selectItem(t.chart.crossHairType,!1)}).on(l.ChartEvent.ZOOM_IN_FINISHED+e+" "+l.ChartEvent.ZOOM_IN_CANCELLED+e,function(){t._controls.zoomIn.deactivate()}).on([l.ChartEvent.USER_DRAWING_FINISHED,l.ChartEvent.USER_DRAWING_CANCELLED,""].join(e+" "),function(){var e=t._controls;i.stayInDrawingMode||e.drawings.deactivate()}).on(l.ChartEvent.STATE_LOADED+e,function(){t._controls.priceStyle.selectItem(t.chart.priceStyleKind,!1),t._controls.crossHair.selectItem(t.chart.crossHairType,!1)})},t.prototype._unsubscribeEvents=function(){this._chart&&(this._chart.cancelUserDrawing(),this._chart.cancelZoomIn(),this._chart.off(e))},t.prototype._updateForNewChart=function(){var e=this.chart,t=this._controls;if(t){for(var i in t)t.hasOwnProperty(i)&&t[i]instanceof s.ToolbarDropDownButton&&(t[i].chart=e,"hideDrawings"!==i&&"stayInDrawingMode"!==i&&t[i].deactivate());(t.timeFrame.chart=e)&&(t.instrument.set(e.instrument),t.timeFrame.chart=e,t.timeFrame.set(e.timeFrame),t.priceStyle.selectItem(e.priceStyleKind,!1),t.crossHair.selectItem(e.crossHairType,!1),e.showDrawings?t.hideDrawings.deactivate():t.hideDrawings.activate(),e.stayInDrawingMode?t.stayInDrawingMode.activate():t.stayInDrawingMode.deactivate(),e.windowMode!==l.WindowMode.FULL_WINDOW&&e.windowMode!==l.WindowMode.FULL_SCREEN||e.windowModeHandler.adjustFullWindowSize())}},t.prototype._handleInstrumentChange=function(e){var t,i,n;!e||(t=this.chart)&&(i=t.instrument&&t.instrument.symbol.toUpperCase(),(n=e.symbol.toUpperCase())!==t.instrument.symbol&&(t.fireValueChanged(l.ChartEvent.SYMBOL_ENTERED,e),n!==i&&(t.instrument=e,t.sendBarsRequest())))},t.prototype._handleTimeFrameChange=function(e){var t=this.chart;t&&(t.timeFrame=e,t.sendBarsRequest(),t.fireValueChanged(l.ChartEvent.TIME_FRAME_CHANGED,e))},t.prototype._indicatorsDialog=function(){var n=this;s.ViewLoader.indicatorsDialog(function(e){e.show({chart:n.chart,done:function(e){var t=n.chart,i=s.IndicatorsDialog.showSettingsBeforeAdding;t&&(e=l.Indicator.deserialize({className:e,chart:t}),t.addIndicators(e),i&&e.showSettingsDialog(),t.update())}})})},t.prototype._handleThemeClick=function(){var i=this;s.ViewLoader.themeDialog(function(e){e.show({chart:i.chart,theme:i.chart.theme,done:function(e){var t=i.chart;t&&(l.Theme[e.name]=t.theme=e,t.setNeedsUpdate())}})})},t.prototype._handleCompareInstrumentClick=function(){var t=this;s.ViewLoader.compareInstrumentDialog(function(e){e.show({chart:t.chart,done:function(){var e=t.chart;e&&e.setNeedsUpdate()}})})},t.prototype._handlePriceStyleChange=function(e,t){var i=this.chart;i&&t&&e&&(i.priceStyleKind=e,i.setNeedsUpdate())},t.prototype._handleCrossHairChange=function(e,t){var i=this.chart;i&&t&&e&&(i.crossHairType=e)},t.prototype._handleDrawingClick=function(e,t){var i=this.chart;if(i)return t&&"deleteAllDrawings"===e?(i.removeDrawings(),void i.setNeedsUpdate(!0)):void(t?e&&(t=l.Drawing.deserialize({className:e}),i.startUserDrawing(t)):i.cancelUserDrawing())},t.prototype._handleZoomInClick=function(e,t){var i=this.chart;i&&(t?e&&t&&i.startZoomIn(e):i.cancelZoomIn())},t.prototype._handleHideDrawingsClick=function(e){var t=this.chart;t&&(t.showDrawings=!e,t.setNeedsUpdate())},t.prototype._handleDrawingModeClick=function(e){var t=this.chart;t&&!(t.stayInDrawingMode=e)&&t.cancelUserDrawing()},t.prototype._handleIndicatorsClick=function(e,t){var i=this.chart;i&&("indicators"===e&&this._indicatorsDialog(),t&&"deleteAllIndicators"===e&&(i.removeIndicators(),i.setNeedsUpdate(!0)))},t.prototype._handleSaveImageClick=function(){var e=this.chart;e&&e.saveImage()},t.prototype._handleViewModeChange=function(e,t){var i=this.chart;if(i){var n=i.windowMode;switch(e){case o:switch(n){case l.WindowMode.NORMAL:case l.WindowMode.FULL_SCREEN:i.setWindowMode(l.WindowMode.FULL_WINDOW),this._toolbarScroll.resize();break;case l.WindowMode.FULL_WINDOW:i.setWindowMode(l.WindowMode.NORMAL),this._toolbarScroll.resize();break;default:throw new Error("Unknown window mode.")}break;case r:if(t)switch(n){case l.WindowMode.NORMAL:case l.WindowMode.FULL_WINDOW:i.setWindowMode(l.WindowMode.FULL_SCREEN);break;case l.WindowMode.FULL_SCREEN:i.setWindowMode(i.windowModeHandler.prevMode);break;default:throw new Error("Unknown window mode.")}}}},s.Toolbar=t}(l.UI||(l.UI={}))}(StockChartX=StockChartX||{}),!function(e){!function(e){"use strict";var n="scxToolbarButton-anotherButtonActivated",_="scxToolbarButton-anotherDropdownActivated",u=".scxToolbar-multiDropdown",o="data-scxValue",p="active",i="activated",r="hover",f="scxLeft",m="scxRight",g={LEFT:0,RIGHT:1};function t(e,t){this._canToggle=!0,this._hasChildren=!1,this._isActivated=!1,this._isActive=!1,this._config=t,this._rootElement=e,this._body=$("body"),this._init()}Object.freeze(g),Object.defineProperty(t.prototype,"chart",{get:function(){return this._config.chart},set:function(e){this._config.chart=e},enumerable:!0,configurable:!0}),t.prototype.selectItem=function(e,t){this._setValue(e,t)},t.prototype.deactivate=function(){this._deactivateButton()},t.prototype.activate=function(){this._activateButton()},t.prototype._init=function(){var i=this;this._btnWrapper=this._rootElement.find(".scxToolbarButton-buttonWrapper"),this._btnActivate=this._rootElement.find(".scxToolbarButton-activateBtn"),this._btn_toggleDropDown=this._rootElement.find(".scxToolbarButton-toggleDropdownBtn"),this._itemsWrapper=this._rootElement.find(".scxToolbarButton-dropdownWrapper"),this._itemsContainer=this._rootElement.find(".scxToolbarButton-dropdownElementsContainer"),this._items=this._rootElement.find(".scxToolbarButton-dropdownElement"),this._multiDropDownElement=this._rootElement.find(".scxToolbarButton-multiDropDownElement"),e.HtmlContainer.instance.register("scxToolbarButton-dropdownWrapper",this._itemsWrapper,!1),this._canToggle=this._rootElement.hasClass("scxToolbarCanToggle"),this._canFireFromHead=this._rootElement.hasClass("scxToolbarCanFireFromHead"),this._rootElement.hasClass("scxToolbarButtonWithDropdown")&&0<this._btn_toggleDropDown.length&&0<this._items.length&&(this._hasChildren=!0),this._btnWrapper.on("click",function(e){var t=$(e.target);t.is(i._btnActivate)?(i._btnWrapper.removeClass(r),i._canToggle?i._toggleButton(e):i._canFireFromHead?i._fireFromHead():!i._hasChildren||i._canToggle||i._canFireFromHead||i._toggleDropDown()):(t.is(i._btn_toggleDropDown)||i._hasChildren)&&i._toggleDropDown()}),this._btnWrapper.hover(function(){i._btnWrapper.addClass(r)},function(){i._btnWrapper.removeClass(r)}),this._multiDropDownElement.hover(function(e){i._showMultiDropDown($(e.target).find(u))}),this._btnActivate.focus(function(e){$(e.currentTarget).blur()}),this._body.on(n,function(e,t){0===$(e.target).parent().find(u).length&&(i._triggerActiveButton(t.button,t.chart),i._hideDropDown())}),this._hasChildren&&(this._itemsWrapper.hide().addClass(this._rootElement.attr("data-type")).appendTo(e.HtmlContainer.instance.componentsContainer),this._body.bind([_,"scxContextMenuOpen"].join(" "),function(){i._hideDropDown(),i._deactivateButton()}),this._canFireFromHead||this._btnActivate.attr(o,this._items.first().attr(o)),this._btn_toggleDropDown.focus(function(e){$(e.currentTarget).blur()}),this._body.on("click",function(e){i._isActive&&!$(e.target).parents().hasClass(i._rootElement.attr("class"))&&0===$(e.target).parent().find(u).length&&i._hideDropDown()}),this._body.on("touchstart",function(e){i._isActive&&!$(e.target).parents().hasClass(i._rootElement.attr("class"))&&i._hideDropDown()}),this._items.on("click touchstart",function(e){e=$(e.currentTarget).attr(o);e&&i._setValue(e)}),this._config.selectedItem&&this._setValue(this._config.selectedItem),$(window).on("scroll resize",function(){i._hideDropDown()}))},t.prototype._setValue=function(e,t){this._deactivateButton(t),this._items.removeClass(p),this._canFireFromHead||("deleteAllDrawings"!==e&&this._items.parent().find("["+o+'="'+e+'"]').addClass(p),this._btnActivate.attr(o,e)),this._activateButton(t,e),0===$(this._items.parent().find(u)).length&&this._hideDropDown()},t.prototype._triggerActiveButton=function(e,t){this.chart!==t||-1!==$(e).index(".scxToolbar-btn-stayInDrawingMode")||this._rootElement.hasClass("scxToolbarButtonManuallySwitchable")||!$(e).is(this._btnActivate)&&this._canToggle&&this._deactivateButton()},t.prototype._activateButton=function(e,t){this._isActivated=!0,this._canToggle&&("deleteAllDrawings"!==t&&this._rootElement.addClass(i),0===this._itemsWrapper.find(u).length&&this._itemsWrapper.addClass(i),this._body.trigger(n,{button:this._btnActivate,chart:this.chart})),this._canFireFromHead?this._config.selectionChanged(t,this._isActivated):!1!==e&&this._config.selectionChanged&&this._config.selectionChanged(this._btnActivate.attr(o),this._isActivated)},t.prototype._deactivateButton=function(e){this._isActivated&&(this._isActivated=!1,this._canToggle&&(this._rootElement.removeClass(i),this._itemsWrapper.removeClass(i)),!1!==e&&this._config.selectionChanged&&!this._canFireFromHead&&this._config.selectionChanged(this._btnActivate.attr(o),this._isActivated))},t.prototype._toggleButton=function(e){this._isActivated?this._deactivateButton():this._activateButton()},t.prototype._fireFromHead=function(){var e;this._isActive?this._hideDropDown():(e=this._btnActivate.attr(o),this._config.selectionChanged(e))},t.prototype._showDropDown=function(){this._body.trigger(_),this._isActive=!0;var e=this._rootElement.addClass(p),t=this._itemsWrapper,i=this._itemsContainer,n=t.find(u),o=window.innerWidth,r=window.innerHeight-1,a={top:e.offset().top-$(window).scrollTop(),left:e.offset().left-$(window).scrollLeft()},s=(i.css({width:"auto",height:"auto"}),t.css({top:0,left:0}).removeClass("visible").show(),t.outerWidth(!0)+15),l=t.outerHeight(!0),c=(t.hide().addClass("visible"),n.outerWidth()?n.outerWidth():0),c=o<a.left+s+c&&o-a.left-c<a.left+e.outerWidth(!0)?g.LEFT:g.RIGHT,h={top:a.top+e.outerHeight(!0)-parseInt(e.css("margin-bottom"),10),left:null};switch(l>r-h.top&&(l=r-h.top),c){case g.RIGHT:h.left=a.left,t.removeClass(f).addClass(m),t.removeClass(f).addClass(m),n.css("right","inherit"),n.css("left",s),s>o-h.left&&(s=o-h.left);break;case g.LEFT:var d=a.left+e.outerWidth(!0);h.left=d-s-2,t.removeClass(m).addClass(f),n.css("left","inherit"),n.css("right",s),d<s&&(s=d-2,h.left=0)}i.outerWidth(s).outerHeight(l),t.css(h).show()},t.prototype._showMultiDropDown=function(e){var t,i,n;0!==e.length&&(t=e.outerHeight(),i=e.offset().top,(n=window.innerHeight-1)<t+i?e.outerHeight(n-i):e.outerHeight("auto"))},t.prototype._hideDropDown=function(){this._itemsWrapper.hide(),this._rootElement.removeClass(p),this._btnWrapper.removeClass(r),this._isActive=!1},t.prototype._toggleDropDown=function(){this._isActive?this._hideDropDown():this._showDropDown()},e.ToolbarDropDownButton=t}(e.UI||(e.UI={}))}(StockChartX=StockChartX||{}),!function(i){!function(r){"use strict";var t={DRAWING_DIALOG:"DrawingSettingsDialog.html",FIBONACCI_DRAWING_DIALOG:"FibonacciDrawingSettingsDialog.html",ICHIMOKU_INDICATOR_DIALOG:"IchimokuIndicatorSettingsDialog.html",INDICATOR_INFO_DIALOG:"IndicatorInfoDialog.html",INDICATORS_DIALOG:"IndicatorsDialog.html",INDICATOR_DIALOG:"IndicatorSettingsDialog.html",PRICE_STYLE_DIALOG:"PriceStyleSettingsDialog.html",DARVAS_BOX_DIALOG:"DarvasBoxSettingsDialog.html",THEME_DIALOG:"ThemeDialog.html",TOOLTIP_VIEW:"TooltipView.html",ORDER_DIALOG:"OrderDialog.html",CCOMPARE_INSTRUMENT_DIALOG:"CompareInstrumentDialog.html"};function e(){}Object.freeze(t),e._initView=function(t,i,n){var o=this;r.HtmlLoader.loadHtml(t,function(e){e=r.HtmlContainer.instance.register(t,e),e=new i(e);o._views.add(t,e),o._invokeOnLoad(n,e)})},e._loadView=function(e,t,i){var n=this._views.get(e);n?this._invokeOnLoad(i,n):this._initView(e,t,i)},e._invokeOnLoad=function(e,t){i.JsUtil.isFunction(e)&&e(t)},e.drawingSettingsDialog=function(e){this._loadView(t.DRAWING_DIALOG,r.DrawingSettingsDialog,e)},e.fibonacciDrawingSettingsDialog=function(e){this._loadView(t.FIBONACCI_DRAWING_DIALOG,r.FibonacciDrawingSettingsDialog,e)},e.indicatorInfoDialog=function(e){this._loadView(t.INDICATOR_INFO_DIALOG,r.IndicatorInfoDialog,e)},e.indicatorsDialog=function(e){this._loadView(t.INDICATORS_DIALOG,r.IndicatorsDialog,e)},e.indicatorSettingsDialog=function(e){this._loadView(t.INDICATOR_DIALOG,r.IndicatorSettingsDialog,e)},e.priceStyleSettingsDialog=function(e){this._loadView(t.PRICE_STYLE_DIALOG,r.PriceStyleSettingsDialog,e)},e.themeDialog=function(e){this._loadView(t.THEME_DIALOG,r.ThemeDialog,e)},e.compareInstrumentDialog=function(e){this._loadView(t.CCOMPARE_INSTRUMENT_DIALOG,r.CompareInstrumentDialog,e)},e.tooltipView=function(e){this._loadView(t.TOOLTIP_VIEW,r.TooltipView,e)},e.orderDialog=function(e){this._loadView(t.ORDER_DIALOG,r.OrderDialog,e)},e._views=new i.Dictionary,r.ViewLoader=e}(i.UI||(i.UI={}))}(StockChartX=StockChartX||{}),!function(e){!function(e){"use strict";var i=jQuery,n="scxWaitingBarContainer",o="scxWaitingBarText",r="scxDotsContainer",a="scxWaitingBarDot";function t(e){this._isShown=!1,this._parentContainer=e}t.prototype.show=function(e){this._isShown||(this._isShown=!0,this._config=i.extend({dotsCount:7},e),this._createDom(),this._container.show())},t.prototype.hide=function(e){(e||this._isShown)&&(this._isShown=!1,this.destroy())},t.prototype._createDom=function(){this._container=i('<div class="'+n+'"></div>').appendTo(this._parentContainer),i('<span class="'+o+'">Loading</span>').appendTo(this._container);for(var e=i('<div class="'+r+'"></div>').appendTo(this._container),t=0;t<this._config.dotsCount;t++)e.append(i('<div class="'+a+'"></div>'))},t.prototype.destroy=function(){this._container&&(this._container.remove(),this._container=null)},e.WaitingBar=t}(e.UI||(e.UI={}))}(StockChartX=StockChartX||{}),this&&this.__awaiter||function(r,a,s,l){return new(s=s||Promise)(function(e,t){function i(e){try{o(l.next(e))}catch(e){t(e)}}function n(e){try{o(l.throw(e))}catch(e){t(e)}}function o(t){t.done?e(t.value):new s(function(e){e(t.value)}).then(i,n)}o((l=l.apply(r,a||[])).next())})}),__generator=this&&this.__generator||function(n,o){var r,a,s,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(i){return function(e){var t=[i,e];if(r)throw new TypeError("Generator is already executing.");for(;l;)try{if(r=1,a&&(s=a[2&t[0]?"return":t[0]?"throw":"next"])&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[0,s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return l.label++,{value:t[1],done:!1};case 5:l.label++,a=t[1],t=[0];continue;case 7:t=l.ops.pop(),l.trys.pop();continue;default:if(!(s=0<(s=l.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){l=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3])){l.label=t[1];break}if(6===t[0]&&l.label<s[1]){l.label=s[1],s=t;break}if(s&&l.label<s[2]){l.label=s[2],l.ops.push(t);break}s[2]&&l.ops.pop(),l.trys.pop();continue}t=o.call(n,l)}catch(e){t=[6,e],a=0}finally{r=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},__extends=(!function(o){!function(e){"use strict";function t(){}t.warning=function(t,i,n){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return n||!i?[3,2]:[4,o.Localization.localizeText(i,"notification.kind.error")];case 1:n=e.sent(),e.label=2;case 2:return n||i?[3,4]:[4,o.Localization.localizeText(null,"notification.kind.warning")];case 3:n=e.sent(),e.label=4;case 4:return toastr.warning(t,n,this._options),[2]}})})},t.error=function(t,i,n){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return n||!i?[3,2]:[4,o.Localization.localizeText(i,"notification.kind.error")];case 1:n=e.sent(),e.label=2;case 2:return n||i?[3,4]:[4,o.Localization.localizeText(null,"notification.kind.error")];case 3:n=e.sent(),e.label=4;case 4:return toastr.error(t,n,this._options),[2]}})})},t.success=function(t,i,n){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return n||!t?[3,2]:[4,o.Localization.localizeText(t,"notification.kind.success")];case 1:n=e.sent(),e.label=2;case 2:return n||t?[3,4]:[4,o.Localization.localizeText(null,"notification.kind.success")];case 3:n=e.sent(),e.label=4;case 4:return toastr.success(i,n,this._options),[2]}})})},t.info=function(t,i){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return i?[3,2]:[4,o.Localization.localizeText(null,"notification.kind.info")];case 1:i=e.sent(),e.label=2;case 2:return toastr.info(t,i,this._options),[2]}})})},t._options={closeButton:!0,debug:!1,newestOnTop:!1,progressBar:!1,positionClass:"toast-top-right",preventDuplicates:!1,onclick:null,showDuration:300,hideDuration:1e3,timeOut:5e3,extendedTimeOut:1e3,showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"},e.Notification=t}(o.UI||(o.UI={}))}(StockChartX=StockChartX||{}),!function(d){!function(s){"use strict";s.TooltipPosition={AUTO:"auto",TOP:"top",BOTTOM:"bottom"},s.TooltipContentKind={TEXT:"text",IMAGE:"image",HTML:"html"},Object.freeze(s.TooltipContentKind);var o=jQuery,t="scxTooltip",i="scxArrowBox",n="scxTooltipArrowStyleAfter",r="scxTooltipArrowStyleBefore",a="scxTooltipThemeArrowStyleAfter",l="scxTooltipThemeArrowStyleBefore",c="scxTooltipContent";function h(e){this._maxContentWidth=270,this._minSize={width:280,height:29},this._isInDom=!1,this._options=e.options||o.extend(!0,{},h.defaults),this._parent=e.parent,this.initDomObjects()}Object.defineProperty(h.prototype,"UID",{get:function(){return("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"size",{get:function(){return this._isInDom?{width:this._tooltipElement.outerWidth(),height:this._tooltipElement.outerHeight()}:this._minSize},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"theme",{get:function(){return this._options.theme},set:function(e){this._options.theme=e,this.applyTheme()},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"actualTheme",{get:function(){var e=this.theme;return e||this.defaultTheme},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"defaultTheme",{get:function(){var e=this._parent.chart;return e?d.JsUtil.clone(e.theme.tooltip):null},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"visible",{get:function(){return this._visible},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"contentKind",{get:function(){return this._options.kind},set:function(e){this._options.kind=e},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"position",{get:function(){return this._options.position},set:function(e){this._options.position=e},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"text",{get:function(){return this._options.text},set:function(e){this._options.text=e,this._applyText()},enumerable:!0,configurable:!0}),h.prototype.initDomObjects=function(){this._id="tooltip-"+this.UID;var e='<div id="'+this._id+'"><style class="'+n+'"></style><style class="'+r+'"></style><style class="'+a+'"></style><style class="'+l+'"></style><div class="'+c+'"></div></div>',e=this._tooltipElement=o(e);e.addClass(t).addClass(i),this._arrowAfter=e.find("."+n),this._arrowBefore=e.find("."+r),this._arrowMainBefore=e.find("."+l),this._contentElement=e.find("."+c),this._applyText()},h.prototype._applyText=function(){var e=this.text,t=this.actualTheme,i=1;t&&(i=t.border.enabled?t.border.width:0),this._contentElement.empty();try{switch(this.contentKind){case s.TooltipContentKind.TEXT:this._contentElement.text(e).css("white-space","pre-wrap"),this._tooltipElement.css("pointer-events","none");break;case s.TooltipContentKind.IMAGE:var n=this._maxContentWidth-2*i;o('<img src="'+e+'" style="max-width: '+n+'px">').appendTo(this._contentElement),this._tooltipElement.css("pointer-events","none");break;case s.TooltipContentKind.HTML:this._contentElement.css("white-space","normal"),this._tooltipElement.css("width","auto"),this._tooltipElement.css("height","auto"),d.HtmlUtil.removeUnsecureTags(e).appendTo(this._contentElement),this._tooltipElement.css("pointer-events","auto")}}catch(e){}},h.prototype.saveState=function(){return d.JsUtil.clone(this._options)},h.prototype.loadState=function(e){this._options=e||o.extend(!0,{},h.defaults),this._options.kind||(this._options.kind=s.TooltipContentKind.TEXT),this.applyTheme(),this._applyText()},h.prototype.show=function(e){this.text&&(this._visible=!0,this._isInDom||(this._tooltipElement=s.HtmlContainer.instance.register(this._id,this._tooltipElement),this._isInDom=!0),this.moveTo(e),d.HtmlUtil.setVisibility(this._tooltipElement,!0))},h.prototype.hide=function(){this._visible=!1,d.HtmlUtil.setVisibility(this._tooltipElement,!1)},h.prototype._actualPosition=function(e){var t=this.layoutRect;if(!t)return s.TooltipPosition.TOP;var i=this.size.height+15;return!(e.y-i>=t.top)&&e.y+i<=t.top+t.height?s.TooltipPosition.BOTTOM:s.TooltipPosition.TOP},h.prototype._adjustArrow=function(e,t){var i=this.theme,n=i?i.border.strokeColor||i.border.color:"transparent",i=(i?i.fill.enabled:"transparent")&&i?i.fill.color:"transparent",t=t===s.TooltipPosition.BOTTOM,o=t?"bottom: 100%; top: auto;":"top: 100%; bottom: auto;",r=t?"border-top-color: transparent;":"border-bottom-color: transparent;",a=e<5||95<e?"display: none;":"display: block;",i="#"+this._id+":after {left: "+e+"%; "+(t?"border-bottom-color: "+i+";":"border-top-color: "+i+";")+" "+o+" "+r+" "+a+" }",e="#"+this._id+":before {left: "+e+"%; "+(t?"border-bottom-color: "+n+";":"border-top-color: "+n+";")+" "+o+" "+r+" "+a+" }";this._arrowAfter.text(i),this._arrowBefore.text(e)},h.prototype.applyTheme=function(){if(this._tooltipElement){var e=this.actualTheme;if(e){var t=e.border.enabled?e.border.width:0,i="solid",n=e.border.strokeColor||e.border.color,o=e.fill.enabled?e.fill.color:"transparent",r=e.text.fillColor,a=e.text.fontSize,s=e.text.fontFamily,l=e.text.fontWeight,c=e.text.fontStyle,h=e.text.decoration;switch(e.border.lineStyle){case d.LineStyle.DOT:i="dotted";break;case d.LineStyle.DASH_DOT:case d.LineStyle.DASH:i="dashed"}this._tooltipElement.css({background:o,"border-color":n,"border-width":t,"border-style":i}),this._contentElement.css({color:r,"font-family":s,"font-size":a+"px","font-weight":l,"font-style":c,"text-decoration":h,"word-wrap":"break-word"}),this._applyText(),this._arrowMainBefore.text("#"+this._id+":before { border-width: "+t+" }")}}},h.prototype.moveTo=function(e){var t=this._actualPosition(e),i=this._calculateLocation(t,e),e=(e.x-i.x)/this.size.width*100;this._adjustArrow(e,t),this._tooltipElement.css("left",i.x).css("top",i.y)},h.prototype._calculateLocation=function(e,t){var i,n=this.size,o=t.x-n.width/2,r=n.height+15;switch(e){case s.TooltipPosition.TOP:i=t.y-r;break;case s.TooltipPosition.BOTTOM:i=t.y+30;break;default:throw new Error("Unknown tooltip position: "+e)}var a=this.layoutRect;return a&&(o<a.left&&(o=a.left),a=a.left+a.width,o+n.width>a&&(o=a-n.width)),{x:o,y:i}},h.prototype.destroy=function(){this._tooltipElement&&(this._tooltipElement.remove(),this._tooltipElement=null,this._isInDom=!1)},h.defaults={text:"",kind:s.TooltipContentKind.TEXT},s.Tooltip=h}(d.UI||(d.UI={}))}(StockChartX=StockChartX||{}),!function(c){!function(e){"use strict";var o=".scxScrollingPanel",r=".sxcCanvas";function t(t){var i=this;this._scrollingPanelMinWidth=20,this._scrollingPanelWidth=0,e.HtmlLoader.loadHtml("Scrollbar.html",function(e){i._init(e,t)})}Object.defineProperty(t.prototype,"chart",{get:function(){return this._chart},set:function(e){this._chart!==e&&(this._unsubscribeEvents(),this._chart=e,this._subscribeEvents())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"outerHeight",{get:function(){return this._scrollbar?this._scrollbar.outerHeight():0},enumerable:!0,configurable:!0}),t.prototype._init=function(e,t){var i,n=this,t=this._chart=t.chart;null!=t&&t.container&&(this._scrollbar=$(e).insertAfter(t.rootDiv),this._scrollingPanel=this._scrollbar.find(o),e=this._scrollbar.find(r).get()[0],(i=new c.CanvasRenderer).canvas=e,this._canvas=e,this._renderer=i,this._scrollingPanel.draggable({drag:function(e,t){return n._update(t.position.left)},stop:function(e,t){return n._update(t.position.left)},axis:"x",containment:this._scrollingPanel.parent()}),this._scrollingPanel.resizable({container:t.container,minWidth:this._scrollingPanelMinWidth,direction:"horizontal",start:function(){n._scrollingPanel.draggable({disabled:!0})},resize:function(){n._update(n._scrollingPanel.position().left)},stop:function(){n._scrollingPanel.draggable({disabled:!1})}}),this._subscribeEvents(),t&&t.fireValueChanged(c.ChartEvent.SCROLLBAR_LOADED,this))},t.prototype._subscribeEvents=function(){var t=this,e=this.chart;e&&e.on(c.ChartEvent.WINDOW_MODE_CHANGED,function(e){t.adjustDimensions()})},t.prototype._unsubscribeEvents=function(){this._chart&&this._chart.off(c.ChartEvent.WINDOW_MODE_CHANGED)},t.prototype._drawBackground=function(){var e=this._chart.dataManager.getDataSeries(c.DataSeriesSuffix.CLOSE),t=this._renderer,i=this._scrollbar,n=i.height(),i=i.width(),o=e.length,r=i/o,a=e.minMaxValues().max;t.clearRect(0,0,i,n),t.beginPath(),t.fillTheme(this._chart.theme.scrollingPanelBackgroud.fill),t.moveTo(0,n);for(var s=0;s<=o-1;s++){var l=e.values[s];null!=l&&t.lineTo(r*s,n-n*(l/a))}t.lineTo(i,n),t.closePath(),t.fill()},t.prototype.adjustDimensions=function(){var e,t,i,n;null!=this._chart&&(e=(n=this._chart.visibleDataRange()).firstVisibleDataRecord,n=n.lastVisibleDataRecord,t=this._chart.recordCount,i=this._scrollbar.width(),this._scrollingPanelWidth=i*((n-e)/t*100)/100,(n=i*(this._chart.firstVisibleRecord/t*100)/100)+this._scrollingPanelMinWidth>=this._scrollbar.width()&&(n=i-this._scrollingPanelMinWidth),this._scrollingPanel.css({left:n=n<0?0:n,maxWidth:this._scrollbar.width()}),this._scrollingPanel.width(Math.max(this._scrollingPanelWidth,this._scrollingPanelMinWidth)),this._canvas.width=this._scrollbar.width(),this._drawBackground())},t.prototype._update=function(e){if(null!=this._chart){this._drawBackground();var t=this._scrollbar.width(),i=e+this._scrollingPanel.width(),n=this._chart.recordCount,e=e/t*100*n/100,i=i/t*100*n/100;if(i<=e)return!1;this._chart.recordRange(e,i),this.chart.dateScale.requestMoreHistoryIfNeed(),this._chartUpdate()}},t.prototype._chartUpdate=function(){this._chart.setNeedsUpdate(!0)},t.prototype.appendTo=function(e){e&&(this._scrollbar.detach(),this._scrollbar=this._scrollbar.insertAfter(this.chart.rootDiv))},e.Scrollbar=t}(c.UI||(c.UI={}))}(StockChartX=StockChartX||{}),!function(i){!function(e){"use strict";function t(e){this._colorPicker=e.colorPicker,this._widthInput=e.widthInput,this._lineStyleDropdown=e.lineStyleDropdown}Object.defineProperty(t.prototype,"theme",{get:function(){return{strokeColor:this._colorPicker.spectrum("get").toRgbString(),width:this._widthInput.scxNumericField("getValue"),lineStyle:this._lineStyleDropdown.val()}},set:function(e){this._colorPicker.spectrum("set",e.strokeColor),this._widthInput.scxNumericField("setValue",e.width),this._lineStyleDropdown.selectpicker("val",e.lineStyle||i.LineStyle.SOLID),this._lineStyleDropdown.selectpicker("refresh")},enumerable:!0,configurable:!0}),e.LinePropertiesHandler=t}(i.UI||(i.UI={}))}(StockChartX=StockChartX||{}),!function(e){!function(e){"use strict";function t(e){this._label=e.label,this._colorPicker=e.colorPicker,this._switcher=e.switcher}Object.defineProperty(t.prototype,"theme",{get:function(){return{fillColor:this._colorPicker.spectrum("get").toRgbString()}},set:function(e){this._colorPicker.spectrum("set",e.fillColor)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isEnabled",{get:function(){return this._switcher.isChecked()},enumerable:!0,configurable:!0}),t.prototype.setState=function(e){this._switcher.setPosition(e),e?(this._colorPicker.spectrum("enable"),this._label.removeClass("disabled"),this._switcher.isChecked()||this._switcher.setPosition(!0)):(this._colorPicker.spectrum("disable"),this._label.addClass("disabled"),this._switcher.isChecked()&&this._switcher.setPosition(!0))},e.FillPropertiesHandler=t}(e.UI||(e.UI={}))}(StockChartX=StockChartX||{}),!function(d){!function(o){"use strict";var e="#scxTooltipView_region_",t="#scxTooltipView_input_",i="#scxTooltipView_label_",r="#scxTooltipView_chk_",n="#scxTooltipView_image_";function a(e){this.tooltipView=e,this._initFields(),this._init()}Object.defineProperty(a.prototype,"container",{set:function(e){e.append(this.tooltipView)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"chart",{set:function(e){this._chart=e},enumerable:!0,configurable:!0}),a.prototype._setBorderState=function(e){this._switchBorderEnabled.setPosition(e),e?(this._labelBorder.removeClass("disabled"),this._inputBorderColor.spectrum("enable"),this._inputBorderStyle.removeAttr("disabled").selectpicker("refresh"),this._inputBorderWidth.scxNumericField("enable"),this._switchBorderEnabled.isChecked()||this._switchBorderEnabled.setPosition(!0)):(this._labelBorder.addClass("disabled"),this._inputBorderColor.spectrum("disable"),this._inputBorderStyle.attr("disabled","disabled").selectpicker("refresh"),this._inputBorderWidth.scxNumericField("disable"),this._switchBorderEnabled.isChecked()&&this._switchBorderEnabled.setPosition(!0)),this._chart&&this._chart.localize(this._borderPanel)},a.prototype.setValues=function(e,t){(t=void 0===t?!0:t)&&(this._tooltip=e);t=e.theme||e.actualTheme;this._setBorderState(t.border.enabled),this._inputBorderColor.spectrum("set",t.border.strokeColor||t.border.color),this._inputBorderStyle.selectpicker("val",t.border.lineStyle||d.LineStyle.SOLID).selectpicker("refresh"),this._inputBorderWidth.scxNumericField("setValue",t.border.width),this._fillPropertiesHandlerTooltip.theme={fillColor:t.fill.color},this._fillPropertiesHandlerTooltip.setState(t.fill.enabled),this._kindChooser.setKind(e.contentKind),e.contentKind===o.TooltipContentKind.IMAGE?(this._inputText.val(""),this._inputImageUrl.val(e.text),this._inputImagePreview.attr("src",e.text),e.text||this._resetImagePreview(this._inputImagePreview)):(this._inputText.val(e.text),this._inputImageUrl.val(""),this._resetImagePreview(this._inputImagePreview)),this._inputTextColor.spectrum("set",t.text.fillColor),this._inputTextFont.selectpicker("val",t.text.fontFamily).selectpicker("refresh"),this._inputTextSize.selectpicker("val",t.text.fontSize).selectpicker("refresh"),this._styleChooser.setStyle("b","bold"===t.text.fontWeight),this._styleChooser.setStyle("i","italic"===t.text.fontStyle),this._styleChooser.setStyle("u","underline"===t.text.decoration)},a.prototype._init=function(){var n=this;this._switchBorderEnabled=new Switchery(document.querySelector(r+"borderColor"),a._switcherySettings),this._switchBorderEnabled.setPosition(!0),this._inputTextSize.selectpicker({container:"body"}),this._inputBorderStyle.selectpicker({container:"body"}),this._inputBorderWidth.scxNumericField(a._numericFieldConfig),this._switchFillEnabled=new Switchery(document.querySelector(r+"fillColor"),a._switcherySettings),this._switchFillEnabled.setPosition(!0),this._fillPropertiesHandlerTooltip=new o.FillPropertiesHandler({label:this._labelFillColor,colorPicker:this._inputFillColor,switcher:this._switchFillEnabled}),this._kindChooser=new c({buttons:this._inputsKind,panelText:this._regionText,panelTextStyle:this._regionTextStyle,panelImage:this._regionImage}),this._styleChooser=new s(this._inputsTextStyles),this._initImagePreview(this._inputImageUrl,this._inputImagePreview),this._inputTextFont.selectpicker({container:"body"}).change(function(e){n._inputTextFont.next().css({"font-family":e.target.value})}),this.tooltipView.find(".scxSpectrum").scx().colorPicker({containerClassName:"scxTooltipView",localStorageKey:"scxThemeDialog_spectrum",showAlpha:!0}),$("body").on("scxSwitcherChanged",function(e,t){var i=$(t.target),t=t.checked;i.is(n._switchBorderEnabledJQuery)&&n._setBorderState(t),i.is(n._switchFillEnabledJQuery)&&n._fillPropertiesHandlerTooltip.setState(t)})},a.prototype._initImagePreview=function(t,i){var n=null;t.on("keyup",function(){var e=t.val();i.parent().addClass("scxLoading"),i.hide(),n&&clearTimeout(n),n=setTimeout(function(){i.attr("src",e)},1e3)}),i.on("load",function(e){$(e.currentTarget).show(),$(e.currentTarget).parent().removeClass("scxHasBg"),$(e.currentTarget).parent().removeClass("scxLoading")}),i.on("error",function(e){$(e.currentTarget).parent().addClass("scxHasBg"),$(e.currentTarget).parent().removeClass("scxLoading"),$(e.currentTarget).hide()})},a.prototype._resetImagePreview=function(e){e.attr("src","").hide().parent().addClass("scxHasBg").removeClass("scxLoading")},a.prototype.resetToDefaults=function(){var e=d.JsUtil.clone(this._tooltip);e.contentKind=o.Tooltip.defaults.kind,e.text=o.Tooltip.defaults.text,e.theme=e.defaultTheme,this.setValues(e,!1)},a.prototype.apply=function(){var e=this._tooltip,t=$.extend(!0,{},e.actualTheme),i={colorPicker:this._inputBorderColor,widthInput:this._inputBorderWidth,lineStyleDropdown:this._inputBorderStyle},i=new o.LinePropertiesHandler(i);switch(t.border=i.theme,t.border.enabled=this._switchBorderEnabled.isChecked(),t.fill.enabled=this._fillPropertiesHandlerTooltip.isEnabled,t.fill.color=this._fillPropertiesHandlerTooltip.theme.fillColor,e.contentKind=this._kindChooser.getKind(),e.contentKind){case o.TooltipContentKind.IMAGE:e.text=d.JsUtil.filterText(this._inputImageUrl.val());break;case o.TooltipContentKind.TEXT:case o.TooltipContentKind.HTML:e.text=this._inputText.val().trim()}t.text.fillColor=this._inputTextColor.spectrum("get").toRgbString(),t.text.fontFamily=this._inputTextFont.selectpicker("val"),t.text.fontSize=this._inputTextSize.selectpicker("val"),t.text.fontWeight=this._styleChooser.getStyle("b")?"bold":"normal",t.text.fontStyle=this._styleChooser.getStyle("i")?"italic":"normal",t.text.decoration=this._styleChooser.getStyle("u")?"underline":"",e.theme=t},a.prototype._initFields=function(){this._regionImage=this.tooltipView.find(e+"image"),this._regionText=this.tooltipView.find(e+"text"),this._regionTextStyle=this.tooltipView.find(e+"textStyle"),this._labelBorder=this.tooltipView.find(i+"border"),this._inputBorderColor=this.tooltipView.find(t+"borderColor"),this._inputBorderWidth=this.tooltipView.find(t+"borderWidth"),this._inputBorderStyle=this.tooltipView.find(t+"borderStyle"),this._switchBorderEnabledJQuery=this.tooltipView.find(r+"borderColor"),this._labelFillColor=this.tooltipView.find(i+"fillColor"),this._inputFillColor=this.tooltipView.find(t+"fillColor"),this._switchFillEnabledJQuery=this.tooltipView.find(r+"fillColor"),this._inputsKind=this.tooltipView.find(".scxTooltipView_tooltipKind").children(),this._inputText=this.tooltipView.find(t+"tooltipText"),this._inputTextColor=this.tooltipView.find(t+"textColor"),this._inputTextFont=this.tooltipView.find(t+"textFont"),this._inputTextSize=this.tooltipView.find(t+"textSize"),this._inputsTextStyles=this.tooltipView.find(t+"tooltipTextStyles"),this._inputImageUrl=this.tooltipView.find(t+"imageURL"),this._inputImagePreview=this.tooltipView.find(n+"preview"),this._borderPanel=this.tooltipView.find(e+"borderPanel")},a._numericFieldConfig={showArrows:!1,maxValue:10,minValue:1,value:1},a._switcherySettings={color:"rgba(72, 149, 245, 0.2)",secondaryColor:"rgba(16, 17, 20, 1)",jackColor:"rgba(72, 149, 245, 1)",jackSecondaryColor:"rgba(81, 83, 90, 1)",className:"scx_switchery",disabled:!1,disabledOpacity:.5,speed:"0.4s"},o.TooltipView=a;l.prototype.getStyle=function(e){switch(e.toLowerCase()){case"b":return this._checkboxes.eq(0).prop("checked");case"i":return this._checkboxes.eq(1).prop("checked");case"u":return this._checkboxes.eq(2).prop("checked");default:return!1}},l.prototype.setStyle=function(e,t){switch(e.toLowerCase()){case"b":t?this._labels.eq(0).addClass("active"):this._labels.eq(0).removeClass("active"),this._checkboxes.eq(0).prop("checked",t);break;case"i":t?this._labels.eq(1).addClass("active"):this._labels.eq(1).removeClass("active"),this._checkboxes.eq(1).prop("checked",t);break;case"u":t?this._labels.eq(2).addClass("active"):this._labels.eq(2).removeClass("active"),this._checkboxes.eq(2).prop("checked",t)}},l.prototype._init=function(){this._labels=this._selector.find(">label"),this._checkboxes=this._selector.find("input[type=checkbox]"),this._labels.click(function(e){var t=$(e.currentTarget).find("input[type=checkbox]");t.prop("checked",!t.prop("checked")),t.prop("checked")?$(e.currentTarget).addClass("active"):$(e.currentTarget).removeClass("active")}).each(function(e){$(e.currentTarget).find("input[type=checkbox]").prop("checked")?$(e.currentTarget).addClass("active"):$(e.currentTarget).removeClass("active")})};var s=l;function l(e){this._selector=e,this._init()}o.TextStyleChooser=s;h.prototype.destroy=function(){this._config.buttons.off("click",this._onButtonClicked)},h.prototype.getKind=function(){return this._kind},h.prototype.setKind=function(e,t){if(e===this._kind)return!1;switch(e){case o.TooltipContentKind.TEXT:this._config.panelImage.hide(),this._config.panelTextStyle.show(),this._config.panelText.show();break;case o.TooltipContentKind.HTML:this._config.panelImage.hide(),this._config.panelTextStyle.hide(),this._config.panelText.show();break;case o.TooltipContentKind.IMAGE:this._config.panelText.hide(),this._config.panelImage.show();break;default:return!1}return this._highlightButton(e),this._kind=e,t&&this._config.onChange&&this._config.onChange(e),!0},h.prototype._highlightButton=function(e){this._config.buttons.removeClass("active"),this._config.buttons.filter("["+this.DATA_KIND+'="'+e+'"]').addClass("active")},h.prototype._onButtonClicked=function(e){e.data.setKind($(e.target).data().kind,!0)};var c=h;function h(e){this.DATA_KIND="data-kind",this._config=e,this.setKind(o.TooltipContentKind.TEXT),this._config.buttons.on("click",this,this._onButtonClicked)}}(d.UI||(d.UI={}))}(StockChartX=StockChartX||{}),!function(n){!function(e){"use strict";var a,t;(t=a=a||{})[t.LEFT=0]="LEFT",t[t.RIGHT=1]="RIGHT";function i(e,t,i){var n=this;this._toolbarContainer=t,this._containerRoot=i,this._toolbar=e,this._scrollBox=this._containerRoot.find(".scxToolbar-scroll-wrapper"),this._scrollLeft=this._containerRoot.find(".scxToolbar-scroll-left"),this._scrollRight=this._containerRoot.find(".scxToolbar-scroll-right"),this._containerRoot.removeClass("scxLicenseFree"),this._scrollLeft.on("click",function(){n._scroll(a.LEFT)}),this._scrollRight.on("click",function(){n._scroll(a.RIGHT)})}i.prototype._scroll=function(e){var t,i,n,o=this,r=this._scrollBox.scrollLeft();switch(e){case a.LEFT:i=this._scrollBox.outerWidth(),this._scrollBox.animate({scrollLeft:n=(n=r-i+35)<=0?0:n},300);break;case a.RIGHT:i=this._scrollBox.outerWidth(),t=this._toolbarContainer.outerWidth(),this._scrollBox.animate({scrollLeft:n=t-i<=(n=r+i-35)?t-i:n},300);break;default:throw new Error("Unknown direction")}setTimeout(function(){o.resize()},350)},i.prototype.resize=function(){this._scrollLeft.hide(),this._scrollRight.hide();var e,t=this._toolbar.chart;!t||this._toolbarContainer.outerWidth()<=t.rootDiv.outerWidth()||(0<this._scrollBox.scrollLeft()&&this._scrollLeft.show(),e=t.rootDiv,t.multiChartRootContainer&&t.windowMode!==n.WindowMode.FULL_SCREEN&&(e=t.multiChartRootContainer),this._scrollBox.scrollLeft()<this._toolbarContainer.outerWidth()-e.outerWidth()&&this._scrollRight.show())},e.ToolbarScroll=i}(n.UI||(n.UI={}))}(StockChartX=StockChartX||{}),this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}());!function(l){!function(e){"use strict";var t,i="#scxOrderDialog_input_",n="#scxOrderDialog_select_",o="#scxOrderDialog_btn_",r="#scxOrderDialog_region_",a=(t=e.Dialog,__extends(s,t),s.prototype.show=function(e){this.initDialog(e)&&(e.orderBar.order.action&&(this._modifyOrderMode=!0),this._orderBar=e.orderBar,this._setValues(),t.prototype.show.call(this,e))},s.prototype.hide=function(){this._modifyOrderMode||this._wasApplied||this._config.orderBar.remove(),this._wasApplied=!1,this._modifyOrderMode=!1,t.prototype.hide.call(this)},s.prototype._init=function(){var e=this;this._sellButton.on("click",function(){e._orderBar.order.action=l.OrderAction.SELL,e._save(),e._orderBar.fire(l.OrderBarEvents.ORDER_CREATED)}),this._buyButton.on("click",function(){e._orderBar.order.action=l.OrderAction.BUY,e._save(),e._orderBar.fire(l.OrderBarEvents.ORDER_CREATED)}),this._submitButton.on("click",function(){e._save()}),this._replaceButton.on("click",function(){e._save(),e._orderBar.fire(l.OrderBarEvents.ORDER_UPDATED)}),this._kindSelect.selectpicker({container:"body"}).on("change",function(){e._changeType(e._kindSelect.val())}),this._timeInForceSelect.selectpicker({container:"body"}).on("change",function(){e._changeTimeInForce(e._timeInForceSelect.val())}),this._timeInForceSelect.selectpicker({container:"body"}),this._quantityInput.scxNumericField(s._quantityInputConfig),this._price.scxNumericField(s._priceInputConfig),this._stopPrice.scxNumericField(s._priceInputConfig)},s.prototype._initDatePicker=function(t){t.datetimepicker({widgetPositioning:{vertical:"top"},widgetParent:$(".modal-content",this._dialog),minDate:new Date,locale:this._config.chart.locale}),t.on("dp.change",function(e){null==e.date&&t.data("DateTimePicker").date(e.oldDate.toDate())}).on("dp.hide",function(e){""===t.val()&&t.data("DateTimePicker").date(e.date.toDate())})},s.prototype._setValues=function(){var e=this._orderBar.order,t=l.JsUtil.calculateDigitsOnTickSize(this._config.chart.instrument.tickSize),i=parseFloat(e.price.toFixed(t)),t=parseFloat(e.stopPrice.toFixed(t));this._initDatePicker(this._timeInForceDatePicker),this._price.scxNumericField("setValue",i),this._stopPrice.scxNumericField("setValue",t||0),this._quantityInput.scxNumericField("setValue",e.quantity),this._timeInForceDatePicker.data("DateTimePicker").date(e.date||new Date),this._kindSelect.selectpicker("val",e.kind).prop("disabled",!1).selectpicker("refresh"),this._timeInForceSelect.selectpicker("val",e.timeInForce).prop("disabled",!1).selectpicker("refresh"),this._modifyOrderMode?(this._sellButton.hide(),this._buyButton.hide(),e.state!==l.OrderState.PENDING_SUBMIT||this._orderBar.modifyOrder?(this._submitButton.hide(),this._replaceButton.show()):(this._sellButton.show(),this._buyButton.show(),this._submitButton.hide(),this._replaceButton.hide())):(this._sellButton.show(),this._buyButton.show(),this._submitButton.hide(),this._replaceButton.hide())},s.prototype._save=function(){this._apply(),this.hide()},s.prototype._apply=function(){var e=this._orderBar,t=e.order,i=l.JsUtil.clone(t);t.price=this._price.scxNumericField("getValue"),t.stopPrice=this._stopPrice.scxNumericField("getValue"),t.quantity=this._quantityInput.scxNumericField("getValue"),t.kind=this._kindSelect.selectpicker("val"),t.timeInForce=this._timeInForceSelect.selectpicker("val"),t.date=this._timeInForceDatePicker.data("DateTimePicker").date().toDate(),this._config.orderBar.remove(),this._config.chart.mainPanel.addObjects(e),e.update(),i.price!==t.price&&e.fire(l.OrderBarEvents.ORDER_PRICE_CHANGED,t,i),this._wasApplied=!0},s.prototype._changeType=function(e){switch(e){case l.OrderKind.MARKET:this._priceRow.hide(),this._stopPriceRow.hide();break;case l.OrderKind.STOP:this._stopPriceRow.show(),this._priceRow.hide();break;case l.OrderKind.LIMIT:this._stopPriceRow.hide(),this._priceRow.show();break;case l.OrderKind.STOP_LIMIT:this._stopPriceRow.show(),this._priceRow.show();break;default:throw new Error("Order kind is not valid")}},s.prototype._changeTimeInForce=function(e){e===l.OrderTimeInForce.GOOD_TILL_DATE?this._timeInForceDateRow.show():this._timeInForceDateRow.hide()},s.prototype._initFields=function(){this._submitButton=this._dialog.find(o+"submit"),this._replaceButton=this._dialog.find(o+"replace"),this._sellButton=this._dialog.find(o+"sell"),this._buyButton=this._dialog.find(o+"buy"),this._kindSelect=this._dialog.find(n+"kind"),this._timeInForceSelect=this._dialog.find(n+"timeInForce"),this._timeInForceDatePicker=this._dialog.find(i+"timeInForceDate"),this._price=this._dialog.find(i+"price"),this._stopPrice=this._dialog.find(i+"stopPrice"),this._quantityInput=this._dialog.find(i+"quantity"),this._priceRow=this._dialog.find(r+"price"),this._stopPriceRow=this._dialog.find(r+"stopPrice"),this._timeInForceDateRow=this._dialog.find(r+"timeInForceDate")},s._quantityInputConfig={showArrows:!1,minValue:1,maxValue:1e9,value:1},s._priceInputConfig={showArrows:!1,minValue:1e-5,value:0,maxValue:1e9,priceDecimals:5},s);function s(e){e=t.call(this,e)||this;return e._modifyOrderMode=!1,e._wasApplied=!1,e._initFields(),e._init(),e}e.OrderDialog=a}(l.UI||(l.UI={}))}(StockChartX=StockChartX||{});